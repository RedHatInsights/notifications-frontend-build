(()=>{var e,t,n,a,i,o,l,r,s,c={50374:(e,t,n)=>{if(document.getElementById("root").classList.add("notifications"),!(window.insights&&window.insights.chrome&&window.insights.chrome.isChrome2)){var a=n(95318)(n(20862));Promise.resolve().then((function(){return(0,a.default)(n(83207))}))}},21958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var a=n(94015),i=n.n(a),o=n(23645),l=n.n(o),r=n(35747),s=n(42454),c=l()(i());c.i(r.Z),c.i(s.Z),c.push([e.id,".notifications{}.notifications :root{--ins-color--orange: #ec7a08}.notifications button:focus{outline:none}.notifications .pf-c-wizard__main-body{max-height:100%}.notifications .page__notifications#root{--pf-c-page__main-section--BackgroundColor: var(--pf-global--Color--light-100)}\n","",{version:3,sources:["webpack://./src/app/App.scss"],names:[],mappings:"AAAA,eAAc,CAAd,qBAC0J,4BAAoB,CAD9K,4BACoM,YAAY,CADhN,uCACyO,eAAe,CADxP,yCACmR,8EAA2C",sourcesContent:[".notifications{\n@import url(~@redhat-cloud-services/frontend-components/index.css);@import url(~@redhat-cloud-services/frontend-components-notifications/index.css);:root{--ins-color--orange: #ec7a08}button:focus{outline:none}.pf-c-wizard__main-body{max-height:100%}.page__notifications#root{--pf-c-page__main-section--BackgroundColor: var(--pf-global--Color--light-100)}\n\n}"],sourceRoot:""}]);const u=c},40615:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var a=n(94015),i=n.n(a),o=n(23645),l=n.n(o)()(i());l.push([e.id,".notifications .notification-table .pf-c-table tbody>tr>:first-child::after{--pf-c-table__expandable-row--after--BorderLeftWidth: 0\n}.notifications .pf-m-grid-md.pf-c-table tbody::after{--pf-c-table--tbody--after--BorderLeftWidth: 0\n}\n","",{version:3,sources:["webpack://./src/components/Notifications/Table.scss"],names:[],mappings:"AAAA,4EAC6D;AAAqD,CADlH,qDAEuC;AAA4C",sourcesContent:[".notifications{\n.notification-table .pf-c-table tbody>tr>:first-child::after{--pf-c-table__expandable-row--after--BorderLeftWidth: 0\n}.pf-m-grid-md.pf-c-table tbody::after{--pf-c-table--tbody--after--BorderLeftWidth: 0\n}\n\n}"],sourceRoot:""}]);const r=l},32079:(e,t,n)=>{"use strict";var a=n(93379),i=n.n(a),o=n(21958),l=i()(o.default,{insert:"head",singleton:!1});if(!o.default.locals||e.hot.invalidate){var r=o.default.locals;e.hot.accept(21958,(t=>{o=n(21958),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if(e[a]!==t[a])return!1;for(a in t)if(!e[a])return!1;return!0}(r,o.default.locals)?(r=o.default.locals,l(o.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),o.default.locals},91406:(e,t,n)=>{"use strict";var a=n(93379),i=n.n(a),o=n(40615),l=i()(o.default,{insert:"head",singleton:!1});if(!o.default.locals||e.hot.invalidate){var r=o.default.locals;e.hot.accept(40615,(t=>{o=n(40615),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if(e[a]!==t[a])return!1;for(a in t)if(!e[a])return!1;return!0}(r,o.default.locals)?(r=o.default.locals,l(o.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),o.default.locals},83207:(e,t,n)=>{"use strict";n.r(t);var a=n(67294),i=n(73935),o=n(16354),l=n(55128),r=n(52890),s=n(94782),c=n(276),u=n(98149);const d=JSON.parse('{"en-US":{"integrations":"Integrations","integrationsEmptyStateTitle":"No integrations","integrationsTableEmptyStateBody":"Connect to webhooks and external applications.","notifications":"Notifications"}}');n(32079);var p=n(27839),b=n(71355),f=n(86896),m=n(40114);const g={subAppId:"integrations",title:"Integrations | Settings"},E={subAppId:"notifications",title:"Notifications | Settings"},y=(0,n(50049).vU)({notifications:{id:"notifications",description:"Application name",defaultMessage:"Notifications"},integrations:{id:"integrations",description:"Application name",defaultMessage:"Integrations"},integrationsEmptyStateTitle:{id:"integrationsEmptyStateTitle",description:"Integrations Empty State title",defaultMessage:"No integrations"},integrationsTableEmptyStateBody:{id:"integrationsTableEmptyStateBody",description:"Integrations Empty State body",defaultMessage:"Connect to webhooks and external applications."}});var v,h,S=n(82644),I=n(29558);!function(e){e.WEBHOOK="webhook",e.EMAIL_SUBSCRIPTION="email_subscription"}(v||(v={})),function(e){e.WEBHOOK="webhook"}(h||(h={}));const N=(0,S.Sn)(),T=navigator.language.slice(0,2),C=(0,I.d)({onError:console.log,locale:T},N),O={locale:T},w={appName:(0,o.oQ)(C.formatMessage(y.notifications),O),appNameIntegrations:(0,o.oQ)(C.formatMessage(y.integrations),O),pages:{integrations:{list:{title:"Integrations"},add:{title:"Add integration"},edit:{title:"Edit integration"}},notifications:{list:{title:"Notifications",viewHistory:"View notification history"}},error:{title:"Notifications",emptyState:{title:"Unhandled error",content:"There was a problem trying to process your request.",showDetails:"Show details",actions:{goToIndex:"Go back"}}}},components:{integrations:{toolbar:{actions:{addIntegration:"Add integration",editIntegration:"Edit integration"}},table:{title:"Integrations",columns:{name:"Name",type:"Type",lastConnectionAttempt:"Last connection attempt",enabled:"Enabled"}},enableError:{title:"Unable to enable the Integration",description:'There was a problem trying to enable the integration: "{0}".\nPlease try again.'},disableError:{title:"Unable to disable the Integration",description:'There was a problem trying to disable the integration: "{0}".\nPlease try again.'},integrationType:{[v.WEBHOOK]:"Webhook"}},notifications:{types:{EMAIL_SUBSCRIPTION:"Send an email",DRAWER:"Send to notification drawer",INTEGRATION:"Integration"},toolbar:{actions:{}},table:{title:"Notifications",columns:{event:"Event type",action:"Action",recipient:"Recipient"}}}},common:{choose:"Please choose"}},A=(0,m.EN)((e=>{const t=a.useCallback((()=>{e.history.goBack()}),[e.history]);return a.createElement(l.ErrorBoundaryPage,{action:t,actionLabel:w.pages.error.emptyState.actions.goToIndex,pageHeader:w.pages.error.title,title:w.pages.error.emptyState.title,description:w.pages.error.emptyState.content},e.children)}));var k=n(48716),R=n(39173),D=n(86350),P=n(54213),j=n(22605),L=n(89836),F=n.n(L);const x=a.createContext({rbac:{canReadIntegrationsEndpoints:!1,canReadNotifications:!1,canWriteIntegrationsEndpoints:!1,canWriteNotifications:!1},applications:[]});var _=n(62308),B=n(9947),M=n(38424),U=n(60485),G=n(75106),V=n(35451),W=n(96733),Z=n(84564),$=n(69455),H=n(38296),q=n(26246),z=n(5756),K=n(21833),Q=n(6934),J=n(22860),Y=n(7193),X=n(32412),ee=n(48196),te=n(34713),ne=n(42742),ae=n(75959),ie=n(46242),oe=n(47435),le=n(8813);const re=(0,l.getOuiaPropsFactory)("Notifications");var se,ce=n(73861);!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(se||(se={}));const ue=(0,le.style)({marginLeft:ce.ZP.var}),de=e=>{const t=(0,j.Z)((0,l.toUtc)(e.date),"MMM d, HH:mm:ss");return a.createElement(a.Fragment,null,(e=>{switch(e){case se.SUCCESS:return a.createElement(V.ZP,{color:te.ZP.value});case se.FAILED:return a.createElement(Z.ZP,{color:Y.ZP.value});default:(0,ie.vE)(e)}})(e.type)," ",a.createElement("span",{className:ue}," ",t," UTC "))},pe=(0,le.style)({marginLeft:ee.default.var}),be=(0,le.style)({marginTop:ee.default.var}),fe=e=>a.createElement("div",Object.assign({},re("ConnectionAlert",e)),a.createElement(_.Alert,{title:e.title,variant:e.alertVariant,isInline:!0},a.createElement("p",{className:be},e.description),a.createElement("p",{className:be},"Last attempts: ",e.attempts.map(((e,t)=>a.createElement("span",{key:t,className:pe},a.createElement(de,{type:e.isSuccess?se.SUCCESS:se.FAILED,date:e.date}))))))),me=e=>{const t=a.useMemo((()=>{const t=e.attempts.filter((e=>!e.isSuccess)).length,n=e.attempts.length;return 1===t?`This connection has had 1 failure in the last ${n} connection attempts.`:`This connection has had ${t} failures in the last ${n} connection attempts.`}),[e.attempts]);return a.createElement(fe,{attempts:e.attempts,alertVariant:_.AlertVariant.warning,description:t,title:"Connection is degraded"})},ge=e=>a.createElement(fe,{attempts:e.attempts,alertVariant:_.AlertVariant.danger,description:"This connection has failed the most recent connection attempts.",title:"Failed connection"}),Ee=(0,le.style)({fontWeight:400}),ye=e=>a.createElement(_.TextContent,Object.assign({},re("Integrations/Table/ExpandedContent",e)),a.createElement(_.TextList,{component:_.TextListVariants.dl},a.createElement(_.TextListItem,{className:Ee,component:_.TextListItemVariants.dt},"Endpoint URL"),a.createElement(_.TextListItem,{component:_.TextListItemVariants.dd},e.integration.url),a.createElement(_.TextListItem,{className:Ee,component:_.TextListItemVariants.dt},"SSL verification"),a.createElement(_.TextListItem,{component:_.TextListItemVariants.dd},e.integration.sslVerificationEnabled?"Enabled":"Disabled"),a.createElement(_.TextListItem,{className:Ee,component:_.TextListItemVariants.dt},"Authentication type"),a.createElement(_.TextListItem,{component:_.TextListItemVariants.dd},void 0!==e.integration.secretToken?"Secret token":"None")));var ve;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SUCCESS=1]="SUCCESS",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR"}(ve||(ve={}));const he=(0,le.style)({paddingBottom:X.ZP.var}),Se=(0,le.style)({paddingLeft:0,paddingBottom:0}),Ie=(0,le.style)({marginLeft:10}),Ne=(0,le.style)({marginLeft:ee.default.var}),Te=(0,le.style)({fontWeight:600,color:ne.ZP.var,fontSize:"var(--pf-global--FontSize--sm)"}),Ce=e=>{if(0===e.length)return ve.UNKNOWN;const t=e.filter((e=>!e.isSuccess)).length;return t===e.length?ve.ERROR:t>0?ve.WARNING:ve.SUCCESS},Oe=e=>{const t=Ce(e);switch(t){case ve.UNKNOWN:case ve.SUCCESS:return null;case ve.ERROR:return a.createElement("div",{className:he},a.createElement(ge,{attempts:e}));case ve.WARNING:return a.createElement("div",{className:he},a.createElement(me,{attempts:e}));default:(0,ie.vE)(t)}},we=()=>a.createElement(a.Fragment,null,a.createElement(V.ZP,{color:te.ZP.value,"data-testid":"success-icon"}),a.createElement("span",{className:Ne},"Success")),Ae=()=>a.createElement(a.Fragment,null,a.createElement(Z.ZP,{color:Y.ZP.value,"data-testid":"fail-icon"}),a.createElement("span",{className:Ne},"Failure")),ke=(e,t)=>{if(void 0===e)return"Error fetching connection attempts";if(t)return a.createElement(_.Spinner,{size:"md"});const n=Ce(e);switch(n){case ve.UNKNOWN:return a.createElement(a.Fragment,null,a.createElement($.ZP,{"data-testid":"off-icon"}),a.createElement("span",{className:Ne},"Unknown"));case ve.SUCCESS:return a.createElement(a.Fragment,null,a.createElement(we,null));case ve.ERROR:return a.createElement(a.Fragment,null,a.createElement(Ae,null));case ve.WARNING:return a.createElement(a.Fragment,null,e[0].isSuccess?a.createElement(we,null):a.createElement(Ae,null),a.createElement("br",null),a.createElement(_.Text,{className:Te},"Degraded connection"));default:(0,ie.vE)(n)}},Re=[{title:w.components.integrations.table.columns.name,cellFormatters:[z.zW],transforms:[]},{title:w.components.integrations.table.columns.type,transforms:[]},{title:w.components.integrations.table.columns.lastConnectionAttempt,transforms:[]},{title:w.components.integrations.table.columns.enabled,transforms:[]}],{rowExpandedContentClassName:De,rowWrapperClassName:Pe,tableClassName:je}=(()=>{const e=(0,oe.important)("none"),t=(0,oe.important)("var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)"),n={borderBottom:e};return{rowExpandedContentClassName:(0,le.style)(n),rowWrapperClassName:(0,le.style)(n,{borderTop:t}),tableClassName:(0,le.style)({borderBottom:t})}})(),Le=e=>{const{trRef:t,className:n,rowProps:i,row:o}=e,l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["trRef","className","rowProps","row"]);return o?a.createElement("tr",Object.assign({},l,{ref:t,className:(0,H.i)(n,!0===o.isExpanded?De:Pe,void 0!==o.isExpanded&&q.Z.tableExpandableRow,o.isExpanded&&q.Z.modifiers.expanded),hidden:void 0!==(null==o?void 0:o.isExpanded)&&!o.isExpanded}),e.children):a.createElement(a.Fragment,null)},Fe=e=>{const t=(0,f.Z)(),n=a.useCallback(((t,n,a,i)=>{const o=e.integrations,l=e.onCollapse,r=o.findIndex((e=>e.id===i.id));l&&-1!==r&&l(o[r],r,a)}),[e.integrations,e.onCollapse]),i=a.useMemo((()=>{return t=e.integrations,n=e.onEnable,t.reduce(((e,t,i)=>(e.push({id:t.id,key:t.id,isOpen:t.isOpen,selected:t.isSelected,cells:[{title:t.name},{title:w.components.integrations.integrationType[t.type]},{title:ke(t.lastConnectionAttempts,t.isConnectionAttemptLoading)},{title:a.createElement(a.Fragment,null,t.isEnabledLoading?a.createElement(_.Spinner,{className:Ie,size:"md"}):a.createElement(_.Switch,{id:`table-row-switch-id-${t.id}`,"aria-label":"Enabled",isChecked:t.isEnabled,onChange:e=>n&&n(t,i,e),isDisabled:!n,ouiaId:`enabled-${t.id}`}))}]}),e.push({fullWidth:!0,parent:2*i,cells:[{title:a.createElement(a.Fragment,null,void 0!==t.lastConnectionAttempts&&Oe(t.lastConnectionAttempts),a.createElement("div",{className:Se},a.createElement(ye,{integration:t,ouiaId:t.id}))),props:{colSpan:6}}]}),e)),[]);var t,n}),[e.integrations,e.onEnable]),o=a.useCallback((t=>{const n=e.actionResolver;if(void 0===t.parent&&t&&e.integrations){const a=e.integrations.findIndex((e=>e.id===t.id)),i=e.integrations[a];if(i)return n(i,a)}return[]}),[e.actionResolver,e.integrations]);return e.isLoading?a.createElement("div",Object.assign({},re("Integrations/Table",Object.assign(Object.assign({},e),{ouiaSafe:!1}))),a.createElement(ae.Z,{rowSize:e.loadingCount&&e.loadingCount>0?e.loadingCount:10,columns:Re,paddingColumnSize:0,sortBy:void 0})):a.createElement("div",Object.assign({},re("Integrations/Table",e)),0===i.length?a.createElement(B.u,{variant:B.I.full},a.createElement(M.k,{icon:W.ZP}),a.createElement(U.D,{headingLevel:"h2",size:"lg"},t.formatMessage(y.integrationsEmptyStateTitle)),a.createElement(G.B,null,t.formatMessage(y.integrationsTableEmptyStateBody))):a.createElement(K.i,{className:je,"aria-label":w.components.integrations.table.title,rows:i,cells:Re,onCollapse:n,rowWrapper:Le,actionResolver:o},a.createElement(Q.x,null),a.createElement(J.R,null)))};var xe=n(71070),_e=n(81790);const Be=e=>a.useMemo((()=>{if(e)return{extraItems:[],onSelect:(t,n)=>{e((0,l.exporterTypeFromString)(n))}}}),[e]),Me=["stage-beta","prod-beta"];var Ue;!function(e){e.NAME="name",e.ENABLED="enabled"}(Ue||(Ue={}));const Ge=(0,le.style)({marginLeft:4}),Ve={[Ue.NAME]:{label:"Name",placeholder:"Filter by name"},[Ue.ENABLED]:{label:"Enabled",placeholder:"Filter by enabled",options:{exclusive:!1,items:[{value:"Enabled",label:a.createElement(a.Fragment,null,a.createElement((()=>a.createElement(V.ZP,{color:"green"})),null)," ",a.createElement("span",{className:Ge},"Enabled"))},{value:"Disabled",label:a.createElement(a.Fragment,null,a.createElement((()=>a.createElement($.ZP,null)),null)," ",a.createElement("span",{className:Ge},"Disabled"))}]}}},We=e=>{const t=(0,l.usePrimaryToolbarFilterConfig)(Ue,e.filters,e.setFilters,e.clearFilters,Ve),n=a.useMemo((()=>({actions:[{key:"add-integration",label:w.components.integrations.toolbar.actions.addIntegration,onClick:e.onAddIntegration,props:{isDisabled:!e.onAddIntegration}}],kebabToggleProps:{isDisabled:!1}})),[e.onAddIntegration]),i=Be(e.onExport),o=(0,l.useInsightsEnvironmentFlag)((0,l.getInsights)(),Me,void 0,(0,a.useCallback)((()=>t.filterConfig),[t])),r=(0,l.useInsightsEnvironmentFlag)((0,l.getInsights)(),Me,void 0,(0,a.useCallback)((()=>t.activeFiltersConfig),[t])),s=a.useCallback(((t,n)=>{(0,e.pageChanged)(n)}),[e.pageChanged]),c=a.useCallback(((t,n)=>{(0,e.perPageChanged)(n)}),[e.perPageChanged]),u=a.useMemo((()=>({itemCount:e.count,page:e.page,perPage:e.perPage,isCompact:!0,variant:xe.a.top,onSetPage:s,onFirstClick:s,onPreviousClick:s,onNextClick:s,onLastClick:s,onPageInput:s,onPerPageSelect:c})),[e.count,e.page,e.perPage,s,c]),d=a.useMemo((()=>Object.assign(Object.assign({},u),{isCompact:!1,variant:xe.a.bottom})),[u]);return a.createElement("div",Object.assign({},re("Integrations/DualToolbar",e)),a.createElement(_e.Z,{actionsConfig:n,exportConfig:i,filterConfig:o,activeFiltersConfig:r,pagination:u,id:"integrations-top-toolbar"}),e.children,a.createElement(_e.Z,{id:"integrations-bottom-toolbar",pagination:d}))};var Ze,$e,He=n(70070),qe=n(78558);!function(e){function t(){return qe.object({accountId:qe.string().optional().nullable(),account_id:qe.string().optional().nullable(),application:qe.string().optional().nullable(),eventType:qe.string().optional().nullable(),event_type:qe.string().optional().nullable(),payload:O().optional().nullable(),schema:W().optional().nullable(),specificData:J().optional().nullable(),timestamp:qe.string().optional().nullable()}).nonstrict()}function n(){return qe.object({bundle_id:ee(),created:qe.string().optional().nullable(),display_name:qe.string(),eventTypes:z().optional().nullable(),id:ee().optional().nullable(),name:qe.string(),updated:qe.string().optional().nullable()}).nonstrict()}function a(){return qe.object({password:qe.string().optional().nullable(),username:qe.string().optional().nullable()}).nonstrict()}function i(){return qe.record(g())}function o(){return qe.object({convertedType:qe.unknown().optional().nullable(),logicalTypeName:qe.string().optional().nullable(),recommendedSchema:W().optional().nullable()}).nonstrict()}function l(){return qe.unknown()}function r(){return qe.object({created:qe.string().optional().nullable(),description:qe.string(),enabled:qe.boolean().optional().nullable(),id:ee().optional().nullable(),name:qe.string(),properties:qe.union([ne(),l()]).optional().nullable(),type:s(),updated:qe.string().optional().nullable()}).nonstrict()}function s(){return qe.enum(["webhook","email_subscription","default"])}function c(){return qe.object({value:qe.string().optional().nullable(),weak:qe.boolean().optional().nullable()}).nonstrict()}function u(){return qe.object({application:qe.lazy((()=>n())).optional().nullable(),description:qe.string().optional().nullable(),display_name:qe.string(),endpoints:q().optional().nullable(),id:ee().optional().nullable(),name:qe.string()}).nonstrict()}function d(){return qe.enum(["CLIENT_ERROR","INFORMATIONAL","OTHER","REDIRECTION","SERVER_ERROR","SUCCESSFUL"])}function p(){return qe.object({classPropEnabled:qe.boolean().optional().nullable(),data:f().optional().nullable(),keyClassEnabled:qe.boolean().optional().nullable(),readerCache:k().optional().nullable()}).nonstrict()}function b(){return qe.object({aliases:Q().optional().nullable(),defaultValue:g().optional().nullable(),doc:qe.string().optional().nullable(),name:qe.string().optional().nullable(),objectProps:L().optional().nullable(),order:V().optional().nullable(),position:qe.number().int().optional().nullable(),props:i().optional().nullable(),reserved:Q().optional().nullable(),schema:qe.lazy((()=>W())).optional().nullable()}).nonstrict()}function f(){return qe.object({classLoader:qe.unknown().optional().nullable(),conversions:P().optional().nullable(),conversionsByClass:w().optional().nullable(),defaultValueCache:A().optional().nullable(),fastReaderBuilder:qe.lazy((()=>p())).optional().nullable(),fastReaderEnabled:qe.boolean().optional().nullable()}).nonstrict()}function m(){return qe.enum(["GET","POST","PUT"])}function g(){return qe.object({array:qe.boolean().optional().nullable(),bigDecimal:qe.boolean().optional().nullable(),bigInteger:qe.boolean().optional().nullable(),binary:qe.boolean().optional().nullable(),boolean:qe.boolean().optional().nullable(),containerNode:qe.boolean().optional().nullable(),double:qe.boolean().optional().nullable(),empty:qe.boolean().optional().nullable(),float:qe.boolean().optional().nullable(),floatingPointNumber:qe.boolean().optional().nullable(),int:qe.boolean().optional().nullable(),integralNumber:qe.boolean().optional().nullable(),long:qe.boolean().optional().nullable(),missingNode:qe.boolean().optional().nullable(),nodeType:E().optional().nullable(),null:qe.boolean().optional().nullable(),number:qe.boolean().optional().nullable(),object:qe.boolean().optional().nullable(),pojo:qe.boolean().optional().nullable(),short:qe.boolean().optional().nullable(),textual:qe.boolean().optional().nullable(),valueNode:qe.boolean().optional().nullable()}).nonstrict()}function E(){return qe.enum(["ARRAY","BINARY","BOOLEAN","MISSING","NULL","NUMBER","OBJECT","POJO","STRING"])}function y(){return qe.array(qe.unknown())}function v(){return qe.object({params:F().optional().nullable(),rel:qe.string().optional().nullable(),rels:N().optional().nullable(),title:qe.string().optional().nullable(),type:qe.string().optional().nullable(),uri:qe.string().optional().nullable(),uriBuilder:te().optional().nullable()}).nonstrict()}function h(){return qe.array(r())}function S(){return qe.array(b())}function I(){return qe.array(qe.lazy((()=>W())))}function N(){return qe.array(qe.string())}function T(){return qe.object({country:qe.string().optional().nullable(),displayCountry:qe.string().optional().nullable(),displayLanguage:qe.string().optional().nullable(),displayName:qe.string().optional().nullable(),displayScript:qe.string().optional().nullable(),displayVariant:qe.string().optional().nullable(),extensionKeys:$().optional().nullable(),iSO3Country:qe.string().optional().nullable(),iSO3Language:qe.string().optional().nullable(),language:qe.string().optional().nullable(),script:qe.string().optional().nullable(),unicodeLocaleAttributes:Q().optional().nullable(),unicodeLocaleKeys:Q().optional().nullable(),variant:qe.string().optional().nullable()}).nonstrict()}function C(){return qe.object({name:qe.string().optional().nullable()}).nonstrict()}function O(){return qe.unknown()}function w(){return qe.record(P())}function A(){return qe.record(qe.unknown())}function k(){return qe.record(R())}function R(){return qe.object({empty:qe.boolean().optional().nullable()}).nonstrict()}function D(){return qe.record(qe.unknown())}function P(){return qe.record(o())}function j(){return qe.record(G())}function L(){return qe.record(qe.unknown())}function F(){return qe.record(qe.string())}function x(){return qe.record(W())}function _(){return qe.object({parameters:F().optional().nullable(),subtype:qe.string().optional().nullable(),type:qe.string().optional().nullable(),wildcardSubtype:qe.boolean().optional().nullable(),wildcardType:qe.boolean().optional().nullable()}).nonstrict()}function B(){return qe.object({count:qe.number().int()}).nonstrict()}function M(){return qe.record(qe.unknown())}function U(){return qe.record(qe.string())}function G(){return qe.object({comment:qe.string().optional().nullable(),domain:qe.string().optional().nullable(),expiry:qe.string().optional().nullable(),httpOnly:qe.boolean().optional().nullable(),maxAge:qe.number().int().optional().nullable(),name:qe.string().optional().nullable(),path:qe.string().optional().nullable(),secure:qe.boolean().optional().nullable(),value:qe.string().optional().nullable(),version:qe.number().int().optional().nullable()}).nonstrict()}function V(){return qe.enum(["ASCENDING","DESCENDING","IGNORE"])}function W(){return qe.object({aliases:Q().optional().nullable(),doc:qe.string().optional().nullable(),elementType:qe.lazy((()=>W())).optional().nullable(),enumDefault:qe.string().optional().nullable(),enumSymbols:N().optional().nullable(),error:qe.boolean().optional().nullable(),fields:S().optional().nullable(),fixedSize:qe.number().int().optional().nullable(),fullName:qe.string().optional().nullable(),hashCode:qe.number().int().optional().nullable(),logicalType:C().optional().nullable(),name:qe.string().optional().nullable(),namespace:qe.string().optional().nullable(),nullable:qe.boolean().optional().nullable(),objectProps:L().optional().nullable(),props:i().optional().nullable(),reserved:Q().optional().nullable(),type:X().optional().nullable(),types:I().optional().nullable(),union:qe.boolean().optional().nullable(),valueType:qe.lazy((()=>W())).optional().nullable()}).nonstrict()}function Z(){return qe.array(n())}function $(){return qe.array(qe.string())}function H(){return qe.array(qe.unknown())}function q(){return qe.array(r())}function z(){return qe.array(u())}function K(){return qe.array(v())}function Q(){return qe.array(qe.string())}function J(){return qe.object({classCache:D().optional().nullable(),classLoader:qe.unknown().optional().nullable(),conversions:P().optional().nullable(),conversionsByClass:w().optional().nullable(),customCoders:qe.boolean().optional().nullable(),defaultValueCache:A().optional().nullable(),fastReaderBuilder:p().optional().nullable(),fastReaderEnabled:qe.boolean().optional().nullable(),schemaClassCache:qe.unknown().optional().nullable(),schemaTypeCache:x().optional().nullable(),stringableClasses:H().optional().nullable(),useCustomCoderFlag:qe.boolean().optional().nullable()}).nonstrict()}function Y(){return qe.object({family:d().optional().nullable(),reasonPhrase:qe.string().optional().nullable(),statusCode:qe.number().int().optional().nullable()}).nonstrict()}function X(){return qe.enum(["ARRAY","BOOLEAN","BYTES","DOUBLE","ENUM","FIXED","FLOAT","INT","LONG","MAP","NULL","RECORD","STRING","UNION"])}function ee(){return qe.string()}function te(){return qe.unknown()}function ne(){return qe.object({basic_authentication:a().optional().nullable(),disable_ssl_verification:qe.boolean().optional().nullable(),method:m(),secret_token:qe.string().optional().nullable(),url:qe.string()}).nonstrict()}e.Action=t(),e.Application=n(),e.ApplicationFacet=qe.object({label:qe.string(),value:qe.string()}).nonstrict(),e.Attributes=qe.unknown(),e.BasicAuthentication=a(),e.Bundle=qe.object({applications:Z().optional().nullable(),created:qe.string().optional().nullable(),display_name:qe.string(),id:ee().optional().nullable(),name:qe.string(),updated:qe.string().optional().nullable()}).nonstrict(),e.ConcurrentMapStringJsonNode=i(),e.ConversionObject=o(),e.EmailSubscriptionAttributes=l(),e.Endpoint=r(),e.EndpointPage=qe.object({data:h(),links:F(),meta:B()}).nonstrict(),e.EndpointType=s(),e.EntityTag=c(),e.EventType=u(),e.Family=d(),e.FastReaderBuilder=p(),e.Field=b(),e.GenericData=f(),e.HttpType=m(),e.JsonNode=g(),e.JsonNodeType=E(),e.JsonObject=y(),e.Link=v(),e.ListEndpoint=h(),e.ListField=S(),e.ListSchema=I(),e.ListString=N(),e.Locale=T(),e.LogicalType=C(),e.Map=O(),e.MapClassObjectMapStringConversionObject=w(),e.MapFieldObject=A(),e.MapSchemaMapSchemaRecordReader=k(),e.MapSchemaRecordReader=R(),e.MapStringClass=D(),e.MapStringConversionObject=P(),e.MapStringNewCookie=j(),e.MapStringObject=L(),e.MapStringString=F(),e.MapTypeSchema=x(),e.MediaType=_(),e.Meta=B(),e.MultivaluedMapStringObject=M(),e.MultivaluedMapStringString=U(),e.NewCookie=G(),e.Notification=qe.object({action:t().optional().nullable(),endpoint:r().optional().nullable(),tenant:qe.string().optional().nullable()}).nonstrict(),e.NotificationHistory=qe.object({created:qe.string().optional().nullable(),details:y().optional().nullable(),endpointId:ee().optional().nullable(),eventId:qe.string().optional().nullable(),id:qe.number().int().optional().nullable(),invocationResult:qe.boolean().optional().nullable(),invocationTime:qe.number().int().optional().nullable()}).nonstrict(),e.Order=V(),e.Response=qe.object({allowedMethods:Q().optional().nullable(),cookies:j().optional().nullable(),date:qe.string().optional().nullable(),entity:qe.unknown().optional().nullable(),entityTag:c().optional().nullable(),headers:M().optional().nullable(),language:T().optional().nullable(),lastModified:qe.string().optional().nullable(),length:qe.number().int().optional().nullable(),links:K().optional().nullable(),location:qe.string().optional().nullable(),mediaType:_().optional().nullable(),metadata:M().optional().nullable(),status:qe.number().int().optional().nullable(),statusInfo:Y().optional().nullable(),stringHeaders:U().optional().nullable()}).nonstrict(),e.Schema=W(),e.SetApplication=Z(),e.SetCharacter=$(),e.SetClass=H(),e.SetEndpoint=q(),e.SetEventType=z(),e.SetLink=K(),e.SetString=Q(),e.SetUUID=qe.array(qe.string()),e.SpecificData=J(),e.StatusType=Y(),e.Type=X(),e.UUID=ee(),e.UriBuilder=te(),e.WebhookAttributes=ne()}(Ze||(Ze={})),function(e){let t,n,a,i,o,l,s,c,u,d,p,b,f;!function(e){qe.boolean(),qe.number().int(),qe.number().int(),qe.number().int(),qe.string(),qe.string(),e.actionCreator=e=>{const t={};return void 0!==e.active&&(t.active=e.active),void 0!==e.limit&&(t.limit=e.limit),void 0!==e.offset&&(t.offset=e.offset),void 0!==e.pageNumber&&(t.pageNumber=e.pageNumber),void 0!==e.sortBy&&(t.sort_by=e.sortBy),void 0!==e.type&&(t.type=e.type),(0,r.actionBuilder)("GET","/api/integrations/v1.0/endpoints").queryParams(t).config({rules:[new He.ValidateRule(Ze.EndpointPage,"EndpointPage",200)]}).build()}}(t=e.EndpointServiceGetEndpoints||(e.EndpointServiceGetEndpoints={})),function(e){e.actionCreator=e=>(0,r.actionBuilder)("POST","/api/integrations/v1.0/endpoints").queryParams({}).data(e.body).config({rules:[new He.ValidateRule(Ze.Endpoint,"Endpoint",200)]}).build()}(n=e.EndpointServiceCreateEndpoint||(e.EndpointServiceCreateEndpoint={})),function(e){const t=qe.boolean();e.actionCreator=()=>(0,r.actionBuilder)("PUT","/api/integrations/v1.0/endpoints/email/subscription/daily").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(a=e.EndpointServiceSubscribeDailyEmail||(e.EndpointServiceSubscribeDailyEmail={})),function(e){const t=qe.boolean();e.actionCreator=()=>(0,r.actionBuilder)("DELETE","/api/integrations/v1.0/endpoints/email/subscription/daily").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(i=e.EndpointServiceUnsubscribeDailyEmail||(e.EndpointServiceUnsubscribeDailyEmail={})),function(e){const t=qe.boolean();e.actionCreator=()=>(0,r.actionBuilder)("PUT","/api/integrations/v1.0/endpoints/email/subscription/instant").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(o=e.EndpointServiceSubscribeInstantEmail||(e.EndpointServiceSubscribeInstantEmail={})),function(e){const t=qe.boolean();e.actionCreator=()=>(0,r.actionBuilder)("DELETE","/api/integrations/v1.0/endpoints/email/subscription/instant").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(l=e.EndpointServiceUnsubscribeInstantEmail||(e.EndpointServiceUnsubscribeInstantEmail={})),function(e){e.actionCreator=e=>{const t="/api/integrations/v1.0/endpoints/{id}".replace("{id}",e.id.toString());return(0,r.actionBuilder)("GET",t).queryParams({}).config({rules:[new He.ValidateRule(Ze.Endpoint,"Endpoint",200)]}).build()}}(s=e.EndpointServiceGetEndpoint||(e.EndpointServiceGetEndpoint={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}".replace("{id}",e.id.toString());return(0,r.actionBuilder)("PUT",n).queryParams({}).data(e.body).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(c=e.EndpointServiceUpdateEndpoint||(e.EndpointServiceUpdateEndpoint={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}".replace("{id}",e.id.toString());return(0,r.actionBuilder)("DELETE",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",204)]}).build()}}(u=e.EndpointServiceDeleteEndpoint||(e.EndpointServiceDeleteEndpoint={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}/enable".replace("{id}",e.id.toString());return(0,r.actionBuilder)("PUT",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(d=e.EndpointServiceEnableEndpoint||(e.EndpointServiceEnableEndpoint={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}/enable".replace("{id}",e.id.toString());return(0,r.actionBuilder)("DELETE",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",204)]}).build()}}(p=e.EndpointServiceDisableEndpoint||(e.EndpointServiceDisableEndpoint={})),function(e){const t=qe.array(Ze.NotificationHistory);e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}/history".replace("{id}",e.id.toString());return(0,r.actionBuilder)("GET",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(b=e.EndpointServiceGetEndpointHistory||(e.EndpointServiceGetEndpointHistory={})),function(e){qe.number().int(),qe.number().int(),qe.number().int(),qe.number().int(),qe.number().int(),qe.string();const t=qe.string();e.actionCreator=e=>{const n="/api/integrations/v1.0/endpoints/{id}/history/{history_id}/details".replace("{history_id}",e.historyId.toString()).replace("{id}",e.id.toString()),a={};return void 0!==e.limit&&(a.limit=e.limit),void 0!==e.offset&&(a.offset=e.offset),void 0!==e.pageNumber&&(a.pageNumber=e.pageNumber),void 0!==e.pageSize&&(a.pageSize=e.pageSize),void 0!==e.sortBy&&(a.sort_by=e.sortBy),(0,r.actionBuilder)("GET",n).queryParams(a).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(f=e.EndpointServiceGetDetailedEndpointHistory||(e.EndpointServiceGetDetailedEndpointHistory={}))}($e||($e={}));const ze=e=>{switch(e){case Ze.EndpointType.Enum.webhook:return v.WEBHOOK;case Ze.EndpointType.Enum.email_subscription:return v.EMAIL_SUBSCRIPTION;case Ze.EndpointType.Enum.default:case void 0:throw new Error(`Unexpected type: ${e}`);default:(0,ie.vE)(e)}},Ke=e=>{switch(e){case v.WEBHOOK:case h.WEBHOOK:return Ze.EndpointType.Enum.webhook;case v.EMAIL_SUBSCRIPTION:return Ze.EndpointType.Enum.email_subscription;default:(0,ie.vE)(e)}},Qe=e=>{var t;const n={id:e.id||"",name:e.name||"",isEnabled:!!e.enabled,type:ze(e.type)};switch(n.type){case v.WEBHOOK:const a=e.properties;return Object.assign(Object.assign({},n),{url:a.url||"",sslVerificationEnabled:!a.disable_ssl_verification,secretToken:null===a.secret_token?void 0:a.secret_token,method:null!==(t=a.method)&&void 0!==t?t:Ze.HttpType.Enum.GET});case v.EMAIL_SUBSCRIPTION:return Object.assign(Object.assign({},n),{type:v.EMAIL_SUBSCRIPTION});default:(0,ie.vE)(n.type)}},Je=e=>et(e).map(Qe),Ye=e=>{switch(e.type){case v.WEBHOOK:case h.WEBHOOK:const t=e;return{url:t.url,method:t.method,disable_ssl_verification:!t.sslVerificationEnabled,secret_token:t.secretToken};case v.EMAIL_SUBSCRIPTION:return{};default:(0,ie.vE)(e)}},Xe=e=>({id:e.id,name:e.name,enabled:e.isEnabled,type:Ke(e.type),description:"",properties:Ye(e)}),et=e=>e.filter((e=>e.type!==Ze.EndpointType.enum.default)),tt=e=>{const t=(null!=e?e:l.Page.defaultPage()).toQuery();return $e.EndpointServiceGetEndpoints.actionCreator({limit:+t.limit,offset:+t.offset,type:t.filterType?Ke(t.filterType):void 0,active:t.filterActive?"true"===t.filterActive:void 0})},nt=(0,He.validationResponseTransformer)((e=>{return 200===(null==e?void 0:e.status)?(0,He.validatedResponse)("IntegrationPage",200,{data:(t=e.value.data,Je(t).filter((e=>Object.values(h).includes(e.type)))),count:e.value.meta.count},e.errors):e;var t}));class at extends l.ExporterCsv{serialize(e){return Object.assign({},e)}headers(){return[["id","id"],["name","name"],["isEnabled","isEnabled"],["type","type"],["url","url"]]}}class it extends l.ExporterJson{}var ot=n(47173);const lt=(0,le.style)({paddingLeft:0}),rt=e=>{const t=e.integration.isEnabled?"This integration is enabled and ready to use.":"This integration is disabled.",n=e.integration.isEnabled?"Disable integration":"Enable integration";return a.createElement(a.Fragment,null,a.createElement("div",null,t),a.createElement(ot.zx,{className:lt,isDisabled:e.isLoading,variant:ot.Wu.link,onClick:e.switchEnabled},n),e.isLoading&&a.createElement(_.Spinner,{size:"sm"}))};var st=n(38519),ct=n(37058);const ut=ct.Ry({name:ct.Z_().required("Write a name for this Integration.").max(150).trim(),type:ct.nK().oneOf([v.WEBHOOK]).default(v.WEBHOOK),isEnabled:ct.O7().default(!0).required()}),dt=ut.concat(ct.Ry().shape({type:ct.nK().oneOf([v.WEBHOOK]).required(),url:ct.Z_().url().required("Write a valid url for this Integration."),sslVerificationEnabled:ct.O7().default(!0),secretToken:ct.Z_().notRequired(),method:ct.nK().oneOf(Object.values(Ze.HttpType.Enum)).default(Ze.HttpType.Enum.POST)})),pt=ct.Vo((e=>e&&e.type===v.WEBHOOK?dt:ut)),bt=e=>a.createElement("div",Object.assign({className:"pf-c-form"},re("Integrations/HttpForm",e)),a.createElement(l.FormTextInput,{isRequired:!0,label:"Endpoint URL",type:"url",name:"url",id:"integration-type-http-url",ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"endpoint-url")}),a.createElement(l.Checkbox,{id:"integration-type-http-ssl-verification-enabled",label:"Enable SSL verification",name:"sslVerificationEnabled",ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"is-ssl-verification-enabled")}),a.createElement(l.FormTextInput,{isRequired:!1,label:"Secret token",id:"integration-type-http-secret-token",name:"secretToken",ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"secret-token")})),ft=e=>{switch(e.type){case h.WEBHOOK:return a.createElement(bt,Object.assign({},e));default:(0,ie.vE)(e.type)}},mt=[v.WEBHOOK].map((e=>w.components.integrations.integrationType[e])).map((e=>a.createElement(_.FormSelectOption,{key:e,label:e}))),gt=e=>{const{values:t}=(0,st.useFormikContext)();return a.createElement(l.Form,Object.assign({},re("Integrations/Form",e)),a.createElement(l.FormTextInput,{maxLength:150,isRequired:!0,label:"Integration name",type:"text",name:"name",id:"name",ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"name")}),a.createElement(l.FormSelect,{isRequired:!0,label:"Type",name:"type",id:"integration-type",ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"type")},mt),a.createElement(ft,{type:t.type,ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"type-form")}))};const Et=e=>{const t=(e.isEdit?w.pages.integrations.edit:w.pages.integrations.add).title,{handleSubmit:n,isValid:i,isSubmitting:o}=(0,st.useFormikContext)(),r=a.useCallback((()=>(n(),!1)),[n]);return a.createElement(l.SaveModal,{isOpen:!0,isSaving:o,onSave:r,title:t,content:a.createElement(gt,null),onClose:e.onClose,error:e.error,actionButtonDisabled:!i})},yt=e=>{const[t]=a.useState((()=>Object.assign(Object.assign({},pt.cast(pt.cast())),e.initialIntegration))),n=a.useCallback((t=>{return n=void 0,a=void 0,o=function*(){const n=e.onSave,a=e.onClose,i=pt.cast(t);(yield n(i))&&a(!0)},new((i=void 0)||(i=Promise))((function(e,t){function l(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(l,r)}s((o=o.apply(n,a||[])).next())}));var n,a,i,o}),[e.onSave,e.onClose]);return a.createElement(st.Formik,{initialValues:t,validationSchema:pt,onSubmit:n,validateOnMount:!0},a.createElement(Et,{isEdit:e.isEdit,onClose:e.onClose,error:e.error}))},vt=e=>$e.EndpointServiceCreateEndpoint.actionCreator({body:Xe(e)}),ht=e=>e.id?$e.EndpointServiceUpdateEndpoint.actionCreator({body:Xe(e),id:e.id}):vt(e),St=e=>"Endpoint"===e.type?Object.assign(Object.assign({},e),{type:"Integration",value:Qe(e.value)}):e,It=e=>e.isEnabled?$e.EndpointServiceDisableEndpoint.actionCreator({id:e.id}):$e.EndpointServiceEnableEndpoint.actionCreator({id:e.id}),Nt=()=>(0,s.useMutation)(It);var Tt,Ct=n(91757);!function(e){e.SET_INTEGRATION="SET_INTEGRATION",e.START="START",e.FINISH="FINISH",e.UNSET="UNSET"}(Tt||(Tt={}));const Ot={setIntegration:(0,Ct.createAction)(Tt.SET_INTEGRATION)(),start:(0,Ct.createAction)(Tt.START)(),finish:(0,Ct.createAction)(Tt.FINISH)(),unset:(0,Ct.createAction)(Tt.UNSET)()},wt=e=>e.savedNotificationScope,At=(e,t)=>(null==e?void 0:e.integration)===(null==t?void 0:t.integration)&&(null==e?void 0:e.status)===(null==t?void 0:t.status);var kt;!function(e){e[e.LOADING=0]="LOADING",e[e.DONE=1]="DONE"}(kt||(kt={}));const Rt=e=>{const t=(0,c.useSelector)(wt,At),n=(0,c.useDispatch)(),i=Nt(),o=a.useCallback((()=>{const e=i.mutate;if(t){n(Ot.start());const a=t.integration;e(a).then((e=>{e.error?n(Ot.finish(a.isEnabled)):n(Ot.finish(!a.isEnabled))}))}}),[i.mutate,n,t]);return a.useEffect((()=>(n(Ot.setIntegration(e.integration)),()=>{n(Ot.unset())})),[n,e.integration]),t?a.createElement(rt,{integration:t.integration,isLoading:t.status===kt.LOADING,switchEnabled:o}):a.createElement(a.Fragment,null)},Dt=e=>{const t=(0,l.useTransformQueryResponse)((0,s.useMutation)(ht),St),[n,i]=a.useState(!1),o=a.useCallback((n=>(n.id||(n.isEnabled=!0),i(!1),t.mutate(n).then((t=>{if(t.error)return i(!0),!1;{const t=e.isEdit?`${n.name} saved successfully`:`${n.name} added successfully`;return(0,l.addSuccessNotification)(t,a.createElement(Rt,{integration:n}),!0),!0}})))),[t,e.isEdit]),r=a.useMemo((()=>{if(n)return e.isEdit?{title:"Integration failed to update",description:a.createElement("p",null,"There was an error trying to update the Integration. Please try again.")}:{title:"Failed to create Integration",description:a.createElement("p",null,"There was an error trying to create the Integration. Please try again.")}}),[n,e.isEdit]);return a.createElement(yt,{initialIntegration:e.initialIntegration,onSave:o,isEdit:e.isEdit,isSaving:t.loading,onClose:e.onClose,error:r})},Pt=e=>{const t=a.useCallback((()=>{const t=e.integration,n=e.onDelete;return!!t&&n(t)}),[e.onDelete,e.integration]),n=a.useMemo((()=>{var t,n;if(void 0===e.notifications)return a.createElement("span",{"data-testid":"loading"},a.createElement(_.Skeleton,null));if(0===e.notifications.length)return a.createElement("span",{"data-testid":"removing-integration-without-notifications"},"Removing integration ",a.createElement("strong",null,null===(t=e.integration)||void 0===t?void 0:t.name)," does not affect any notification events.");{const t=1!==e.notifications.length?"events":"event";return a.createElement("span",{"data-testid":`removing-integration-with-notifications-${e.notifications.length}`},"Removing integration ",a.createElement("strong",null,null===(n=e.integration)||void 0===n?void 0:n.name)," affects ",e.notifications.length," notification ",t,".",e.notifications.length>0&&a.createElement(_.ExpandableSection,{toggleText:`View ${e.notifications.length} ${t}.`},a.createElement(_.List,null,e.notifications.map((e=>a.createElement(_.ListItem,{key:e.id},e.applicationDisplayName,": ",e.eventTypeDisplayName))))))}}),[e.notifications,e.integration]);return e.integration?a.createElement(l.DeleteModal,{isOpen:!0,isDeleting:e.isDeleting,title:"Remove integration",content:n,onClose:e.onClose,onDelete:t,error:e.error,titleIconVariant:"warning"}):null};var jt,Lt,Ft;!function(e){function t(){return qe.object({accountId:qe.string().optional().nullable(),account_id:qe.string().optional().nullable(),application:qe.string().optional().nullable(),eventType:qe.string().optional().nullable(),event_type:qe.string().optional().nullable(),payload:O().optional().nullable(),schema:W().optional().nullable(),specificData:J().optional().nullable(),timestamp:qe.string().optional().nullable()}).nonstrict()}function n(){return qe.object({bundle_id:ee(),created:qe.string().optional().nullable(),display_name:qe.string(),eventTypes:z().optional().nullable(),id:ee().optional().nullable(),name:qe.string(),updated:qe.string().optional().nullable()}).nonstrict()}function a(){return qe.object({password:qe.string().optional().nullable(),username:qe.string().optional().nullable()}).nonstrict()}function i(){return qe.record(g())}function o(){return qe.object({convertedType:qe.unknown().optional().nullable(),logicalTypeName:qe.string().optional().nullable(),recommendedSchema:W().optional().nullable()}).nonstrict()}function l(){return qe.unknown()}function r(){return qe.object({created:qe.string().optional().nullable(),description:qe.string(),enabled:qe.boolean().optional().nullable(),id:ee().optional().nullable(),name:qe.string(),properties:qe.union([ne(),l()]).optional().nullable(),type:s(),updated:qe.string().optional().nullable()}).nonstrict()}function s(){return qe.enum(["webhook","email_subscription","default"])}function c(){return qe.object({value:qe.string().optional().nullable(),weak:qe.boolean().optional().nullable()}).nonstrict()}function u(){return qe.object({application:qe.lazy((()=>n())).optional().nullable(),description:qe.string().optional().nullable(),display_name:qe.string(),endpoints:q().optional().nullable(),id:ee().optional().nullable(),name:qe.string()}).nonstrict()}function d(){return qe.enum(["CLIENT_ERROR","INFORMATIONAL","OTHER","REDIRECTION","SERVER_ERROR","SUCCESSFUL"])}function p(){return qe.object({classPropEnabled:qe.boolean().optional().nullable(),data:f().optional().nullable(),keyClassEnabled:qe.boolean().optional().nullable(),readerCache:k().optional().nullable()}).nonstrict()}function b(){return qe.object({aliases:Q().optional().nullable(),defaultValue:g().optional().nullable(),doc:qe.string().optional().nullable(),name:qe.string().optional().nullable(),objectProps:L().optional().nullable(),order:V().optional().nullable(),position:qe.number().int().optional().nullable(),props:i().optional().nullable(),reserved:Q().optional().nullable(),schema:qe.lazy((()=>W())).optional().nullable()}).nonstrict()}function f(){return qe.object({classLoader:qe.unknown().optional().nullable(),conversions:P().optional().nullable(),conversionsByClass:w().optional().nullable(),defaultValueCache:A().optional().nullable(),fastReaderBuilder:qe.lazy((()=>p())).optional().nullable(),fastReaderEnabled:qe.boolean().optional().nullable()}).nonstrict()}function m(){return qe.enum(["GET","POST","PUT"])}function g(){return qe.object({array:qe.boolean().optional().nullable(),bigDecimal:qe.boolean().optional().nullable(),bigInteger:qe.boolean().optional().nullable(),binary:qe.boolean().optional().nullable(),boolean:qe.boolean().optional().nullable(),containerNode:qe.boolean().optional().nullable(),double:qe.boolean().optional().nullable(),empty:qe.boolean().optional().nullable(),float:qe.boolean().optional().nullable(),floatingPointNumber:qe.boolean().optional().nullable(),int:qe.boolean().optional().nullable(),integralNumber:qe.boolean().optional().nullable(),long:qe.boolean().optional().nullable(),missingNode:qe.boolean().optional().nullable(),nodeType:E().optional().nullable(),null:qe.boolean().optional().nullable(),number:qe.boolean().optional().nullable(),object:qe.boolean().optional().nullable(),pojo:qe.boolean().optional().nullable(),short:qe.boolean().optional().nullable(),textual:qe.boolean().optional().nullable(),valueNode:qe.boolean().optional().nullable()}).nonstrict()}function E(){return qe.enum(["ARRAY","BINARY","BOOLEAN","MISSING","NULL","NUMBER","OBJECT","POJO","STRING"])}function y(){return qe.array(qe.unknown())}function v(){return qe.object({params:F().optional().nullable(),rel:qe.string().optional().nullable(),rels:N().optional().nullable(),title:qe.string().optional().nullable(),type:qe.string().optional().nullable(),uri:qe.string().optional().nullable(),uriBuilder:te().optional().nullable()}).nonstrict()}function h(){return qe.array(r())}function S(){return qe.array(b())}function I(){return qe.array(qe.lazy((()=>W())))}function N(){return qe.array(qe.string())}function T(){return qe.object({country:qe.string().optional().nullable(),displayCountry:qe.string().optional().nullable(),displayLanguage:qe.string().optional().nullable(),displayName:qe.string().optional().nullable(),displayScript:qe.string().optional().nullable(),displayVariant:qe.string().optional().nullable(),extensionKeys:$().optional().nullable(),iSO3Country:qe.string().optional().nullable(),iSO3Language:qe.string().optional().nullable(),language:qe.string().optional().nullable(),script:qe.string().optional().nullable(),unicodeLocaleAttributes:Q().optional().nullable(),unicodeLocaleKeys:Q().optional().nullable(),variant:qe.string().optional().nullable()}).nonstrict()}function C(){return qe.object({name:qe.string().optional().nullable()}).nonstrict()}function O(){return qe.unknown()}function w(){return qe.record(P())}function A(){return qe.record(qe.unknown())}function k(){return qe.record(R())}function R(){return qe.object({empty:qe.boolean().optional().nullable()}).nonstrict()}function D(){return qe.record(qe.unknown())}function P(){return qe.record(o())}function j(){return qe.record(G())}function L(){return qe.record(qe.unknown())}function F(){return qe.record(qe.string())}function x(){return qe.record(W())}function _(){return qe.object({parameters:F().optional().nullable(),subtype:qe.string().optional().nullable(),type:qe.string().optional().nullable(),wildcardSubtype:qe.boolean().optional().nullable(),wildcardType:qe.boolean().optional().nullable()}).nonstrict()}function B(){return qe.object({count:qe.number().int()}).nonstrict()}function M(){return qe.record(qe.unknown())}function U(){return qe.record(qe.string())}function G(){return qe.object({comment:qe.string().optional().nullable(),domain:qe.string().optional().nullable(),expiry:qe.string().optional().nullable(),httpOnly:qe.boolean().optional().nullable(),maxAge:qe.number().int().optional().nullable(),name:qe.string().optional().nullable(),path:qe.string().optional().nullable(),secure:qe.boolean().optional().nullable(),value:qe.string().optional().nullable(),version:qe.number().int().optional().nullable()}).nonstrict()}function V(){return qe.enum(["ASCENDING","DESCENDING","IGNORE"])}function W(){return qe.object({aliases:Q().optional().nullable(),doc:qe.string().optional().nullable(),elementType:qe.lazy((()=>W())).optional().nullable(),enumDefault:qe.string().optional().nullable(),enumSymbols:N().optional().nullable(),error:qe.boolean().optional().nullable(),fields:S().optional().nullable(),fixedSize:qe.number().int().optional().nullable(),fullName:qe.string().optional().nullable(),hashCode:qe.number().int().optional().nullable(),logicalType:C().optional().nullable(),name:qe.string().optional().nullable(),namespace:qe.string().optional().nullable(),nullable:qe.boolean().optional().nullable(),objectProps:L().optional().nullable(),props:i().optional().nullable(),reserved:Q().optional().nullable(),type:X().optional().nullable(),types:I().optional().nullable(),union:qe.boolean().optional().nullable(),valueType:qe.lazy((()=>W())).optional().nullable()}).nonstrict()}function Z(){return qe.array(n())}function $(){return qe.array(qe.string())}function H(){return qe.array(qe.unknown())}function q(){return qe.array(r())}function z(){return qe.array(u())}function K(){return qe.array(v())}function Q(){return qe.array(qe.string())}function J(){return qe.object({classCache:D().optional().nullable(),classLoader:qe.unknown().optional().nullable(),conversions:P().optional().nullable(),conversionsByClass:w().optional().nullable(),customCoders:qe.boolean().optional().nullable(),defaultValueCache:A().optional().nullable(),fastReaderBuilder:p().optional().nullable(),fastReaderEnabled:qe.boolean().optional().nullable(),schemaClassCache:qe.unknown().optional().nullable(),schemaTypeCache:x().optional().nullable(),stringableClasses:H().optional().nullable(),useCustomCoderFlag:qe.boolean().optional().nullable()}).nonstrict()}function Y(){return qe.object({family:d().optional().nullable(),reasonPhrase:qe.string().optional().nullable(),statusCode:qe.number().int().optional().nullable()}).nonstrict()}function X(){return qe.enum(["ARRAY","BOOLEAN","BYTES","DOUBLE","ENUM","FIXED","FLOAT","INT","LONG","MAP","NULL","RECORD","STRING","UNION"])}function ee(){return qe.string()}function te(){return qe.unknown()}function ne(){return qe.object({basic_authentication:a().optional().nullable(),disable_ssl_verification:qe.boolean().optional().nullable(),method:m(),secret_token:qe.string().optional().nullable(),url:qe.string()}).nonstrict()}e.Action=t(),e.Application=n(),e.ApplicationFacet=qe.object({label:qe.string(),value:qe.string()}).nonstrict(),e.Attributes=qe.unknown(),e.BasicAuthentication=a(),e.Bundle=qe.object({applications:Z().optional().nullable(),created:qe.string().optional().nullable(),display_name:qe.string(),id:ee().optional().nullable(),name:qe.string(),updated:qe.string().optional().nullable()}).nonstrict(),e.ConcurrentMapStringJsonNode=i(),e.ConversionObject=o(),e.EmailSubscriptionAttributes=l(),e.Endpoint=r(),e.EndpointPage=qe.object({data:h(),links:F(),meta:B()}).nonstrict(),e.EndpointType=s(),e.EntityTag=c(),e.EventType=u(),e.Family=d(),e.FastReaderBuilder=p(),e.Field=b(),e.GenericData=f(),e.HttpType=m(),e.JsonNode=g(),e.JsonNodeType=E(),e.JsonObject=y(),e.Link=v(),e.ListEndpoint=h(),e.ListField=S(),e.ListSchema=I(),e.ListString=N(),e.Locale=T(),e.LogicalType=C(),e.Map=O(),e.MapClassObjectMapStringConversionObject=w(),e.MapFieldObject=A(),e.MapSchemaMapSchemaRecordReader=k(),e.MapSchemaRecordReader=R(),e.MapStringClass=D(),e.MapStringConversionObject=P(),e.MapStringNewCookie=j(),e.MapStringObject=L(),e.MapStringString=F(),e.MapTypeSchema=x(),e.MediaType=_(),e.Meta=B(),e.MultivaluedMapStringObject=M(),e.MultivaluedMapStringString=U(),e.NewCookie=G(),e.Notification=qe.object({action:t().optional().nullable(),endpoint:r().optional().nullable(),tenant:qe.string().optional().nullable()}).nonstrict(),e.NotificationHistory=qe.object({created:qe.string().optional().nullable(),details:y().optional().nullable(),endpointId:ee().optional().nullable(),eventId:qe.string().optional().nullable(),id:qe.number().int().optional().nullable(),invocationResult:qe.boolean().optional().nullable(),invocationTime:qe.number().int().optional().nullable()}).nonstrict(),e.Order=V(),e.Response=qe.object({allowedMethods:Q().optional().nullable(),cookies:j().optional().nullable(),date:qe.string().optional().nullable(),entity:qe.unknown().optional().nullable(),entityTag:c().optional().nullable(),headers:M().optional().nullable(),language:T().optional().nullable(),lastModified:qe.string().optional().nullable(),length:qe.number().int().optional().nullable(),links:K().optional().nullable(),location:qe.string().optional().nullable(),mediaType:_().optional().nullable(),metadata:M().optional().nullable(),status:qe.number().int().optional().nullable(),statusInfo:Y().optional().nullable(),stringHeaders:U().optional().nullable()}).nonstrict(),e.Schema=W(),e.SetApplication=Z(),e.SetCharacter=$(),e.SetClass=H(),e.SetEndpoint=q(),e.SetEventType=z(),e.SetLink=K(),e.SetString=Q(),e.SetUUID=qe.array(qe.string()),e.SpecificData=J(),e.StatusType=Y(),e.Type=X(),e.UUID=ee(),e.UriBuilder=te(),e.WebhookAttributes=ne()}(jt||(jt={})),function(e){let t,n,a,i,o,l,s,c,u,d,p;!function(e){const t=qe.array(jt.Endpoint);e.actionCreator=()=>(0,r.actionBuilder)("GET","/api/notifications/v1.0/notifications/defaults").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(t=e.NotificationServiceGetEndpointsForDefaults||(e.NotificationServiceGetEndpointsForDefaults={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/defaults/{endpointId}".replace("{endpointId}",e.endpointId.toString());return(0,r.actionBuilder)("PUT",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(n=e.NotificationServiceAddEndpointToDefaults||(e.NotificationServiceAddEndpointToDefaults={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/defaults/{endpointId}".replace("{endpointId}",e.endpointId.toString());return(0,r.actionBuilder)("DELETE",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",204)]}).build()}}(a=e.NotificationServiceDeleteEndpointFromDefaults||(e.NotificationServiceDeleteEndpointFromDefaults={})),function(e){qe.number().int(),qe.number().int(),qe.number().int(),qe.string();const t=qe.array(jt.EventType);e.actionCreator=e=>{const n={};return void 0!==e.applicationIds&&(n.applicationIds=e.applicationIds),void 0!==e.limit&&(n.limit=e.limit),void 0!==e.offset&&(n.offset=e.offset),void 0!==e.pageNumber&&(n.pageNumber=e.pageNumber),void 0!==e.sortBy&&(n.sort_by=e.sortBy),(0,r.actionBuilder)("GET","/api/notifications/v1.0/notifications/eventTypes").queryParams(n).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(i=e.NotificationServiceGetEventTypes||(e.NotificationServiceGetEventTypes={})),function(e){const t=qe.array(jt.EventType);e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/eventTypes/affectedByRemovalOfEndpoint/{endpointId}".replace("{endpointId}",e.endpointId.toString());return(0,r.actionBuilder)("GET",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(o=e.NotificationServiceGetEventTypesAffectedByEndpointId||(e.NotificationServiceGetEventTypesAffectedByEndpointId={})),function(e){qe.number().int(),qe.number().int(),qe.number().int(),qe.string();const t=qe.array(jt.Endpoint);e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/eventTypes/{eventTypeId}".replace("{eventTypeId}",e.eventTypeId.toString()),a={};return void 0!==e.limit&&(a.limit=e.limit),void 0!==e.offset&&(a.offset=e.offset),void 0!==e.pageNumber&&(a.pageNumber=e.pageNumber),void 0!==e.sortBy&&(a.sort_by=e.sortBy),(0,r.actionBuilder)("GET",n).queryParams(a).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(l=e.NotificationServiceGetLinkedEndpoints||(e.NotificationServiceGetLinkedEndpoints={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/eventTypes/{eventTypeId}/{endpointId}".replace("{endpointId}",e.endpointId.toString()).replace("{eventTypeId}",e.eventTypeId.toString());return(0,r.actionBuilder)("PUT",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(s=e.NotificationServiceLinkEndpointToEventType||(e.NotificationServiceLinkEndpointToEventType={})),function(e){const t=qe.string();e.actionCreator=e=>{const n="/api/notifications/v1.0/notifications/eventTypes/{eventTypeId}/{endpointId}".replace("{endpointId}",e.endpointId.toString()).replace("{eventTypeId}",e.eventTypeId.toString());return(0,r.actionBuilder)("DELETE",n).queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",204)]}).build()}}(c=e.NotificationServiceUnlinkEndpointFromEventType||(e.NotificationServiceUnlinkEndpointFromEventType={})),function(e){qe.string();const t=qe.array(jt.ApplicationFacet);e.actionCreator=e=>{const n={};return void 0!==e.bundleName&&(n.bundleName=e.bundleName),(0,r.actionBuilder)("GET","/api/notifications/v1.0/notifications/facets/applications").queryParams(n).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}}(u=e.NotificationServiceGetApplicationsFacets||(e.NotificationServiceGetApplicationsFacets={})),function(e){const t=qe.array(jt.Notification);e.actionCreator=()=>(0,r.actionBuilder)("GET","/api/notifications/v1.0/notifications/updates").queryParams({}).config({rules:[new He.ValidateRule(t,"unknown",200)]}).build()}(d=e.NotificationServiceGetNotificationUpdates||(e.NotificationServiceGetNotificationUpdates={})),function(e){qe.number().int();const t=qe.string();e.actionCreator=e=>(0,r.actionBuilder)("DELETE","/api/notifications/v1.0/notifications/{id}").queryParams({}).data(e.body).config({rules:[new He.ValidateRule(t,"unknown",204)]}).build()}(p=e.NotificationServiceMarkRead||(e.NotificationServiceMarkRead={}))}(Lt||(Lt={})),function(e){e.EMAIL_SUBSCRIPTION="EMAIL_SUBSCRIPTION",e.DRAWER="DRAWER",e.INTEGRATION="INTEGRATION"}(Ft||(Ft={}));const xt=(e,t)=>{if(e===Ft.INTEGRATION){const n=(e=>{const t=Qe(e);if(!Object.values(h).includes(t.type))throw new Error(`Unknown UserIntegrationType ${t.type}`);return t})(t);return{type:e,integrationId:n.id,integration:n}}return{type:e,integrationId:Qe(t).id,recipient:[]}},_t=e=>-1!==e.findIndex((e=>e.type===jt.EndpointType.enum.default)),Bt=e=>{var t,n;if(!e.id||!e.application)throw new Error(`Unexpected notification from server ${JSON.stringify(e)}`);return{id:e.id,applicationDisplayName:e.application.display_name,eventTypeDisplayName:e.display_name,actions:Gt(et(null!==(t=e.endpoints)&&void 0!==t?t:[])),useDefault:_t(null!==(n=e.endpoints)&&void 0!==n?n:[])}},Mt=e=>{switch(e.type){case jt.EndpointType.enum.webhook:return xt(Ft.INTEGRATION,e);case jt.EndpointType.enum.email_subscription:return xt(Ft.EMAIL_SUBSCRIPTION,e);case jt.EndpointType.enum.default:throw new Error("EndpointType.default should not reach this point");default:(0,ie.vE)(e.type)}},Ut=e=>e.map(Bt),Gt=e=>et(e).map(Mt),Vt=e=>Lt.NotificationServiceGetEventTypesAffectedByEndpointId.actionCreator({endpointId:e}),Wt=(0,He.validationResponseTransformer)((e=>200===e.status?(0,He.validatedResponse)("Notifications",200,Ut(e.value),e.errors):e)),Zt=e=>$e.EndpointServiceDeleteEndpoint.actionCreator({id:e}),$t=e=>{const t=(0,s.useMutation)(Zt),n=(0,l.useTransformQueryResponse)((0,s.useParameterizedQuery)(Vt),Wt),[i,o]=a.useState(!1),r=a.useCallback((e=>{const n=t.mutate;return o(!1),n(e.id).then((e=>e.error?(o(!0),!1):((0,l.addSuccessNotification)("Integration removed","The integration was removed."),!0)))}),[t.mutate,o]),c=a.useMemo((()=>{if(i)return{title:"Failed to remove Integration",description:a.createElement("p",null,"There was an error trying to remove the Integration. Please try again.")}}),[i]);a.useEffect((()=>{(0,n.query)(e.integration.id)}),[e.integration,n.query]);const u=a.useMemo((()=>{const e=n.payload;if(e&&"Notifications"===e.type)return e.value}),[n.payload]);return a.createElement(Pt,{integration:e.integration,notifications:u,isDeleting:t.loading,onClose:e.onClose,onDelete:r,error:c})};var Ht;!function(e){e.DELETE="delete",e.NONE="none"}(Ht||(Ht={}));const qt={integration:void 0},zt=(e,t)=>{switch(t.type){case Ht.DELETE:return{integration:t.integration};case Ht.NONE:return qt;default:(0,ie.vE)(t)}},Kt=()=>(0,a.useReducer)(zt,qt);var Qt;Kt.makeNoneAction=()=>({type:Ht.NONE}),Kt.makeDeleteAction=e=>({type:Ht.DELETE,integration:e}),function(e){e.EDIT="edit",e.CREATE="create",e.NONE="none"}(Qt||(Qt={}));const Jt={isOpen:!1,isEdit:!1,template:void 0,isCopy:!1},Yt=(e,t)=>{switch(t.type){case Qt.CREATE:return{isOpen:!0,isEdit:!1,template:t.template?Object.assign(Object.assign({},t.template),{name:`Copy of ${t.template.name}`}):void 0,isCopy:!!t.template};case Qt.EDIT:return{isOpen:!0,isEdit:!0,template:t.template,isCopy:!1};case Qt.NONE:return Jt;default:(0,ie.vE)(t)}},Xt=e=>(0,l.useUrlStateString)("name",e),en=e=>(0,l.useUrlStateMultipleOptions)("enabled",["Enabled","Disabled"]),tn=e=>{switch(e){case Ue.NAME:return Xt;case Ue.ENABLED:return en;default:(0,ie.vE)(e)}};var nn=n(80406),an=n.n(nn),on=n(50744),ln=n(37176);const rn=e=>e.savedNotificationScope,sn=(e,t)=>(null==e?void 0:e.integration)===(null==t?void 0:t.integration)&&(null==e?void 0:e.status)===(null==t?void 0:t.status);const cn=e=>{var t;const n=new l.Filter;if(1===(null===(t=null==e?void 0:e.enabled)||void 0===t?void 0:t.length)){const t="enabled"===e.enabled[0].toLocaleLowerCase();n.and("active",l.Operator.EQUAL,t.toString())}return n.and("type",l.Operator.EQUAL,v.WEBHOOK)};var un=n(52542),dn=n(54881),pn=n(20365),bn=n(96893),fn=n(36853);const mn=n.p+"fonts/WebhookIcon.svg",gn=(0,le.style)({verticalAlign:"-0.125em",width:"1em",height:"1em"}),En=()=>a.createElement("img",{className:gn,src:mn}),yn=(0,le.style)({marginLeft:ee.default.var}),vn=(0,le.style)({color:"#888"}),hn=e=>{switch(e.actionType){case Ft.DRAWER:return a.createElement(fn.ZP,null);case Ft.EMAIL_SUBSCRIPTION:return a.createElement(bn.ZP,null);case Ft.INTEGRATION:return a.createElement(En,null);default:(0,ie.vE)(e.actionType)}},Sn=e=>a.createElement("div",Object.assign({},re("Notifications/ActionComponent",e)),e.children),In=e=>e.loading?a.createElement(Sn,Object.assign({},e),a.createElement(_.Spinner,{size:"md"})):e.hasError?a.createElement(Sn,Object.assign({},e),a.createElement("span",null,"Error loading actions")):e.isDefault?a.createElement(Sn,Object.assign({},e),a.createElement("span",null,"Default behavior")):e.action?a.createElement(Sn,Object.assign({},e),a.createElement(hn,{actionType:e.action.type}),a.createElement("span",{className:yn},w.components.notifications.types[e.action.type]),e.action.type===Ft.INTEGRATION&&a.createElement("span",null,": ",w.components.integrations.integrationType[e.action.integration.type])):a.createElement(Sn,Object.assign({},e),a.createElement("span",{className:vn},a.createElement("div",null,"No actions."),a.createElement("div",null,"Users will not be notified.")));var Nn=n(35224),Tn=n(69174);const Cn=(0,le.style)({marginLeft:ee.default.var}),On=e=>e.action.type===Ft.INTEGRATION?a.createElement(a.Fragment,null,a.createElement("span",null,e.action.integration.name),!e.action.integration.isEnabled&&a.createElement(a.Fragment,null,a.createElement(Nn.u,{content:"This integration has been disabled. This action wil not fire until it is enabled.",position:"bottom"},a.createElement(Tn._,{variant:e.hasOutline?"outline":"filled",className:Cn},"Disabled")))):a.createElement("span",null,"All registered users");(0,le.cssRaw)(`\n    table.withDark300Skeleton .pf-c-skeleton {\n        ${un.ZP.name}: ${pn.ZP.var} \n    }\n`);const wn=(0,le.style)({backgroundColor:"#f0f0f0",paddingTop:X.ZP.var,paddingBottom:X.ZP.var,paddingLeft:X.ZP.var,paddingRight:X.ZP.var}),An=(0,le.style)({paddingTop:X.ZP.var,display:"block",$nest:{"& td, & th":{paddingTop:ce.ZP.var,paddingBottom:ce.ZP.var,paddingLeft:X.ZP.var,paddingRight:X.ZP.var,fontSize:dn.ZP.var},"& td:first-child, & th:first-child":{paddingLeft:0},"& thead:first-child th":{paddingTop:0}}}),kn=(0,le.style)({fontWeight:600}),Rn=e=>{var t;return a.createElement("div",Object.assign({},re("Notifications/DefaultBehavior",e),{className:wn}),a.createElement("div",{className:kn},"Default behavior ",a.createElement(ot.zx,{onClick:e.onEdit,isDisabled:!e.onEdit,variant:ot.Wu.link},"Edit defaults")),a.createElement("div",null,"Default behavior applies to all notifications in a bundle. You can override this default for any specific event type."),a.createElement("table",{className:`${An} withDark300Skeleton`},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Action"),a.createElement("th",null,"Recipient"))),a.createElement("tbody",null,e.loading?a.createElement(a.Fragment,null,a.createElement("tr",null,a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"})),a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"}))),a.createElement("tr",null,a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"})),a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"}))),a.createElement("tr",null,a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"})),a.createElement("td",null,a.createElement(_.Skeleton,{width:"200px"})))):void 0===e.defaultBehavior?a.createElement("tr",null,a.createElement("td",null,"Error while loading the default behavior. ")):null===(t=e.defaultBehavior)||void 0===t?void 0:t.actions.map(((e,t)=>a.createElement("tr",{key:t},a.createElement("td",null,a.createElement(In,{isDefault:!1,action:e})),a.createElement("td",null," ",a.createElement(On,{action:e,hasOutline:!0}))))))))};var Dn;n(91406),function(e){e.Application="application",e.None="none"}(Dn||(Dn={}));const Pn=(0,le.style)({borderBottom:"var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)"}),jn=(0,le.style)({borderBottom:"none !important"}),Ln=(0,le.style)({paddingBottom:"0 !important"}),Fn=(0,le.style)({paddingLeft:`${X.ZP.var} !important`}),xn={"--pf-c-table__expandable-row-content--PaddingBottom":"0"},_n=(0,le.style)({paddingTop:`${ee.default.var} !important`}),Bn={"--pf-c-table__expandable-row-content--PaddingTop":"0"},Mn=(0,le.style)({color:"#888"}),Un=(0,le.style)({$nest:{"&:after":{borderLeft:"none !important",paddingBottom:"0 !important"}}});(0,le.cssRaw)(`\n.notification-table table {\n    --pf-c-table--m-compact__expandable-row-content--PaddingTop: ${ee.default.var};\n    --pf-c-table--m-compact__expandable-row-content--PaddingBottom: ${ee.default.var};\n}\n`);const Gn=(0,le.style)({fontWeight:600}),Vn=[{title:w.components.notifications.table.columns.event,transforms:[],cellFormatters:[z.zW]},{title:w.components.notifications.table.columns.action,transforms:[]},{title:w.components.notifications.table.columns.recipient,transforms:[]},{title:""}],Wn=e=>a.createElement(a.Fragment,null,a.createElement("div",null," ",e.eventTypeDisplayName," "),a.createElement("div",{className:Mn}," ",e.applicationDisplayName," ")),Zn=e=>{var t;const{trRef:n,className:i,rowProps:o,row:l}=e,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["trRef","className","rowProps","row"]);if(!l)return a.createElement(a.Fragment,null);const s=(null===(t=l.props)||void 0===t?void 0:t.className)?l.props.className:"";return a.createElement("tr",Object.assign({},r,{ref:n,className:(0,H.i)(i,void 0!==l.isExpanded&&q.Z.tableExpandableRow,l.isExpanded&&q.Z.modifiers.expanded,s),hidden:void 0!==(null==l?void 0:l.isExpanded)&&!l.isExpanded}),e.children)},$n=(e,t,n)=>e.reduce(((e,i)=>{const o=Math.max(1,i.useDefault?1:i.actions.length),r=i.actions.length>0?i.actions[0]:void 0;e.push({id:`${void 0!==n?n.toString()+"-":""}${i.id}`,key:`${void 0!==n?n.toString()+"-":""}${i.id}`,cells:[{title:a.createElement(Wn,{applicationDisplayName:i.applicationDisplayName,eventTypeDisplayName:i.eventTypeDisplayName}),props:{rowSpan:o,className:(0,l.joinClasses)(Un,Pn),colSpan:void 0===n?1:2}},{title:a.createElement(a.Fragment,null,a.createElement("span",null,a.createElement(In,{isDefault:!!i.useDefault,action:r,loading:"loading"===i.loadingActionStatus,hasError:"error"===i.loadingActionStatus}))),props:{className:(0,l.joinClasses)(Fn,Ln),style:xn}},{title:a.createElement(a.Fragment,null,a.createElement("span",null,r&&a.createElement(On,{action:r}))),props:{className:Ln,style:xn}},{title:a.createElement(a.Fragment,null,a.createElement(ot.zx,{onClick:()=>t&&t(i),isDisabled:!t,variant:ot.Wu.link},"Edit")),props:{className:Ln,style:xn}}],props:{className:i.actions.length>1?jn:""}}),void 0!==n&&(e[e.length-1].parent=n,e[e.length-1].fullWidth=!0);for(let t=1;t<o;++t){const r=(0,l.joinClasses)(t+1===o?"":Ln,_n),s=`${i.id}-action-${t}`,c=Object.assign(Object.assign({},Bn),t+1===o?{}:xn);e.push({id:`${void 0!==n?n.toString()+"-":""}${s}`,key:`${void 0!==n?n.toString()+"-":""}${s}`,cells:[{title:a.createElement(In,{isDefault:!!i.useDefault,action:i.actions[t],loading:"loading"===i.loadingActionStatus,hasError:"error"===i.loadingActionStatus}),props:{className:(0,l.joinClasses)(Un,r,Fn),style:c}},{title:a.createElement(On,{action:i.actions[t]}),props:{className:r,style:c}},{props:{className:r,style:c}}],props:{className:t+1===o?"":jn}}),void 0!==n&&(e[e.length-1].parent=n,e[e.length-1].fullWidth=!0)}return e}),[]),Hn=e=>{const t=a.useMemo((()=>{const t=e.notifications;switch(t.grouped){case Dn.Application:return n=t.data,i=e.onEdit,n.reduce(((e,t)=>(e.push({id:t.applicationDisplayName,key:t.applicationDisplayName,cells:[{title:a.createElement("span",{className:Gn}," Application: ",t.applicationDisplayName),props:{className:Un}},{title:"",props:{colSpan:Vn.length-1}}],isOpen:t.isOpen}),e.push(...$n(t.notifications,i,e.length-1)),e)),[]);case Dn.None:return $n(t.data,e.onEdit);default:(0,ie.vE)(t)}var n,i}),[e.notifications,e.onEdit]),n=a.useCallback(((t,n,a,i)=>{const o=e.notifications,l=e.onCollapse;if(o.grouped===Dn.None)throw new Error("Invalid group None for CollapseHandler");const r=o.data.findIndex((e=>e.applicationDisplayName===i.id));l&&void 0!==r&&-1!==r&&l(r,a)}),[e.onCollapse,e.notifications]);return a.createElement("div",Object.assign({},re("Notifications/Table",e),{className:"notification-table"}),a.createElement(K.i,{"aria-label":w.components.notifications.table.title,rows:t,cells:Vn,onCollapse:n,rowWrapper:Zn,variant:"compact"},a.createElement(Q.x,null),a.createElement(J.R,null)))};var qn;!function(e){e.NAME="name",e.APPLICATION="application",e.ACTION="action"}(qn||(qn={}));var zn=n(84457),Kn=n(56787),Qn=n(75728),Jn=n(96466),Yn=n(23204),Xn=n.n(Yn);const ea=e=>{const t=[a.createElement(zn.h,{"data-group-by":Dn.Application,key:"application"},"Application"),a.createElement(zn.h,{"data-group-by":Dn.None,key:"none"},"None")],[n,i]=a.useState(!1),o=a.useCallback((t=>{const n=e.groupBy,a=e.selected;if(t.target.dataset.groupBy!==a)switch(t.target.dataset.groupBy){case Dn.Application:n(Dn.Application);break;case Dn.None:n(Dn.None)}i(!1)}),[e.groupBy,e.selected]),l=a.useCallback((e=>{i(e)}),[i]),r=a.useMemo((()=>`Group by: ${Xn()(e.selected,{pascalCase:!0})}`),[e.selected]);return a.createElement(Kn.L,{onSelect:o,isOpen:n,toggle:a.createElement(Qn.Z,{id:"group-by-dropdown-toggle",toggleIndicator:Jn.ZP,onToggle:l},r),dropdownItems:t})},ta=e=>{const t=(0,a.useMemo)((()=>{const t=e.appFilterOptions.map((e=>({value:e.label,label:a.createElement(a.Fragment,null," ",e.label)})));return{[qn.NAME]:{label:"Event type",placeholder:"Filter by event type"},[qn.APPLICATION]:{label:"Application",placeholder:"Filter by application",options:{exclusive:!1,default:[],items:t}},[qn.ACTION]:{label:"Action",placeholder:"Filter by action"}}}),[e.appFilterOptions]),n=(0,l.usePrimaryToolbarFilterConfig)(qn,e.filters,e.setFilters,e.clearFilter,t),i=Be(e.onExport),o=(0,l.useInsightsEnvironmentFlag)((0,l.getInsights)(),Me,void 0,(0,a.useCallback)((()=>n.filterConfig),[n])),r=(0,l.useInsightsEnvironmentFlag)((0,l.getInsights)(),Me,void 0,(0,a.useCallback)((()=>n.activeFiltersConfig),[n])),s=(0,l.useInsightsEnvironmentFlag)((0,l.getInsights)(),Me,void 0,(0,a.useCallback)((()=>i),[i]));return a.createElement("div",Object.assign({},re("Notifications/DualToolbar",e)),a.createElement(_e.Z,{filterConfig:o,activeFiltersConfig:r,dedicatedAction:a.createElement(ea,{selected:e.groupBy,groupBy:e.onGroupBySelected}),exportConfig:s}),e.children,a.createElement(_e.Z,null))},na=()=>Lt.NotificationServiceGetEndpointsForDefaults.actionCreator(),aa=(0,He.validationResponseTransformer)((e=>200===e.status?(0,He.validatedResponse)("DefaultNotificationBehavior",200,{actions:Gt(e.value)},e.errors):e)),ia=(0,He.validationResponseTransformer)((e=>200===e.status?(0,He.validatedResponse)("eventTypesArray",200,Ut(e.value),e.errors):e));var oa=n(80236);const la=ct.Ry({type:ct.nK().oneOf([Ft.INTEGRATION]).required(),integration:ct.Ry({id:ct.Z_().required()}).required(),integrationId:ct.Z_().min(1)}),ra=ct.Ry({type:ct.nK().oneOf([Ft.EMAIL_SUBSCRIPTION]).required(),recipient:ct.IX(ct.Z_()).min(0),integrationId:ct.Z_().min(0)}),sa=ct.Ry({actions:ct.IX(ct.Vo((e=>e.hasOwnProperty("type")&&e.type===Ft.INTEGRATION?la:ra)))});var ca=n(20777),ua=n(33606),da=n(2644),pa=n(64403),ba=n(92694);class fa{constructor(e){"integration"===e.kind?(this.notificationType=Ft.INTEGRATION,this.integrationType=e.type):(this.notificationType=e.type,this.integrationType=void 0)}compareTo(e){return e instanceof fa&&e.notificationType===this.notificationType&&e.integrationType===this.integrationType}toString(){const e=w.components.notifications.types[this.notificationType];return this.integrationType?`${e}: ${w.components.integrations.integrationType[this.integrationType]}`:e}}const ma=e=>{const[t,n]=a.useState(!1),i=a.useCallback((()=>{n((e=>!e))}),[n]),o=a.useCallback(((t,a)=>{const i=e.onSelected;a instanceof fa&&(i(a),n(!1))}),[e.onSelected,n]),r=a.useMemo((()=>e.action.type===Ft.INTEGRATION?new fa({kind:"integration",type:e.action.integration.type}):new fa({kind:"notification",type:e.action.type})),[e.action]),s=(c=(0,l.getInsights)(),Me.includes((0,l.getInsightsEnvironment)(c)));var c;return a.createElement("div",Object.assign({},re("ActionTypeahead",e)),a.createElement(da.P,{variant:pa.TM.typeahead,typeAheadAriaLabel:"Select an action type",selections:r,onToggle:i,isOpen:t,onSelect:o,menuAppendTo:document.body,isDisabled:e.isDisabled},[...[Ft.DRAWER,Ft.EMAIL_SUBSCRIPTION].map((e=>new fa({kind:"notification",type:e}))),...[h.WEBHOOK].map((e=>new fa({kind:"integration",type:e})))].filter((e=>!s||e.notificationType===Ft.INTEGRATION)).map((e=>a.createElement(ba.$,{key:e.toString(),value:e})))))};class ga{constructor(e){this.recipientOrIntegration=e}compareTo(e){return e instanceof ga&&typeof e.recipientOrIntegration==typeof this.recipientOrIntegration&&("string"==typeof e.recipientOrIntegration?e.recipientOrIntegration===this.recipientOrIntegration:e.recipientOrIntegration.id===this.recipientOrIntegration.id)}toString(){if("string"==typeof this.recipientOrIntegration)return this.recipientOrIntegration;{const e=this.recipientOrIntegration.isEnabled?"":" - Disabled";return`${this.recipientOrIntegration.name}${e}`}}}const Ea=e=>a.createElement(ba.$,{key:"string"==typeof e?e:e.id,value:new ga(e)}),ya=e=>a.useMemo((()=>"default"===e.show?e.loadingDefault?[a.createElement(ba.$,{key:"loading-option",isNoResultsOption:!0,value:"Loading..."})]:e.defaultValues.map(Ea):"filter"===e.show?e.loadingFilter?[a.createElement(ba.$,{key:"loading-option",isNoResultsOption:!0,value:"Loading..."})]:e.filterValues.map(Ea):void(0,ie.ZP)(e.show)),[e]);var va;!function(e){e[e.LOAD_FILTER_VALUE=0]="LOAD_FILTER_VALUE",e[e.SET_FILTER_VALUE=1]="SET_FILTER_VALUE",e[e.USE_DEFAULTS=2]="USE_DEFAULTS",e[e.SET_DEFAULTS=3]="SET_DEFAULTS"}(va||(va={}));const ha=(e,t)=>{switch(t.type){case va.SET_FILTER_VALUE:return t.search===e.lastSearch?t.values===e.filterValues?e:Object.assign(Object.assign({},e),{loadingFilter:!1,filterValues:t.values}):e;case va.LOAD_FILTER_VALUE:return t.search!==e.lastSearch||"filter"!==e.show?Object.assign(Object.assign({},e),{loadingFilter:!0,filterValues:[],lastSearch:t.search,show:"filter"}):e;case va.USE_DEFAULTS:return"default"!==e.show?Object.assign(Object.assign({},e),{show:"default"}):e;case va.SET_DEFAULTS:return Object.assign(Object.assign({},e),{defaultValues:t.values,loadingDefault:!1});default:(0,ie.ZP)(t)}},Sa=()=>{const[e,t]=(0,a.useReducer)(ha,{filterValues:[],defaultValues:[],show:"default",loadingFilter:!1,loadingDefault:!0,lastSearch:""}),n=(0,a.useCallback)(((e,n)=>t({type:va.SET_FILTER_VALUE,values:n,search:e})),[t]),i=(0,a.useCallback)((e=>t({type:va.LOAD_FILTER_VALUE,search:e})),[t]),o=(0,a.useCallback)((e=>t({type:va.SET_DEFAULTS,values:e})),[t]),l=(0,a.useCallback)((()=>t({type:va.USE_DEFAULTS})),[t]);return[e,(0,a.useMemo)((()=>({setFilterValue:n,loadFilterValue:i,setDefaults:o,useDefaults:l})),[n,i,o,l])]},Ia=e=>{const[t,n]=a.useState(!1),[i,o]=Sa(),l=a.useCallback((e=>{n(e)}),[n]);a.useEffect((()=>{(0,e.getIntegrations)(e.integrationType,"").then((e=>o.setDefaults(e)))}),[e.getIntegrations,e.integrationType,o]),a.useEffect((()=>{const t=e.getIntegrations;i.loadingFilter&&t(e.integrationType,i.lastSearch).then((e=>o.setFilterValue(i.lastSearch,e)))}),[e.getIntegrations,e.integrationType,i.loadingFilter,i.lastSearch,o]);const r=a.useCallback((e=>{var t;const n=null===(t=e.target.value)||void 0===t?void 0:t.trim();return""===n?o.useDefaults():o.loadFilterValue(n),[]}),[o]),s=ya(i),c=a.useMemo((()=>{const t=e.selected;if(void 0!==t&&void 0!==t.name&&void 0!==t.id&&void 0!==t.type)return new ga(t)}),[e.selected]),u=a.useCallback(((t,a)=>{const i=e.onSelected;a instanceof ga&&(i(a),n(!1))}),[e.onSelected]);return a.createElement("div",Object.assign({},re("IntegrationRecipientTypeahead",e)),a.createElement(da.P,{variant:pa.TM.typeahead,typeAheadAriaLabel:"Choose webhook",placeholderText:"Choose webhook",selections:c,onSelect:u,onToggle:l,isOpen:t,onFilter:r,menuAppendTo:document.body,isDisabled:e.isDisabled},s))},Na=e=>{const[t,n]=a.useState(!1),[i,o]=Sa();a.useEffect((()=>{(0,e.getRecipients)("").then((e=>o.setDefaults(e)))}),[e.getRecipients,o]),a.useEffect((()=>{const t=e.getRecipients;i.loadingFilter&&t(i.lastSearch).then((e=>o.setFilterValue(i.lastSearch,e)))}),[e.getRecipients,i.loadingFilter,i.lastSearch,o]);const l=a.useCallback((e=>{n(e)}),[n]),r=a.useCallback((e=>{var t;const n=null===(t=e.target.value)||void 0===t?void 0:t.trim();return""===n?o.useDefaults():o.loadFilterValue(n),[]}),[o]),s=ya(i),c=(a.useMemo((()=>{const t=e.selected;if(void 0!==t)return t.map((e=>new ga(e)))}),[e.selected]),a.useCallback(((t,n)=>{const a=e.onSelected;n instanceof ga&&a(n)}),[e.onSelected]));return a.createElement("div",Object.assign({},re("RecipientTypeahead",e)),a.createElement(da.P,{variant:pa.TM.single,typeAheadAriaLabel:"Select the recipients",selections:"All registered users",onSelect:c,onToggle:l,isOpen:t,onFilter:r,menuAppendTo:document.body,isDisabled:!0},s))},Ta=e=>{var t,n;const{setFieldValue:i}=(0,st.useFormikContext)(),[o,l,r]=(0,st.useField)(`${e.path}.recipient`),s=a.useCallback((t=>{i(`${e.path}.type`,t.notificationType),t.integrationType?(i(`${e.path}.integration`,{type:t.integrationType}),i(`${e.path}.recipient`,[]),i(`${e.path}.integrationId`,"")):(i(`${e.path}.recipient`,[]),i(`${e.path}.integration`,void 0),i(`${e.path}.integrationId`,""))}),[i,e.path]),c=a.useCallback((t=>{"string"!=typeof t.recipientOrIntegration&&(i(`${e.path}.integration`,t.recipientOrIntegration),i(`${e.path}.integrationId`,t.recipientOrIntegration.id))}),[i,e.path]),u=a.useCallback((e=>{if(o.value){const t=o.value,n=t.indexOf(e.toString());-1===n?r.setValue([...t,e.toString()]):r.setValue([...t].filter(((e,t)=>t!==n)))}}),[o,r]),d=a.useCallback((()=>{r.setValue([])}),[r]);return a.createElement("tr",null,a.createElement("td",null,a.createElement(ma,{action:e.action,onSelected:s,isDisabled:e.isDisabled,ouiaId:`${e.ouiaId?"action-"+e.ouiaId:void 0}`})),a.createElement("td",null,e.action.type===Ft.INTEGRATION?a.createElement(Ia,{onSelected:c,integrationType:null!==(n=null===(t=e.action.integration)||void 0===t?void 0:t.type)&&void 0!==n?n:h.WEBHOOK,selected:e.action.integration,getIntegrations:e.getIntegrations,isDisabled:e.isDisabled,ouiaId:`${e.ouiaId?"recipient-"+e.ouiaId:void 0}`}):a.createElement(Na,{onSelected:u,selected:e.action.recipient,getRecipients:e.getRecipients,isDisabled:e.isDisabled,onClear:d,ouiaId:`${e.ouiaId?"recipient-"+e.ouiaId:void 0}`})),a.createElement("td",null,a.createElement(ot.zx,{onClick:e.onRemove,variant:ot.Wu.plain},a.createElement(ua.ZP,null))))},Ca=e=>a.createElement(a.Fragment,null,a.createElement("thead",Object.assign({},re("Notifications/Form/EditableActionHeader",{})),a.createElement("tr",null,a.createElement("th",null,"Action"),a.createElement("th",null,"Recipient"),a.createElement("th",null))),a.createElement("tbody",Object.assign({},re("Notifications/Form/EditableActionBody",{})),e.actions.map(((t,n)=>a.createElement(Ta,{key:n,ouiaId:`${n}`,action:t,isDisabled:e.isDisabled,path:`${e.path}.${n}`,getRecipients:e.getRecipients,getIntegrations:e.getIntegrations,onRemove:e.handleRemove?e.handleRemove(n):void 0}))))),Oa=(0,le.style)({textAlign:"left",paddingLeft:0}),wa=(0,le.style)({display:"block",$nest:{"& td, & th":{paddingTop:ee.default.var,paddingBottom:ee.default.var,paddingLeft:X.ZP.var,paddingRight:X.ZP.var},"& th":{width:"500px"},"& th:last-child":{width:"80px"},"& td:first-child, & th:first-child":{paddingLeft:0}}}),Aa=e=>{const{values:t,isSubmitting:n}=e.form,i=t.actions,o=a.useCallback((()=>{(0,e.push)({type:Ft.EMAIL_SUBSCRIPTION,integrationId:"",recipient:[]})}),[e.push]);return a.createElement(a.Fragment,null,(void 0===i||0===i.length)&&a.createElement("tbody",Object.assign({},re("Notifications/Form/NoActions",{})),a.createElement("tr",null,a.createElement("td",{colSpan:3},a.createElement("span",null,"No actions. Users will not be notified.")))),i&&i.length>0&&a.createElement(Ca,{path:e.name,actions:i,getRecipients:e.getRecipients,getIntegrations:e.getIntegrations,handleRemove:e.handleRemove,isDisabled:n}),a.createElement("tbody",Object.assign({},re("Notifications/Form/Button",{})),a.createElement("tr",null,a.createElement("td",null,a.createElement(ot.zx,{className:Oa,variant:ot.Wu.link,icon:a.createElement(ca.ZP,null),onClick:o,isDisabled:n},"Add action")))))},ka=e=>{const{values:t,isSubmitting:n}=(0,st.useFormikContext)(),{type:i}=e,o="default"===i||!t.useDefault;return a.createElement("div",Object.assign({},re("Notifications/Form",e)),a.createElement(l.Form,null,a.createElement("table",{className:wa},"notification"===e.type&&a.createElement(a.Fragment,null,a.createElement("thead",null),a.createElement("tbody",Object.assign({},re("Notifications/Form/ApplicationHeader",{})),a.createElement("tr",null,a.createElement("td",null,a.createElement(l.FormText,{ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"event-name"),label:"Event name",name:"eventTypeDisplayName",id:"event"})),a.createElement("td",null,a.createElement(l.FormText,{ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"application"),label:"Application",name:"applicationDisplayName",id:"application"}))),a.createElement("tr",null,a.createElement("td",{colSpan:2},a.createElement(l.Checkbox,{ouiaId:(0,l.ouiaIdConcat)(e.ouiaId,"use-default"),name:"useDefault",id:"useDefault",label:"Use default notification actions",isDisabled:n}))))),"default"===e.type&&a.createElement("tbody",Object.assign({},re("Notifications/Form/DefaultHeader",{})),a.createElement("tr",null,a.createElement("td",{colSpan:3},a.createElement("div",null,"Change the default notification actions for ",a.createElement("b",null,"Red Hat Insights"),"."),a.createElement("div",null,"These actions apply to all events that use the default actions.")))),o&&a.createElement(a.Fragment,null,a.createElement(st.FieldArray,{name:"actions"},(t=>a.createElement(Aa,Object.assign({type:e.type},t,{getRecipients:e.getRecipients,getIntegrations:e.getIntegrations}))))))))};const Ra=e=>{const t=`Edit${"default"===e.type?" default":""} notification actions`,{handleSubmit:n,isValid:i,isSubmitting:o}=(0,st.useFormikContext)(),r=a.useCallback((()=>(n(),!1)),[n]);return a.createElement(l.SaveModal,{content:a.createElement(ka,{type:e.type,getRecipients:e.getRecipients,getIntegrations:e.getIntegrations}),isSaving:o,onSave:r,isOpen:!0,title:t,onClose:e.onClose,variant:oa.v.large,actionButtonDisabled:!i})},Da=e=>{const t=a.useCallback((t=>{return n=void 0,a=void 0,o=function*(){const n=e.onClose;let a=!1;if("notification"===e.type){const n=e.onSave;a=yield n(t)}else if("default"===e.type){const n=e.onSave;a=yield n(t)}a&&n(!0)},new((i=void 0)||(i=Promise))((function(e,t){function l(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(l,r)}s((o=o.apply(n,a||[])).next())}));var n,a,i,o}),[e.onSave,e.onClose,e.type]);return a.createElement(st.Formik,{initialValues:e.data,validationSchema:sa,onSubmit:t,validateOnMount:!0},a.createElement(Ra,{type:e.type,onClose:e.onClose,getRecipients:e.getRecipients,getIntegrations:e.getIntegrations}))},Pa=(0,He.validationResponseTransformer)((e=>"Endpoint"===e.type?(0,He.validatedResponse)("DefaultNotificationId",e.status,e.value.id,e.errors):e)),ja=e=>Lt.NotificationServiceGetLinkedEndpoints.actionCreator({eventTypeId:e}),La=(0,He.validationResponseTransformer)((e=>200===e.status?(0,He.validatedResponse)("defaultNotification",200,-1!==e.value.findIndex((e=>e.type===jt.EndpointType.enum.default)),e.errors):e)),Fa=(0,He.validationResponseTransformer)((e=>200===e.status?(0,He.validatedResponse)("actionsArray",200,Gt(e.value),e.errors):e));var xa=function(e,t,n,a){return new(n||(n=Promise))((function(i,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,r)}s((a=a.apply(e,t||[])).next())}))};const _a=["Admin","Another one","Default user access","Security admin","Stakeholders"],Ba=e=>xa(void 0,void 0,void 0,(function*(){return""!==e?(e=e.toLowerCase(),_a.filter((t=>t.toLowerCase().includes(e)))):_a})),Ma=e=>{const{query:t}=(0,a.useContext)(s.ClientContext),n=a.useCallback(((e,n)=>xa(void 0,void 0,void 0,(function*(){return t(tt(l.Page.of(1,20,(new l.Filter).and("type",l.Operator.EQUAL,e)))).then((e=>{let t=[];const n=e.payload?nt(e.payload):void 0;return"IntegrationPage"===(null==n?void 0:n.type)&&(t=n.value.data),t}))}))),[t]),i=a.useCallback((n=>xa(void 0,void 0,void 0,(function*(){const a=e=>{if(e.type!==Ft.INTEGRATION&&e.type!==Ft.EMAIL_SUBSCRIPTION)throw new Error("Only integrations and EmailSubscription are supported");return e.integrationId},i=e.type;let o,r;if("notification"!==i&&"default"!==i&&(0,ie.ZP)(i),"default"===e.type)o=yield t(na()).then((e=>e.payload?aa(e.payload):e.payload)).then((e=>"DefaultNotificationBehavior"===(null==e?void 0:e.type)?e.value.actions:void 0)),r=!1;else if("notification"===e.type){const n=e.data.id,a=t(ja(n));o=yield a.then((e=>e.payload?Fa(e.payload):e.payload)).then((e=>"actionsArray"===(null==e?void 0:e.type)?e.value:void 0)),r=yield a.then((e=>e.payload?La(e.payload):e.payload)).then((e=>"defaultNotification"===(null==e?void 0:e.type)?e.value:void 0))}const s="notification"===e.type&&n.useDefault;let c;if(c=s!==r?yield t($e.EndpointServiceCreateEndpoint.actionCreator({body:{type:Ze.EndpointType.enum.default,name:"Default endpoint type",description:"",enabled:!0,properties:null}})).then((e=>e.payload?Pa(e.payload):void 0)).then((e=>"DefaultNotificationId"===(null==e?void 0:e.type)?e.value:void 0)):"nothing",!o||void 0===r||void 0===c)return(0,l.addDangerNotification)("Error updating actions","Failed to update actions. Please try again."),!1;const u=an()(5),d=o.map(a),p=n.actions.map(((e,t)=>""===e.integrationId?Object.assign(Object.assign({},e),{integrationId:`new${t}`}):e)).map(a),b=[];if(n.actions.map(((e,n)=>{""===e.integrationId&&e.type===Ft.EMAIL_SUBSCRIPTION&&b.push(u((()=>t(vt({type:v.EMAIL_SUBSCRIPTION,name:"Email subscription",isEnabled:!0})).then((e=>{var t;return"Endpoint"===(null===(t=e.payload)||void 0===t?void 0:t.type)?e.payload.value.id:void 0})).then((e=>{if(e){if(p[n]!==`new${n}`)throw new Error(`Sync error, expected new${n} but found ${p[n]}`);return p[n]=e,!0}return!1})))))})),b.length&&!(yield Promise.all(b.map((e=>e.catch((()=>!1))))).then((e=>e.every((e=>e))))))return(0,l.addDangerNotification)("Actions not added/removed","Some actions were not correctly added or removed. Please try again."),!1;let f,m;if(s?(f=d.reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]),m=r?[]:[c]):(f=d.reduce(((e,t)=>(p.includes(t)||e.includes(t)||e.push(t),e)),[]),r&&f.push(c),m=p.reduce(((e,t)=>(d.includes(t)||e.includes(t)||e.push(t),e)),[])),0===m.length&&0===f.length)return(0,l.addSuccessNotification)("Actions updated","All the actions were updated."),!0;const g=[];if("notification"===e.type){const n=e.data.id;g.push(...f.map((e=>u((()=>t(((e,t)=>Lt.NotificationServiceUnlinkEndpointFromEventType.actionCreator({endpointId:t,eventTypeId:e}))(n,e)).then((e=>!e.error))))))),g.push(...m.map((e=>u((()=>t(((e,t)=>Lt.NotificationServiceLinkEndpointToEventType.actionCreator({endpointId:t,eventTypeId:e}))(n,e)).then((e=>!e.error)))))))}else"default"===e.type&&(g.push(...f.map((e=>u((()=>{return t((n=e,Lt.NotificationServiceDeleteEndpointFromDefaults.actionCreator({endpointId:n}))).then((e=>!e.error));var n}))))),g.push(...m.map((e=>u((()=>{return t((n=e,Lt.NotificationServiceAddEndpointToDefaults.actionCreator({endpointId:n}))).then((e=>!e.error));var n}))))));const E=yield Promise.all(g.map((e=>e.catch((()=>!1))))).then((e=>e.every((e=>e))));return E?(0,l.addSuccessNotification)("Actions updated","All the actions were updated."):(0,l.addDangerNotification)("Actions not added/removed","Some actions were not correctly added or removed. Please try again."),E}))),[e.type,t,e.data]);return a.createElement(Da,Object.assign({onSave:i,isSaving:!1},e,{getRecipients:Ba,getIntegrations:n}))};var Ua;!function(e){e.EDIT_NOTIFICATION="edit-notification",e.EDIT_DEFAULTS="edit-defaults",e.NONE="none"}(Ua||(Ua={}));const Ga={isOpen:!1},Va=(e,t)=>{switch(t.type){case Ua.EDIT_DEFAULTS:return{isOpen:!0,type:"default",data:t.template};case Ua.EDIT_NOTIFICATION:return{isOpen:!0,type:"notification",data:t.template};case Ua.NONE:return Ga;default:(0,ie.vE)(t)}},Wa=e=>Object.assign({loadingActionStatus:"loading"},e),Za=e=>{const t=e.reduce(((e,t)=>(e[t.applicationDisplayName]||(e[t.applicationDisplayName]={applicationDisplayName:t.applicationDisplayName,isOpen:!0,notifications:[]}),e[t.applicationDisplayName].notifications.push(Wa(t)),e)),{});return Object.values(t)},$a=(0,le.style)({display:"inline"}),Ha=(0,le.style)({fontWeight:600,paddingTop:X.ZP.var,paddingBottom:X.ZP.var,fontSize:"17px"}),qa=(0,le.style)({paddingTop:0}),za=[];const Ka=[{path:"/integrations",component:()=>{const{rbac:{canWriteIntegrationsEndpoints:e}}=(0,a.useContext)(x),t=((e=250)=>(0,l.useFilters)(Ue,e,tn))(),n=((e,t,n,i)=>{const[o,r]=(0,a.useState)(1),[s,c]=(0,a.useState)(10);return(0,a.useEffect)((()=>{r(1)}),[n,r,s]),{page:(0,a.useMemo)((()=>{const e=t?t(n):void 0;return l.Page.of(o,s,e,i)}),[o,s,n,i,t]),changePage:(0,a.useCallback)((e=>{r(e)}),[r]),changeItemsPerPage:(0,a.useCallback)((e=>{c(e)}),[c])}})(0,cn,t.filters),i=(o=n.page,(0,l.useTransformQueryResponse)((0,s.useQuery)(tt(o),undefined),nt));var o;const r=(0,l.useTransformQueryResponse)((0,s.useParameterizedQuery)(tt),nt),u=a.useMemo((()=>{const e=i.payload;return"IntegrationPage"===(null==e?void 0:e.type)?e.value:{data:[],count:0}}),[i.payload]),d=(e=>{const[t,n]=(0,a.useState)([]),i=(0,ln.Z)(e),o=(0,c.useDispatch)(),r=(0,c.useSelector)(rn,sn),u=Nt(),{query:d}=(0,a.useContext)(s.ClientContext),[p]=(0,a.useState)((()=>an()(5))),b=(0,a.useCallback)(((e,t)=>{n((n=>{const a=[...n];return a[e]=Object.assign(Object.assign({},a[e]),t),a}))}),[n]),f=(0,a.useCallback)(((e,t)=>{n((n=>{const a=n.findIndex((t=>t.id===e));if(-1===a)return n;const i=[...n];return i[a]=Object.assign(Object.assign({},i[a]),t),i}))}),[n]);(0,a.useEffect)((()=>{e!==i&&(n((t=>e.map((e=>Object.assign(Object.assign({isOpen:!1,isSelected:!1,isEnabledLoading:!1,lastConnectionAttempts:[],isConnectionAttemptLoading:!0},t.find((t=>t.id===e.id))),e))))),e&&(p.clearQueue(),e.map((e=>e.id)).forEach((e=>{p((()=>d((e=>$e.EndpointServiceGetEndpointHistory.actionCreator({id:e}))(e)))).then((t=>{if(t.payload&&200===t.payload.status){const n=t.payload.value.reverse().slice(0,5).map((e=>({isSuccess:!!e.invocationResult,date:new Date(e.created)})));f(e,{isConnectionAttemptLoading:!1,lastConnectionAttempts:n})}else f(e,{isConnectionAttemptLoading:!1,lastConnectionAttempts:void 0})}))}))))}),[i,e,f,p,d]);const m=(0,a.useCallback)(((e,t,n)=>{b(t,{isOpen:n})}),[b]),g=(0,a.useCallback)(((e,t,n)=>{b(t,{isEnabledLoading:!0}),r&&e.id===r.integration.id&&o(Ot.start()),u.mutate(e).then((a=>{if(a.error){const a=n?w.components.integrations.enableError:w.components.integrations.disableError;r&&e.id===r.integration.id&&o(Ot.finish(e.isEnabled)),(0,l.addDangerNotification)(a.title,(0,on.WU)(a.description,e.name),!0),b(t,{isEnabled:e.isEnabled,isEnabledLoading:!1})}else b(t,{isEnabled:n,isEnabledLoading:!1}),r&&e.id===r.integration.id&&o(Ot.finish(n))}))}),[b,u,o,r]);return(0,a.useEffect)((()=>{r&&(r.status===kt.LOADING?f(r.integration.id,{isEnabledLoading:!0}):f(r.integration.id,{isEnabledLoading:!1,isEnabled:r.integration.isEnabled}))}),[r,f]),{rows:t,onCollapse:m,onEnable:g}})(u.data),[p,b]=(0,a.useReducer)(Yt,Jt),[f,m]=Kt(),g=a.useCallback((()=>{b({type:Qt.CREATE,template:undefined})}),[b]),E=a.useCallback((e=>{var t;b((t=e,{type:Qt.EDIT,template:t}))}),[b]),y=a.useCallback((e=>{m(Kt.makeDeleteAction(e))}),[m]),v=a.useCallback((e=>{return t=void 0,n=void 0,i=function*(){var t;const n=r.query,a=(e=>{switch(e){case l.ExporterType.CSV:return new at;case l.ExporterType.JSON:return new it}(0,ie.vE)(e)})(e),i=[];let o=l.Page.of(1,100,(new l.Filter).and("type",l.Operator.EQUAL,"webhook"));for(;;){const e=yield n(o);if(200!==(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.status)){if(0===i.length)return void(0,l.addDangerNotification)("Unable to download integrations","We were unable to download the integrations for exporting. Please try again.");(0,l.addDangerNotification)("Unable to download all integrations",`We were unable to download all the integrations for exporting. Downloading: ${i.length}.`);break}if(0===e.payload.value.data.length)break;o=o.nextPage(),i.push(...e.payload.value.data)}i&&F()(a.export(i),`integrations-${(0,j.Z)(new Date(Date.now()),"y-dd-MM")}.${a.type}`)},new((a=void 0)||(a=Promise))((function(e,o){function l(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(l,r)}s((i=i.apply(t,n||[])).next())}));var t,n,a,i}),[r]),h=(S={canWrite:e,onEdit:E,onDelete:y,onEnable:d.onEnable},(0,a.useCallback)(((e,t)=>{const n=S.onEdit,a=S.onDelete,i=S.onEnable,o=!S.canWrite;return[{title:"Edit",isDisabled:o,onClick:()=>n(e)},{title:"Remove",isDisabled:o,onClick:()=>a(e)},{title:e.isEnabled?"Disable":"Enable",isDisabled:o,onClick:()=>i(e,t,!e.isEnabled)}]}),[S.onEdit,S.onDelete,S.canWrite,S.onEnable]));var S;const I=a.useCallback((e=>{const t=i.query;b({type:Qt.NONE}),e&&t()}),[b,i.query]),N=a.useCallback((e=>{const t=i.query;e&&t(),m(Kt.makeNoneAction())}),[m,i.query]),T=Math.min(n.page.size,u.count-(n.page.index-1)*n.page.size)||10;return a.createElement(a.Fragment,null,a.createElement(k.Z,null,a.createElement(R.Z,{title:w.pages.integrations.list.title})),a.createElement(D.Z,null,a.createElement(P.Z,{className:"pf-c-page__main-section pf-m-light"},a.createElement(We,{onAddIntegration:e?g:void 0,onExport:v,filters:t.filters,setFilters:t.setFilters,clearFilters:t.clearFilter,count:u.count||0,pageCount:u.data.length,page:n.page.index,perPage:n.page.size,pageChanged:n.changePage,perPageChanged:n.changeItemsPerPage},a.createElement(Fe,{isLoading:i.loading,loadingCount:T,integrations:d.rows,onCollapse:d.onCollapse,onEnable:e?d.onEnable:void 0,actionResolver:h})),p.isOpen&&a.createElement(Dt,{isEdit:p.isEdit,initialIntegration:p.template||{},onClose:I}),f.integration&&a.createElement($t,{onClose:N,integration:f.integration}))))},rootClass:"integrations"},{path:"/notifications",component:()=>{var e,t;const{rbac:{canWriteNotifications:n}}=(0,a.useContext)(x),i=(0,l.useTransformQueryResponse)((0,s.useQuery)(na()),aa),{applications:o}=(0,a.useContext)(x),r=((e,t=250)=>{const n=(0,a.useMemo)((()=>{const t=e=>(0,l.useUrlStateString)("name",e),n=t=>(0,l.useUrlStateMultipleOptions)("app",e,t),a=e=>(0,l.useUrlStateString)("action",e);return e=>{switch(e){case qn.NAME:return t;case qn.ACTION:return a;case qn.APPLICATION:return n;default:(0,ie.vE)(e)}}}),[]);return(0,l.useFilters)(qn,t,n)})(o.map((e=>e.label.toString()))),[c,u]=a.useState(Dn.Application),d=a.useCallback((e=>{u(e)}),[u]),p=((e,t,n,i)=>{const[o,r]=(0,a.useState)(1),[s,c]=(0,a.useState)(10);return(0,a.useEffect)((()=>r(1)),[r,e]),{page:(0,a.useMemo)((()=>{const n=new l.Filter,a=e[qn.APPLICATION];if(a){const e=[];for(const n of(0,l.arrayValue)(a)){const a=t.find((e=>e.label===n));a&&e.push(a.value)}n.and("applicationId",l.Operator.EQUAL,e)}return l.Page.of(o,s,n,i)}),[o,s,i,e,t]),changePage:(0,a.useCallback)((e=>r(e)),[r]),changeItemsPerPage:(0,a.useCallback)((e=>{r(1),c(e)}),[r])}})(r.debouncedFilters,o),b=(N=p.page,(0,l.useTransformQueryResponse)((0,s.useQuery)((e=>{const t=(null!=e?e:l.Page.defaultPage()).toQuery();return Lt.NotificationServiceGetEventTypes.actionCreator({limit:+t.limit,offset:+t.offset,applicationIds:t.filterApplicationId})})(N)),ia)),{rows:f,onCollapse:m}=((e,t)=>{const[n,i]=(0,a.useState)({data:[],grouped:Dn.Application}),o=(0,ln.Z)(e),l=(0,ln.Z)(t),{query:r}=(0,a.useContext)(s.ClientContext),[c]=(0,a.useState)((()=>an()(5))),u=(0,a.useCallback)(((e,t)=>{i((n=>{if(n.grouped===Dn.Application){const[a,i]=((e,t)=>{for(let n=0;n<e.length;++n)for(let a=0;a<e[n].notifications.length;++a)if(e[n].notifications[a].id===t)return[n,a];return[-1,-1]})(n.data,e);if(-1===a)return n;const o=[...n.data];return o[a]=Object.assign(Object.assign({},o[a]),{notifications:[...o[a].notifications]}),o[a].notifications[i]=Object.assign(Object.assign({},o[a].notifications[i]),t),Object.assign(Object.assign({},n),{data:o})}if(n.grouped===Dn.None){const a=n.data.findIndex((t=>t.id===e));if(-1===a)return n;const i=[...n.data];return i[a]=Object.assign(Object.assign({},i[a]),t),Object.assign(Object.assign({},n),{data:i})}(0,ie.vE)(n)}))}),[i]);return(0,a.useEffect)((()=>{e===o&&t===l||(i((n=>{switch(t){case Dn.None:return{grouped:Dn.None,data:e.map(Wa)};case Dn.Application:return{grouped:Dn.Application,data:Za(e)};default:(0,ie.vE)(t)}})),e&&(c.clearQueue(),e.map((e=>e.id)).forEach((e=>{c((()=>r(ja(e)))).then((t=>{t.payload&&200===t.payload.status?u(e,{loadingActionStatus:"done",actions:Gt(t.payload.value),useDefault:_t(t.payload.value)}):u(e,{loadingActionStatus:"error",actions:[]})}))}))))}),[t,l,e,o,c,r,u]),{rows:n,onCollapse:a.useCallback(((e,t)=>{i((n=>{switch(n.grouped){case Dn.None:throw new Error("On collapse is not valid for group: None");case Dn.Application:const a=[...n.data];return a[e]=Object.assign(Object.assign({},a[e]),{isOpen:t}),Object.assign(Object.assign({},n),{data:a});default:(0,ie.vE)(n)}}))}),[i])}})("eventTypesArray"===(null===(e=b.payload)||void 0===e?void 0:e.type)?b.payload.value:za,c),[g,E]=(0,a.useReducer)(Va,Ga),y=a.useCallback((e=>{const t=i.query,n=b.query;e&&g.isOpen&&("default"===g.type?t():"notification"===g.type&&n()),E({type:Ua.NONE})}),[E,i.query,g,b.query]),v={className:$a,title:w.pages.notifications.list.title},h=a.useCallback((e=>{console.log("Export to",e)}),[]),S=a.useCallback((()=>{const e=i.payload;var t;"DefaultNotificationBehavior"===(null==e?void 0:e.type)&&E((t=e.value,{type:Ua.EDIT_DEFAULTS,template:t}))}),[E,i.payload]),I=a.useCallback((e=>{var t;E((t=e,{type:Ua.EDIT_NOTIFICATION,template:t}))}),[E]);var N;return a.createElement(a.Fragment,null,a.createElement(k.Z,null,a.createElement(R.Z,Object.assign({},v)),a.createElement(l.InsightsEnvDetector,{insights:(0,l.getInsights)(),onEnvironment:Me},a.createElement(l.RenderIfFalse,null,a.createElement(ot.zx,{variant:ot.Wu.link},w.pages.notifications.list.viewHistory)))),a.createElement(D.Z,{className:qa},a.createElement(P.Z,null,a.createElement(Rn,{loading:i.loading,defaultBehavior:"DefaultNotificationBehavior"===(null===(t=i.payload)||void 0===t?void 0:t.type)?i.payload.value:void 0,onEdit:n?S:void 0}),a.createElement("div",{className:Ha},"Insights notifications event types and behavior"),a.createElement(ta,{filters:r.filters,setFilters:r.setFilters,clearFilter:r.clearFilter,appFilterOptions:o,groupBy:c,onGroupBySelected:d,onExport:h},a.createElement(Hn,{notifications:f,onCollapse:m,onEdit:n?I:void 0})),g.isOpen&&a.createElement(Ma,Object.assign({onClose:y},g)))))},rootClass:"notifications"}],Qa=e=>{const{rootClass:t}=e,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["rootClass"]),i=document.getElementById("root");if(!i)throw new Error("Root element not found");return i.removeAttribute("class"),i.classList.add(`page__${t}`,"pf-c-page__main"),i.setAttribute("role","main"),a.createElement(A,null,a.createElement(m.AW,Object.assign({},n)))},Ja=()=>a.createElement(m.rs,null,Ka.map((e=>a.createElement(Qa,{key:e.path,rootClass:e.rootClass,component:e.component,path:e.path,exact:!0})))),Ya=e=>{let t="/";const n=e.split("/");return n.shift(),"beta"===n[0]&&(n.shift(),t="/beta/"),`${t}${n[0]}`},Xa=e=>{const t=e.split("/");return t.shift(),"beta"===t[0]?t[1]:t[0]},ei=(0,m.EN)((()=>{const e=(0,f.Z)(),{rbac:t,applications:n}=(()=>{const e=(0,m.k6)(),[t,n]=(0,a.useState)(void 0),i=(r="insights",(0,s.useQuery)((e=>Lt.NotificationServiceGetApplicationsFacets.actionCreator({bundleName:e}))(r))),o=(0,a.useMemo)((()=>{var e;return 200===(null===(e=i.payload)||void 0===e?void 0:e.status)?i.payload.value:void 0}),[i.payload]);var r;return(0,a.useEffect)((()=>{(0,l.waitForInsights)().then((e=>{e.chrome.init();const t=e.chrome.getApp();switch(t){case E.subAppId:document.title=E.title;break;case g.subAppId:document.title=g.title}e.chrome.identifyApp(t)}))}),[e]),(0,a.useEffect)((()=>{(0,l.waitForInsights)().then((e=>{e.chrome.auth.getUser().then((()=>{(0,l.fetchRBAC)(`${E.subAppId},${g.subAppId}`).then(n)}))}))}),[]),{rbac:t?{canWriteNotifications:t.hasPermission("notifications","notifications","write"),canReadNotifications:t.hasPermission("notifications","notifications","read"),canWriteIntegrationsEndpoints:t.hasPermission("integrations","endpoints","write"),canReadIntegrationsEndpoints:t.hasPermission("integrations","endpoints","read")}:void 0,applications:o}})(),i=(0,m.TH)(),o=a.useMemo((()=>{switch(Xa(i.pathname)){case g.subAppId:return e.formatMessage(y.integrations);case E.subAppId:return e.formatMessage(y.notifications);default:return""}}),[e,i.pathname]),r=a.useMemo((()=>{switch(Xa(i.pathname)){case g.subAppId:return null==t?void 0:t.canReadIntegrationsEndpoints;case E.subAppId:return null==t?void 0:t.canReadNotifications}return!1}),[t,i.pathname]);return t&&n?a.createElement(x.Provider,{value:{rbac:t,applications:n}},r?a.createElement(a.Fragment,null,a.createElement(b.NotificationsPortal,null),a.createElement(Ja,null)):a.createElement(p.Z,{serviceName:o})):a.createElement(l.AppSkeleton,null)})),ti=(e=null,t)=>{switch(t.type){case(0,Ct.getType)(Ot.setIntegration):return{integration:t.payload,status:kt.DONE};case(0,Ct.getType)(Ot.start):return e?Object.assign(Object.assign({},e),{status:kt.LOADING}):e;case(0,Ct.getType)(Ot.finish):return e?{integration:Object.assign(Object.assign({},e.integration),{isEnabled:t.payload}),status:kt.DONE}:e;case(0,Ct.getType)(Ot.unset):return null;default:return e}},ni=(...e)=>(0,l.initStore)({savedNotificationScope:null},{savedNotificationScope:ti},...e);i.render(a.createElement((e=>{const t=a.useMemo((()=>(0,l.createFetchingClient)(l.getInsights,{responseInterceptors:[r.validateSchemaResponseInterceptor]})),[]),n=a.useMemo((()=>((0,l.restoreStore)(),e.logger?ni(e.logger).store:ni().store)),[e.logger]);return a.createElement(o.Pj,{locale:navigator.language.slice(0,2),messages:d,onError:console.log},a.createElement(c.Provider,{store:n},a.createElement(u.BrowserRouter,{basename:Ya(window.location.pathname)},a.createElement(s.ClientContextProvider,{client:t},a.createElement(ei,null)))))}),null),document.getElementById("root"))}},u={};function d(e){if(u[e])return u[e].exports;var t=u[e]={id:e,loaded:!1,exports:{}},n={id:e,module:t,factory:c[e],require:d};return d.i.forEach((function(e){e(n)})),t=n.module,n.factory.call(t.exports,t,t.exports,n.require),t.loaded=!0,t.exports}d.m=c,d.c=u,d.i=[],d.x=e=>{},d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,d.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"==typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"==typeof n.then)return n}var i=Object.create(null);d.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var l=2&a&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,d.d(i,o),i},d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.hu=e=>e+"."+d.h()+".hot-update.js",d.miniCssF=e=>{},d.hmrF=()=>"App."+d.h()+".hot-update.json",d.h=()=>"cae230494ba24bfc3d24",d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},a="notifications-frontend:",d.l=(e,t,i,o)=>{if(n[e])n[e].push(t);else{var l,r;if(void 0!==i)for(var s=document.getElementsByTagName("script"),c=0;c<s.length;c++){var u=s[c];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==a+i){l=u;break}}l||(r=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,d.nc&&l.setAttribute("nonce",d.nc),l.setAttribute("data-webpack",a+i),l.src=e),n[e]=[t];var p=(t,a)=>{l.onerror=l.onload=null,clearTimeout(b);var i=n[e];if(delete n[e],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((e=>e(a))),t)return t(a)},b=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),r&&document.head.appendChild(l)}},d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e,t,n,a,i={},o=d.c,l=[],r=[],s="idle";function c(e){s=e;for(var t=0;t<r.length;t++)r[t].call(null,e)}function u(e){if(0===t.length)return e();var n=t;return t=[],Promise.all(n).then((function(){return u(e)}))}function p(e){if("idle"!==s)throw new Error("check() is only allowed in idle status");return c("check"),d.hmrM().then((function(a){if(!a)return c(m()?"ready":"idle"),null;c("prepare");var i=[];return t=[],n=[],Promise.all(Object.keys(d.hmrC).reduce((function(e,t){return d.hmrC[t](a.c,a.r,a.m,e,n,i),e}),[])).then((function(){return u((function(){return e?f(e):(c("ready"),i)}))}))}))}function b(e){return"ready"!==s?Promise.resolve().then((function(){throw new Error("apply() is only allowed in ready status")})):f(e)}function f(e){e=e||{},m();var t=n.map((function(t){return t(e)}));n=void 0;var i,o=t.map((function(e){return e.error})).filter(Boolean);if(o.length>0)return c("abort"),Promise.resolve().then((function(){throw o[0]}));c("dispose"),t.forEach((function(e){e.dispose&&e.dispose()})),c("apply");var l=function(e){i||(i=e)},r=[];return t.forEach((function(e){if(e.apply){var t=e.apply(l);if(t)for(var n=0;n<t.length;n++)r.push(t[n])}})),i?(c("fail"),Promise.resolve().then((function(){throw i}))):a?f(e).then((function(e){return r.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e})):(c("idle"),Promise.resolve(r))}function m(){if(a)return n||(n=[]),Object.keys(d.hmrI).forEach((function(e){a.forEach((function(t){d.hmrI[e](t,n)}))})),a=void 0,!0}d.hmrD=i,d.i.push((function(f){var m,g,E,y=f.module,v=function(n,a){var i=o[a];if(!i)return n;var r=function(t){if(i.hot.active){if(o[t]){var r=o[t].parents;-1===r.indexOf(a)&&r.push(a)}else l=[a],e=t;-1===i.children.indexOf(t)&&i.children.push(t)}else console.warn("[HMR] unexpected require("+t+") from disposed module "+a),l=[];return n(t)},d=function(e){return{configurable:!0,enumerable:!0,get:function(){return n[e]},set:function(t){n[e]=t}}};for(var p in n)Object.prototype.hasOwnProperty.call(n,p)&&"e"!==p&&Object.defineProperty(r,p,d(p));return r.e=function(e){return function(e){switch(s){case"ready":return c("prepare"),t.push(e),u((function(){c("ready")})),e;case"prepare":return t.push(e),e;default:return e}}(n.e(e))},r}(f.require,f.id);y.hot=(m=f.id,g=y,E={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:e!==m,_requireSelf:function(){l=g.parents.slice(),e=m,d(m)},active:!0,accept:function(e,t){if(void 0===e)E._selfAccepted=!0;else if("function"==typeof e)E._selfAccepted=e;else if("object"==typeof e&&null!==e)for(var n=0;n<e.length;n++)E._acceptedDependencies[e[n]]=t||function(){};else E._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)E._selfDeclined=!0;else if("object"==typeof e&&null!==e)for(var t=0;t<e.length;t++)E._declinedDependencies[e[t]]=!0;else E._declinedDependencies[e]=!0},dispose:function(e){E._disposeHandlers.push(e)},addDisposeHandler:function(e){E._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=E._disposeHandlers.indexOf(e);t>=0&&E._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,s){case"idle":n=[],Object.keys(d.hmrI).forEach((function(e){d.hmrI[e](m,n)})),c("ready");break;case"ready":Object.keys(d.hmrI).forEach((function(e){d.hmrI[e](m,n)}));break;case"prepare":case"check":case"dispose":case"apply":(a=a||[]).push(m)}},check:p,apply:b,status:function(e){if(!e)return s;r.push(e)},addStatusHandler:function(e){r.push(e)},removeStatusHandler:function(e){var t=r.indexOf(e);t>=0&&r.splice(t,1)},data:i[m]},e=void 0,E),y.parents=l,y.children=[],l=[],f.require=v})),d.hmrC={},d.hmrI={}})(),d.p="/beta/apps/notifications/",i=(e,t,n,a)=>{var i=document.createElement("link");return i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=o=>{if(i.onerror=i.onload=null,"load"===o.type)n();else{var l=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.type=l,s.request=r,i.parentNode.removeChild(i),a(s)}},i.href=t,document.head.appendChild(i),i},o=(e,t)=>{for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var i=(l=n[a]).getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(i===e||i===t))return l}var o=document.getElementsByTagName("style");for(a=0;a<o.length;a++){var l;if((i=(l=o[a]).getAttribute("data-href"))===e||i===t)return l}},l=[],r=[],s=e=>({dispose:()=>{for(var e=0;e<l.length;e++){var t=l[e];t.parentNode&&t.parentNode.removeChild(t)}l.length=0},apply:()=>{for(var e=0;e<r.length;e++)r[e].rel="stylesheet";r.length=0}}),d.hmrC.miniCss=(e,t,n,a,c,u)=>{c.push(s),e.forEach((e=>{var t=d.miniCssF(e),n=d.p+t;const s=o(t,n);s&&a.push(new Promise(((t,a)=>{var o=i(e,n,(()=>{o.as="style",o.rel="preload",t()}),a);l.push(s),r.push(o)})))}))},(()=>{var e,t,n,a,i={768:0},o=[[50374,410,252,880,127]],l={};function r(e){return new Promise(((t,n)=>{l[e]=t;var a=d.p+d.hu(e),i=new Error;d.l(a,(t=>{if(l[e]){l[e]=void 0;var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;i.message="Loading hot update chunk "+e+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,n(i)}}))}))}function s(o){function l(e){for(var t=[e],n={},a=t.map((function(e){return{chain:[e],id:e}}));a.length>0;){var i=a.pop(),o=i.id,l=i.chain,s=d.c[o];if(s&&(!s.hot._selfAccepted||s.hot._selfInvalidated)){if(s.hot._selfDeclined)return{type:"self-declined",chain:l,moduleId:o};if(s.hot._main)return{type:"unaccepted",chain:l,moduleId:o};for(var c=0;c<s.parents.length;c++){var u=s.parents[c],p=d.c[u];if(p){if(p.hot._declinedDependencies[o])return{type:"declined",chain:l.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(p.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),r(n[u],[o])):(delete n[u],t.push(u),a.push({chain:l.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}d.f&&delete d.f.jsonpHmr,e=void 0;var s={},c=[],u={},p=function(e){console.warn("[HMR] unexpected require("+e.id+") to disposed module")};for(var b in t)if(d.o(t,b)){var f,m=t[b],g=!1,E=!1,y=!1,v="";switch((f=m?l(b):{type:"disposed",moduleId:b}).chain&&(v="\nUpdate propagation: "+f.chain.join(" -> ")),f.type){case"self-declined":o.onDeclined&&o.onDeclined(f),o.ignoreDeclined||(g=new Error("Aborted because of self decline: "+f.moduleId+v));break;case"declined":o.onDeclined&&o.onDeclined(f),o.ignoreDeclined||(g=new Error("Aborted because of declined dependency: "+f.moduleId+" in "+f.parentId+v));break;case"unaccepted":o.onUnaccepted&&o.onUnaccepted(f),o.ignoreUnaccepted||(g=new Error("Aborted because "+b+" is not accepted"+v));break;case"accepted":o.onAccepted&&o.onAccepted(f),E=!0;break;case"disposed":o.onDisposed&&o.onDisposed(f),y=!0;break;default:throw new Error("Unexception type "+f.type)}if(g)return{error:g};if(E)for(b in u[b]=m,r(c,f.outdatedModules),f.outdatedDependencies)d.o(f.outdatedDependencies,b)&&(s[b]||(s[b]=[]),r(s[b],f.outdatedDependencies[b]));y&&(r(c,[f.moduleId]),u[b]=p)}t=void 0;for(var h,S=[],I=0;I<c.length;I++){var N=c[I];d.c[N]&&d.c[N].hot._selfAccepted&&u[N]!==p&&!d.c[N].hot._selfInvalidated&&S.push({module:N,require:d.c[N].hot._requireSelf,errorHandler:d.c[N].hot._selfAccepted})}return{dispose:function(){var e;n.forEach((function(e){delete i[e]})),n=void 0;for(var t,a=c.slice();a.length>0;){var o=a.pop(),l=d.c[o];if(l){var r={},u=l.hot._disposeHandlers;for(I=0;I<u.length;I++)u[I].call(null,r);for(d.hmrD[o]=r,l.hot.active=!1,delete d.c[o],delete s[o],I=0;I<l.children.length;I++){var p=d.c[l.children[I]];p&&(e=p.parents.indexOf(o))>=0&&p.parents.splice(e,1)}}}for(var b in s)if(d.o(s,b)&&(l=d.c[b]))for(h=s[b],I=0;I<h.length;I++)t=h[I],(e=l.children.indexOf(t))>=0&&l.children.splice(e,1)},apply:function(e){for(var t in u)d.o(u,t)&&(d.m[t]=u[t]);for(var n=0;n<a.length;n++)a[n](d);for(var i in s)if(d.o(s,i)){var l=d.c[i];if(l){h=s[i];for(var r=[],p=[],b=0;b<h.length;b++){var f=h[b],m=l.hot._acceptedDependencies[f];if(m){if(-1!==r.indexOf(m))continue;r.push(m),p.push(f)}}for(var g=0;g<r.length;g++)try{r[g].call(null,h)}catch(t){o.onErrored&&o.onErrored({type:"accept-errored",moduleId:i,dependencyId:p[g],error:t}),o.ignoreErrored||e(t)}}}for(var E=0;E<S.length;E++){var y=S[E],v=y.module;try{y.require(v)}catch(t){if("function"==typeof y.errorHandler)try{y.errorHandler(t)}catch(n){o.onErrored&&o.onErrored({type:"self-accept-error-handler-errored",moduleId:v,error:n,originalError:t}),o.ignoreErrored||e(n),e(t)}else o.onErrored&&o.onErrored({type:"self-accept-errored",moduleId:v,error:t}),o.ignoreErrored||e(t)}}return c}}}self.webpackHotUpdatenotifications_frontend=(e,n,i)=>{for(var o in n)d.o(n,o)&&(t[o]=n[o]);i&&a.push(i),l[e]&&(l[e](),l[e]=void 0)},d.hmrI.jsonp=function(e,i){t||(t={},a=[],n=[],i.push(s)),d.o(t,e)||(t[e]=d.m[e])},d.hmrC.jsonp=function(o,l,c,u,p,b){p.push(s),e={},n=l,t=c.reduce((function(e,t){return e[t]=!1,e}),{}),a=[],o.forEach((function(t){d.o(i,t)&&void 0!==i[t]&&(u.push(r(t)),e[t]=!0)})),d.f&&(d.f.jsonpHmr=function(t,n){e&&!d.o(e,t)&&d.o(i,t)&&void 0!==i[t]&&(n.push(r(t)),e[t]=!0)})},d.hmrM=()=>{if("undefined"==typeof fetch)throw new Error("No browser support: need fetch API");return fetch(d.p+d.hmrF()).then((e=>{if(404!==e.status){if(!e.ok)throw new Error("Failed to fetch update manifest "+e.statusText);return e.json()}}))};var c=e=>{},u=(e,t)=>{for(var n,a,[l,r,s,u]=t,p=0,b=[];p<l.length;p++)a=l[p],d.o(i,a)&&i[a]&&b.push(i[a][0]),i[a]=0;for(n in r)d.o(r,n)&&(d.m[n]=r[n]);for(s&&s(d),e&&e(t);b.length;)b.shift()();return u&&o.push.apply(o,u),c()},p=self.webpackChunknotifications_frontend=self.webpackChunknotifications_frontend||[];function b(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,l=1;l<n.length;l++){var r=n[l];0!==i[r]&&(a=!1)}a&&(o.splice(t--,1),e=d(d.s=n[0]))}return 0===o.length&&(d.x(),d.x=e=>{}),e}p.forEach(u.bind(null,0)),p.push=u.bind(null,p.push.bind(p));var f=d.x;d.x=()=>(d.x=f||(e=>{}),(c=b)())})(),d.x()})();
//# sourceMappingURL=App.dfb987f237cc27ec01d8.js.map