"use strict";(self.webpackChunknotifications_frontend=self.webpackChunknotifications_frontend||[]).push([[2970],{45362:(e,t,n)=>{n.d(t,{Z:()=>$l});var a=n(21242),l=n(20687),o=n(55140),i=n(55128),r=n(21472),s=n(93264),c=n.n(s),u=n(8813),d=n(42150),m=n(89063),p=n(62012),E=n(84456),g=n(79153),v=n(80123),h=n(69622),f=n.n(h),y=n(85333),b=n(86896),C=n(77365),T=n(94782),S=n(16721);const k=(e,t=!0)=>(0,T.useQuery)((e=>S.B.NotificationResourceGetBundleFacets.actionCreator({includeApplications:e}))(!!e),t);var I=n(14748),N=n(28216);const w=I.ZP,A=e=>{const t=(0,N.useStore)();return s.createElement(w,{store:t,...e})},D=()=>{var e,t;const n=(0,o.Z)(),{bundleName:l}=(0,p.useParams)(),r=k(),u=(0,s.useMemo)((()=>{var e;if(200===(null===(e=r.payload)||void 0===e?void 0:e.status))return r.payload.value.find((e=>e.name===l))}),[l,null===(e=r.payload)||void 0===e?void 0:e.status,null===(t=r.payload)||void 0===t?void 0:t.value]),d=(0,p.useLocation)(),m=(0,b.Z)(),E=c().createElement("a",{href:(0,i.localUrl)("/user-preferences/notifications/",n.isBeta())}," ","User Preferences"),h=c().createElement("a",{href:(0,i.localUrl)("/settings/my-user-access?bundle=rhel }",n.isBeta())}," ","My User Access"," "),T=c().useMemo((()=>{switch(n.getApp()){case g.ZP.integrations.subAppId:return m.formatMessage(C.Z.integrations);case g.ZP.notifications.subAppId:return d.pathname===Fl.eventLog()?"Event Log":m.formatMessage(C.Z.notifications);default:return""}}),[m,d.pathname,n]),S=c().useMemo((()=>"Notifications"===T&&u?`${T} | ${null==u?void 0:u.displayName}`:`${T}`),[u,T]),I=c().useMemo((()=>"Notifications"===T?c().createElement("span",null,"This service allows you to configure which notifications different users within your organization will be entitled to receiving. To do this, create behavior groups and apply them to different events. Users will be able to opt-in or out of receiving authorized event notifications in their",c().createElement("a",{href:(0,i.localUrl)("/user-preferences/notifications/",n.isBeta())}," ","User Preferences"),"."):c().createElement("span",null)),[T,n]);return c().createElement(c().Fragment,null,c().createElement(v.Z,null,c().createElement(a.Split,null,c().createElement(a.SplitItem,{isFilled:!0},c().createElement(f(),{title:S,paddingBottom:"8px"}," "),c().createElement(a.StackItem,null,I)))),c().createElement(A,null,c().createElement(y.Z,{description:c().createElement(c().Fragment,null," ","Contact your organization administrator for more information or visit",h," to learn more about your permissions. To manage your notifications, go to your ",E,"."),serviceName:T})))},L=e=>{const t=(0,o.Z)(),{rbac:n}=(0,E.b)(),a=(0,p.useLocation)(),l=c().useMemo((()=>{switch(t.getApp()){case g.ZP.integrations.subAppId:return null==n?void 0:n.canReadIntegrationsEndpoints;case g.ZP.notifications.subAppId:return a.pathname===Fl.eventLog()?null==n?void 0:n.canReadEvents:null==n?void 0:n.canReadNotifications}return!1}),[n,a,t]);return c().createElement(c().Fragment,null,l?e.children:c().createElement(D,null))};var P=n(44873),O=n(18115),F=n(78371);const R=()=>{const{updateDocumentTitle:e,getBundle:t}=(0,o.Z)();null==e||e("Integrations");const n=(0,m.useFlag)("platform.notifications.overhaul");return s.createElement(P.Z,{className:"pf-c-page__main-section pf-m-light"},s.createElement(v.Z,null,s.createElement(a.Split,null,s.createElement(a.SplitItem,{isFilled:!0},s.createElement(f(),{title:O.V.pages.integrations.list.title})),!n&&s.createElement(a.SplitItem,null,s.createElement(a.Button,{variant:"secondary",component:()=>s.createElement(p.Link,{to:`/${t()}/notifications${Fl.eventLog()}`})}," ","View event log"," ")))),s.createElement(A,null,s.createElement(F.Z,null)))};var x=n(43551);const G=O.V.pages.splunk.page.helpUrl,B="https://access.redhat.com/support/cases/#/case/new/open-case/describe-issue?intcmp=hp|a|a3|case&caseCreate=true&product=Red%20Hat%20Insights&version=Red%20Hat%20Insights",M=({isSuccess:e,error:t})=>e?c().createElement(_,null):c().createElement(U,{error:t}),_=()=>c().createElement(a.EmptyState,null,c().createElement(a.EmptyStateIcon,{icon:x.CheckCircleIcon,color:"var(--pf-global--success-color--100)"}),c().createElement(a.Title,{headingLevel:"h4",size:"lg"},"Splunk integration in Insights completed"),c().createElement(a.EmptyStateBody,null,"Splunk integration in Insights was completed. To confirm these changes,"," ",c().createElement("strong",null,"go back to Splunk application"),".")),U=({error:e})=>c().createElement(a.EmptyState,null,c().createElement(a.EmptyStateIcon,{icon:x.ExclamationCircleIcon,color:"var(--pf-global--danger-color--100)"}),c().createElement(a.Title,{headingLevel:"h4",size:"lg"},"Configuration failed"),c().createElement(a.EmptyStateBody,null,c().createElement("p",{className:"pf-u-mb-md"},"There was a problem processing the request. Please try again. If the problem persists, contact Red Hat support by opening the ticket."),e&&c().createElement("p",null,`${e}`)),c().createElement(a.Button,{variant:"primary",component:"a",href:B,target:"_blank",rel:"noopener noreferrer"},"Open a Red Hat Support ticket"),c().createElement(a.EmptyStateSecondaryActions,null,c().createElement(a.Button,{variant:"link",component:"a",href:G,target:"_blank",rel:"noopener noreferrer"},"Go to documentation")));var Z=n(63055),V=n(70070),$=n(10406);const H=e=>{const t=(null!=e?e:i.Page.defaultPage()).toQuery();return S.B.NotificationResourceGetEventTypes.actionCreator({limit:+t.limit,offset:+t.offset,applicationIds:t.filterApplicationId,eventTypeName:t.filterEventFilterName,bundleId:t.filterBundleId,sortBy:`${t.sortColumn}:${t.sortDirection}`})},q=(0,V.validationResponseTransformer)((e=>200===e.status?(0,V.validatedResponse)("eventTypesArray",200,{...e.value,data:(0,$.Jc)(e.value.data)},e.errors):e)),z=e=>(0,i.useTransformQueryResponse)((0,T.useQuery)(H(e)),q),Y=(0,V.validationResponseTransformer)((e=>200===e.status?(0,V.validatedResponse)("BehaviorGroupId",200,e.value.map((e=>e.id)),e.errors):e));var W=S.B.NotificationResourceUpdateEventTypeBehaviors;const Q=(e,t)=>W.actionCreator({body:t,eventTypeId:e}),j=(0,V.validationResponseTransformer)((e=>{if("CreateBehaviorGroupResponse"===e.type){const t={id:e.value.id,displayName:e.value.display_name,bundleId:e.value.bundle_id,isDefault:!1,bundleName:void 0,actions:[],events:[]};return(0,V.validatedResponse)("BehaviorGroup",e.status,t,e.errors)}return e})),K=e=>"id"in e?S.B.NotificationResourceUpdateBehaviorGroup.actionCreator({id:e.id,body:{display_name:e.displayName,endpoint_ids:e.endpointIds,event_type_ids:e.eventTypesIds}}):S.B.NotificationResourceCreateBehaviorGroup.actionCreator({body:{bundle_id:e.bundleId,display_name:e.displayName,endpoint_ids:e.endpointIds,event_type_ids:e.eventTypesIds}}),J=()=>(0,i.useTransformQueryResponse)((0,T.useMutation)(K),j),X=e=>S.B.NotificationResourceUpdateBehaviorGroupActions.actionCreator({behaviorGroupId:e.behaviorGroupId,body:e.endpointIds});var ee=n(5543),te=n(73091);const ne={advisor:"*",policies:"*",drift:"*",compliance:"*","malware-detection":"*",patch:"*",vulnerability:"*"},ae=()=>{const e=(()=>{const{query:e}=(0,T.useClient)(),t=async n=>{var a;n||(n=i.Page.defaultPage().withSort(i.Sort.by("application",i.Direction.ASCENDING)));const{errorObject:l,payload:o}=await e(H(n));if(l)throw l;if("PageEventType"===(null==o?void 0:o.type)){const e=null===(a=null==o?void 0:o.value)||void 0===a?void 0:a.data;return 0===e.length?[]:[...e,...await t(n.nextPage())]}throw new Error(`Unknow payload type for eventTypes ${null==o?void 0:o.type}`)};return t})(),t=(0,T.useClient)(),n=(()=>{const e=(0,T.useClient)();return async t=>{const{errorObject:n,payload:a}=await e.query((e=>S.B.NotificationResourceGetLinkedBehaviorGroups.actionCreator({eventTypeId:e}))(t));if(n)throw n;return Y(a)}})(),a=async(e,a)=>{const l=[...(await n(e.id)).value,a.id],{payload:o,errorObject:i,error:r}=await t.query(Q(e.id,l));if(i)throw i;if(r)throw new Error(`Unsuccessful linking of event type ${e.id}`);return o};return async(t,n,l)=>{var o;const i=(await e()).filter((e=>{if(!(null==e?void 0:e.application))return!1;if(e.application.bundle_id!==t.bundleId)return!1;const a=n[e.application.name];return!(!a||"*"!==a&&!a.includes(e.name))}));for(const e of i){l(`  ${null===(o=e.application)||void 0===o?void 0:o.display_name} - ${e.display_name}...`);try{await a(e,t),l(" ASSOCIATED\n","pf-u-success-color-200")}catch(e){l(" ERROR!\n","pf-u-danger-color-200"),console.log(e)}}}},le=(0,Z.Z_)().url().test("has-no-path","URL contains path or parameters",(e=>{let t;try{t=new URL(e)}catch{return!1}return("/"===t.pathname||""===t.pathname)&&""===t.search})),oe=({setStep:e,stepIsInProgress:t,setStepIsInProgress:n,stepVariant:l,setStepVariant:o,hecToken:r,setHecToken:u,splunkServerHostName:d,setHostName:m,automationLogs:p,setAutomationLogs:E,setError:g})=>{const v=(()=>{const e=(()=>{const{mutate:e}=(0,ee.TK)();return async({integrationName:t,splunkServerHostName:n,hecToken:a})=>{const l={type:te.WN.SPLUNK,name:t,url:n,secretToken:a,isEnabled:!0,sslVerificationEnabled:!0},{payload:o,error:i,errorObject:r}=await e(l);if(r)throw r;if(i)throw new Error(`Error when creating integration ${t}`);return null==o?void 0:o.value}})(),t=(()=>{const{mutate:e}=J(),t=(()=>{const{query:e}=k(!1,!1);return async t=>{const n=await e(),a=n.payload;if(n.errorObject)throw n.errorObject;if(n.error||!a)throw new Error(`Unable to retrieve bundles, status ${a.status}`);return a.value.find((e=>e.name===t))}})();return async({behaviorGroupName:n,bundleName:a})=>{const l=await t(a);if(!l)throw new Error(`Unable to find bundle ${a}`);const o={bundleId:l.id,displayName:n,actions:[],events:[]},{payload:i,error:r,errorObject:s}=await e(o);if(s)throw s;if(r)throw new Error(`Error when creating behavior group ${n}`);return null==i?void 0:i.value}})(),n=(()=>{const{mutate:e}=(0,T.useMutation)(X);return async(t,n)=>{const a=t.actions||[];a.push(n.id);const l={behaviorGroupId:t.id,endpointIds:a},{payload:o,error:i,errorObject:r}=await e(l);if(r)throw r;if(i)throw new Error(`Error when linking behavior group ${t.id} with integration ${n.id}`);return null==o?void 0:o.value}})(),a=ae();return async({hecToken:l,splunkServerHostName:o},i)=>{const r="SPLUNK_AUTOMATION",s="SPLUNK_AUTOMATION_GROUP",c=ne;i(`Creating Integration ${r}...`);const u=await e({integrationName:r,hecToken:l,splunkServerHostName:o});i(" OK","pf-u-success-color-200"),i(`\nCreating Behavior Group ${s}...`);const d=await t({behaviorGroupName:s,bundleName:"rhel"});i(" OK","pf-u-success-color-200"),i("\nAssociating integration as an action for the behavior group..."),await n(d,u),i(" OK","pf-u-success-color-200"),i("\n\nAssociating events to the behavior group:\n"),await a(d,c,i)}})(),[h,f]=(0,s.useState)(!0),[y,b]=(0,s.useState)(a.ValidatedOptions.default),[C,S]=(0,s.useState)(a.ValidatedOptions.default);(0,s.useEffect)((()=>{[y,C].every((e=>e===a.ValidatedOptions.success))?f(!1):f(!0)}),[y,C]);const I=(e,t)=>{let n=e;t&&(n=c().createElement("span",{className:t},e)),E((e=>[...e,n]))};return c().createElement(a.Grid,null,c().createElement(a.GridItem,{span:6},c().createElement(a.Form,{className:"pf-u-mr-md"},c().createElement(a.FormGroup,{label:"Splunk HEC URL",labelIcon:c().createElement(a.Popover,{headerContent:c().createElement("div",null,"The server ",c().createElement("b",null,"hostname/IP Address")," and ",c().createElement("b",null,"port")," of your splunk HTTP Event Collector"),bodyContent:c().createElement("div",null,"For Splunk Enterprise the port is by default 8088.",c().createElement("br",null),"For Splunk Cloud Platform see"," ",c().createElement("a",{target:"_blank",rel:"noreferrer",href:"https://docs.splunk.com/Documentation/SplunkCloud/latest/Data/UsetheHTTPEventCollector#Send_data_to_HTTP_Event_Collector"},"documentation"),".")},c().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"splunk-server-hostname",className:"pf-c-form__group-label-help"},c().createElement(x.HelpIcon,{noVerticalAlign:!0}))),isRequired:!0,fieldId:"splunk-server-hostname",helperTextInvalid:"Invalid URL. Example: https://hostname:8088",validated:y},c().createElement(a.TextInput,{isRequired:!0,type:"text",id:"splunk-server-hostname",name:"splunk-server-hostname","aria-describedby":"splunk-server-hostname-helper",value:d,validated:y,onChange:async e=>{if(m(e),""===e)b(a.ValidatedOptions.default);else{const t=await le.isValid(e);b(t?a.ValidatedOptions.success:a.ValidatedOptions.error)}}})),c().createElement(a.FormGroup,{label:"Splunk HEC Token",fieldId:"splunk-hec-token",isRequired:!0,helperTextInvalid:"Invalid HEC token. Example: 123e4567-e89b-12d3-a456-426614174000",validated:C},c().createElement(a.TextInput,{isRequired:!0,type:"text",id:"splunk-hec-token",name:"splunk-hec-token","aria-describedby":"splunk-hec-token-helper",validated:C,value:r,onChange:async e=>{if(u(e),""===e)S(a.ValidatedOptions.default);else{const t=await(0,Z.Z_)().uuid().isValid(e);S(t?a.ValidatedOptions.success:a.ValidatedOptions.error)}}})),c().createElement(a.ActionGroup,null,c().createElement(ie,{onStart:async()=>{n(!0),E([]);try{await v({hecToken:r,splunkServerHostName:d},I)}catch(e){return I(`\n${e}`,"pf-u-danger-color-200"),n(!1),o("danger"),(0,i.addDangerNotification)("Configuration failed",c().createElement(re,null),!0),void g(e)}f(!1),n(!1),o("success"),I("\nDONE!","pf-u-success-color-200")},onFinish:()=>{e((e=>e+1))},stepIsInProgress:t,stepVariant:l,isDisabled:h})))),c().createElement(a.GridItem,{span:6},c().createElement(a.CodeBlock,null,c().createElement(a.CodeBlockCode,null,p))))},ie=({onStart:e,onFinish:t,stepIsInProgress:n,stepVariant:l,isDisabled:o})=>n?c().createElement(a.Button,{variant:"primary",isLoading:!0},"Configuration in progress"):"success"===l||"danger"===l?c().createElement(a.Button,{variant:"primary",onClick:t},"success"===l?c().createElement(x.CheckCircleIcon,null):c().createElement(x.ExclamationCircleIcon,null)," ","Next: Review"):c().createElement(a.Button,{variant:"primary",isDisabled:o,onClick:e},"Run Configuration"),re=()=>c().createElement(c().Fragment,null,c().createElement("p",{className:"pf-u-mb-md"},"There was a problem processing the request. Please try again. If the problem persists, contact Red Hat support by opening the ticket."),c().createElement(a.List,{variant:a.ListVariant.inline},c().createElement(a.ListItem,null,c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:B},"Open a Red Hat Support ticket")),c().createElement(a.ListItem,null,c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:G},"Go to documentation")))),se=()=>c().createElement(c().Fragment,null,c().createElement(f(),{title:c().createElement(c().Fragment,null,O.V.pages.splunk.page.title,c().createElement(a.Popover,{bodyContent:O.V.pages.splunk.page.help,footerContent:c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:G},"Learn more ",c().createElement(x.ExternalLinkSquareAltIcon,null))},c().createElement(a.Button,{variant:"plain","aria-label":"Help description",className:"title-help-label"},c().createElement(x.HelpIcon,{noVerticalAlign:!0}))))}),O.V.pages.splunk.page.description);var ce=n(46242);const ue=({to:e,...t})=>{const{getBundle:n}=(0,o.Z)();return s.createElement(p.Link,{to:`/${n()}/notifications${e}`},s.createElement(a.Button,{...t},t.children))};var de,me=n(47435),pe=n(29422),Ee=n(313),ge=n(42699),ve=n(23855),he=n(37950),fe=n(18172);!function(e){e.TODAY="today",e.YESTERDAY="yesterday",e.LAST_7="last_7",e.LAST_14="last_14",e.CUSTOM="custom"}(de||(de={}));const ye={[de.TODAY]:"Today",[de.YESTERDAY]:"Yesterday",[de.LAST_7]:"Last 7 days",[de.LAST_14]:"Last 14 days",[de.CUSTOM]:"Custom"},be=(0,u.style)({backgroundColor:(0,me.important)("white"),cursor:"pointer",$nest:{"&::placeholder":{color:(0,me.important)("black")},"&:hover":{borderBottomColor:"var(--pf-v5-global--active-color--100)"}}});class Ce{constructor(e){this.value=e}toString(){return ye[this.value]}compareTo(e){return e instanceof Ce&&e.value===this.value}}const Te={isReadOnly:!0,className:be},Se=e=>{const t=s.useMemo((()=>new Date),[]),n=s.useMemo((()=>(0,pe.Z)(t,{days:-14})),[t]),l=s.useMemo((()=>[a=>(0,Ee.Z)(a,n)?"Date is before the retention policy":(0,ge.Z)(a,t)?"Date is after today":e.period[1]&&(0,ge.Z)(a,e.period[1])?"Start date must be before end date":""]),[n,t,e.period]),o=s.useMemo((()=>[a=>(0,Ee.Z)(a,n)?"Date is before the retention policy":(0,ge.Z)(a,t)?"Date is after today":e.period[0]&&(0,Ee.Z)(a,e.period[0])?"End date must be after start date":""]),[n,t,e.period]),i=s.useCallback((n=>{const a=e.setPeriod,l=(0,ve.Z)(n);a((0,fe.ZP)((e=>{e[0]=l,e[1]||(e[1]=(0,he.Z)([(0,pe.Z)(l,{days:1}),t]))})))}),[e.setPeriod,t]),c=s.useCallback((t=>{(0,e.setPeriod)((0,fe.ZP)((e=>{e[1]=(0,ve.Z)(t)})))}),[e.setPeriod]),u=s.useMemo((()=>e.period[0]?(0,r.Z)(e.period[0],"yyyy-MM-dd"):void 0),[e.period]),d=s.useMemo((()=>e.period[1]?(0,r.Z)(e.period[1],"yyyy-MM-dd"):void 0),[e.period]),m=(0,s.useRef)(null),p=(0,s.useRef)(null),E=s.useCallback((()=>{var e;null===(e=m.current)||void 0===e||e.setCalendarOpen(!0)}),[m]),g=s.useCallback((()=>{var e;null===(e=p.current)||void 0===e||e.setCalendarOpen(!0)}),[p]),v=s.useMemo((()=>({...Te,onClick:E})),[E]),h=s.useMemo((()=>({...Te,onClick:g})),[g]);return s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.DatePicker,{placeholder:"Start",inputProps:v,validators:l,onChange:i,value:u,ref:m})),s.createElement(a.SplitItem,{className:"pf-v5-u-align-self-center pf-v5-u-px-sm pf-v5-u-color-300"},"to"),s.createElement(a.SplitItem,null,s.createElement(a.DatePicker,{placeholder:"End",inputProps:h,validators:o,onChange:c,value:d,ref:p})))},ke=e=>{const t=s.useMemo((()=>Object.values(de).map((e=>s.createElement(a.SelectOption,{key:e,value:new Ce(e)})))),[]),[n,l]=s.useState(!1),o=s.useCallback((()=>l((e=>!e))),[l]),i=s.useMemo((()=>new Ce(e.value)),[e.value]),r=s.useCallback(((t,n)=>{const a=e.setValue;n instanceof Ce&&(a(n.value),l(!1))}),[e.setValue]);return s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.Select,{isOpen:n,variant:a.SelectVariant.single,onToggle:o,selections:i,onSelect:r},t)),e.value===de.CUSTOM&&s.createElement(a.SplitItem,null,s.createElement(Se,{period:e.period,setPeriod:e.setPeriod,retentionDays:e.retentionDays})))};var Ie=n(76871),Ne=n(64107),we=n(71652),Ae=n(89887),De=n(12990),Le=n(4088),Pe=n(32564),Oe=n(54971);const Fe=()=>s.createElement(Oe.q,{text:"Failure"},s.createElement(x.ExclamationCircleIcon,{"data-testid":"fail-icon",color:De.Q.value})),Re=()=>s.createElement(Oe.q,{text:"Unknown"},s.createElement(x.UnknownIcon,{"data-testid":"unknown-icon"})),xe=()=>s.createElement(Oe.q,{text:"Processing"},s.createElement(x.InProgressIcon,{"data-testid":"in-progress-icon"})),Ge=()=>s.createElement(Oe.q,{text:"Sent"},s.createElement(x.CheckCircleIcon,{"data-testid":"success-icon",color:Le.g.value})),Be=()=>s.createElement(Oe.q,{text:"Success"},s.createElement(x.CheckCircleIcon,{"data-testid":"success-icon",color:Le.g.value})),Me=()=>s.createElement(Oe.q,{text:"Warning"},s.createElement(x.ExclamationTriangleIcon,{color:Pe.k.value})),_e=[[s.createElement(Be,{key:"status-success"}),"The notification was executed successfully"],[s.createElement(Ge,{key:"status-sent"}),"The notification was sent for processing - but there is no way to assert if it was executed successfully"],[s.createElement(Me,{key:"status-warning"}),"The notification was executed successfully after some retries"],[s.createElement(xe,{key:"status-processing"}),"The notification was sent for processing and is awaiting an outcome result"],[s.createElement(Fe,{key:"status-failed-externally"}),"An unexpected error occurred while processing the notification"]],Ue=e=>s.createElement(Ae.d,{title:"Action status meaning",tableBody:_e},s.createElement(s.Fragment,null,e.children));var Ze=n(21095);const Ve=(0,u.style)({minWidth:(0,me.important)("90px")}),$e=e=>{const{action:{id:t},getIntegrationRecipient:n}=e,l=(0,Ze.Z)((async()=>t&&n(t)),[t,n]);return s.createElement(Ie.TableComposable,{borders:!1,variant:Ie.TableVariant.compact,isStickyHeader:!0},s.createElement(Ie.Thead,null,s.createElement(Ie.Tr,null,s.createElement(Ie.Th,{className:Ve},"Action"),s.createElement(Ie.Th,{className:Ve},"Recipient"),s.createElement(Ie.Th,{className:Ve},"Status"))),s.createElement(Ie.Tbody,null,s.createElement(Ie.Tr,null,s.createElement(Ie.Td,null,g.ZP.integrations.types[e.action.endpointType].action),s.createElement(Ie.Td,null,t?l.loading?s.createElement(a.Skeleton,{width:"150px"}):l.value:s.createElement(a.Tooltip,{content:"The integration no longer exists, it could have been deleted."},s.createElement("span",null,"Unknown integration"))),s.createElement(Ie.Td,null,s.createElement("div",null,(e=>{switch(e.last){case"SUCCESS":return e.isDegraded?s.createElement(Me,null):s.createElement(Be,null);case"SENT":return s.createElement(Ge,null);case"PROCESSING":return s.createElement(xe,null);case"FAILED":return s.createElement(Fe,null);case"UNKNOWN":return s.createElement(Re,null);default:(0,ce.ZP)(e.last)}})(e.action.status)),e.action.successCount>1&&s.createElement("div",{className:"pf-v5-u-color-300"},e.action.successCount," ",e.action.endpointType===te.WN.EMAIL_SUBSCRIPTION?"emails sent":"succeeded"," "),e.action.errorCount>1&&s.createElement("div",{className:"pf-v5-u-color-300"},e.action.errorCount," ",e.action.endpointType===te.WN.EMAIL_SUBSCRIPTION?"emails failed":"failed"," ")))))};var He;!function(e){e[e.EVENT=0]="EVENT",e[e.SERVICE=1]="SERVICE",e[e.DATE=2]="DATE"}(He||(He={}));const qe=(0,u.style)({cursor:"pointer"}),ze=e=>{switch(e.last){case"FAILED":return{color:"red",icon:s.createElement(x.ExclamationCircleIcon,null)};case"SENT":case"SUCCESS":return e.isDegraded?{color:"orange",icon:s.createElement(x.ExclamationTriangleIcon,null)}:{color:"green",icon:s.createElement(x.CheckCircleIcon,null)};case"PROCESSING":return{color:"grey",icon:s.createElement(x.InProgressIcon,null)};case"UNKNOWN":return{color:"grey",icon:s.createElement(x.UnknownIcon,null)};default:(0,ce.ZP)(e.last)}},Ye=e=>{const t=s.useCallback(((t,n,a,l)=>{(0,e.onSort)(n,a)}),[e.onSort]),n=s.useMemo((()=>({[He.EVENT]:void 0,[He.SERVICE]:void 0,[He.DATE]:{sortBy:{direction:e.sortDirection,index:e.sortColumn},columnIndex:He.DATE,onSort:t}})),[e.sortColumn,e.sortDirection,t]),l=s.useMemo((()=>{const t=e.events;return e.loading?[...Array(10)].map(((e,t)=>s.createElement(Ie.Tr,{key:`loading-row-${t}`},s.createElement(Ie.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Ie.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Ie.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Ie.Td,null,s.createElement(a.Skeleton,null))))):t.map((t=>s.createElement(Ie.Tr,{key:t.id},s.createElement(Ie.Td,null,t.event),s.createElement(Ie.Td,null,t.application," - ",t.bundle),s.createElement(Ie.Td,null,t.actions.length>0?s.createElement(a.LabelGroup,null,t.actions.map((t=>s.createElement(a.Popover,{key:t.id,hasAutoWidth:!0,bodyContent:s.createElement($e,{action:t,getIntegrationRecipient:e.getIntegrationRecipient})},s.createElement(a.Label,{className:qe,...ze(t.status)},g.ZP.integrations.types[t.endpointType].action))))):"No actions"),s.createElement(Ie.Td,null,s.createElement(Ne.Z,{type:"exact",date:t.date})))))}),[e.loading,e.events,e.getIntegrationRecipient]);return 0===l.length?s.createElement(we.G,{variant:a.EmptyStateVariant.full,title:O.V.components.eventLog.table.notFound.title,description:O.V.components.eventLog.table.notFound.description}):s.createElement(Ie.TableComposable,{isStickyHeader:!0},s.createElement(Ie.Thead,null,s.createElement(Ie.Tr,null,s.createElement(Ie.Th,{sort:n[He.EVENT]},"Event type"),s.createElement(Ie.Th,{sort:n[He.SERVICE]},"Service"),s.createElement(Ie.Th,null,"Action taken"," ",s.createElement(Ue,null,s.createElement(a.Button,{variant:a.ButtonVariant.plain},s.createElement(x.HelpIcon,null)))),s.createElement(Ie.Th,{sort:n[He.DATE]},"Date and time"))),s.createElement(Ie.Tbody,null,l))};var We=n(95809),Qe=n(69930);const je=()=>{const e=(0,i.getInsights)(),t=(0,i.getInsightsEnvironment)(e);return(0,g.Lk)(t)};var Ke,Je=n(56437),Xe=n(37869);!function(e){e.EVENT="event",e.BUNDLE="bundle",e.APPLICATION="application",e.ACTION_TYPE="endpointTypes",e.ACTION_STATUS="invocationResults"}(Ke||(Ke={}));const et=(e,t,n)=>!(!e||!t)&&(e===t||e.length===t.length&&e.every(((a,l)=>!!(n&&t.includes(a)||!n&&e[l]===t[l])))),tt=e=>!!e.checkProps.checked,nt=e=>e.children?e.children.some((e=>nt(e))):tt(e),at=e=>e.children?e.children.every((e=>at(e))):tt(e),lt=e=>{const{groups:t,placeholder:n,filters:l,updateFilters:o}=e,i=c().useMemo((()=>((e,t)=>{const n={};return e.forEach((e=>{var a;const l=t.find((t=>t.bundleId===e.name)),o=null===(a=null==l?void 0:l.chips)||void 0===a?void 0:a.map((e=>e.value)),i=e.children,r=0!==i.length&&i.every((e=>null==o?void 0:o.includes(e.name)));n[e.name]={id:e.name,name:e.displayName,checkProps:{checked:r||!!l&&null},children:0!==i.length?i.map((e=>({id:e.name,name:e.displayName,checkProps:{checked:r||(null==o?void 0:o.includes(e.name))}}))):void 0}})),n})(t,l)),[t,l]),[r,s]=c().useState(i),[u,d]=c().useState(!1),m=c().useMemo((()=>Object.values(r)),[r]),[p,E]=c().useMemo((()=>{const e=[];return[m.filter((e=>e.checkProps.checked||null===e.checkProps.checked)).map((t=>{var n,a;return e.push(t.id),{bundleId:t.id,category:t.name,chips:null!==(a=null===(n=t.children)||void 0===n?void 0:n.filter((e=>e.checkProps.checked)).map((e=>({name:e.name,value:e.id,isRead:!0}))))&&void 0!==a?a:[{name:t.name,value:t.id,isRead:!0}]}})),e]}),[m]);return c().useEffect((()=>{0!==t.length&&s((0,fe.ZP)((e=>0===Object.keys(e).length||0===l.length?i:void l.forEach((t=>{var n;const a=e[t.bundleId],l=t.chips.map((e=>e.value));null===(n=a.children)||void 0===n||n.forEach((e=>{e.checkProps.checked=l.includes(e.id)})),at(a)?a.checkProps.checked=!0:nt(a)?a.checkProps.checked=null:a.checkProps.checked=!1})))))}),[t,l,i]),c().useEffect((()=>{o((0,fe.ZP)((e=>{if(0===e.length&&0===p.length)return e;if(0!==e.length&&0===p.length)return[];{const t=e.map((e=>e.bundleId));return et(t,E)&&p.every(((t,n)=>{if(e[n]&&t.bundleId===e[n].bundleId){const a=e[n].chips.map((e=>e.value)),l=t.chips.map((e=>e.value));return et(a,l,!0)}return!1}))?e:p}})))}),[p,E,o]),c().createElement(a.Dropdown,{toggle:c().createElement(a.DropdownToggle,{onToggle:()=>d(!u),toggleIndicator:x.AngleDownIcon},n),isOpen:u},c().createElement(a.TreeView,{data:m,hasChecks:!0,onCheck:(e,t,n)=>{((e,t,n)=>{const a=e.target.checked;s((0,fe.ZP)((e=>{var l;if(n){const l=e[n.id].children;null==l||l.some((e=>e.id===t.id&&(e.checkProps.checked=a,!0))),at(e[n.id])?e[n.id].checkProps.checked=!0:nt(e[n.id])?e[n.id].checkProps.checked=null:e[n.id].checkProps.checked=a}else e[t.id].checkProps.checked=a,null===(l=e[t.id].children)||void 0===l||l.forEach((e=>e.checkProps.checked=a))})))})(e,t,n)}}))},ot={[Je.k$.EMAIL_SUBSCRIPTION]:{name:"Email"},[Je.k$.DRAWER]:{name:"Drawer"},[Je.k$.INTEGRATION]:{name:"Integration"}},it=[{value:"true",chipValue:"Success",label:s.createElement("span",null,s.createElement(x.CheckCircleIcon,{color:"green"})," Success")},{value:"false",chipValue:"Sent",label:s.createElement("span",null,s.createElement(x.CheckCircleIcon,{color:"green"})," Sent")},{value:"false",chipValue:"Warning",label:s.createElement("span",null,s.createElement(x.ExclamationTriangleIcon,{className:"pf-v5-u-warning-color-100"})," ","Warning"," ")},{value:"false",chipValue:"Processing",label:s.createElement("span",null,s.createElement(x.InProgressIcon,null)," Processing"," ")},{value:"false",chipValue:"Failure",label:s.createElement("span",null,s.createElement(x.ExclamationCircleIcon,{color:"red"})," Failure")}],rt=e=>{const t=je(),n=(0,Qe.N)(),l=s.useMemo((()=>t.map((e=>({value:e.toUpperCase(),chipValue:ot[e].name,label:ot[e].name}))).concat(n.map((e=>({value:e.toUpperCase(),chipValue:g.ZP.integrations.types[e].name,label:g.ZP.integrations.types[e].name}))))),[t,n]),o=s.useMemo((()=>({[Ke.EVENT]:{label:"Event",placeholder:"Filter by event"},[Ke.APPLICATION]:{label:"Application",placeholder:"Filter by application"},[Ke.ACTION_TYPE]:{label:"Action Type",placeholder:"Filter by action type",options:{exclusive:!1,items:l}},[Ke.ACTION_STATUS]:{label:"Action Status",placeholder:"Filter by action status",options:{exclusive:!1,items:it}}})),[l]),r=((e,t,n,a,l)=>{const[o,r]=c().useState([]),s=(0,i.usePrimaryToolbarFilterConfig)(Ke,t,n,a,l),u=c().useMemo((()=>s.activeFiltersConfig.onDelete),[s.activeFiltersConfig.onDelete]),d=c().useCallback(((e,t)=>{const n=[],a=[];t.forEach((e=>{e.bundleId?a.push(e):n.push(e)})),u(e,n),0!==a.length&&r((0,fe.ZP)((e=>{const t=[];e.forEach(((e,n)=>{a.some((a=>{if(e.bundleId===a.bundleId){const l=a.chips.map((e=>e.value));return e.chips=e.chips.filter((e=>!l.includes(e.value))),0===e.chips.length&&t.push(n),!0}return!1}))})),t.forEach(((t,n)=>{e.splice(t-n,1)}))})))}),[u,r]),m=c().useCallback(((e,t)=>{var n,a;const l=(e,t,n)=>({bundleId:e,category:(null==t?void 0:t.displayName)||`${e} Loading...`,chips:(null==t?void 0:t.children)?0!==(null==n?void 0:n.length)?null==n?void 0:n.map((e=>({name:e.displayName,value:e.name,isRead:!0}))):[{name:t.displayName,value:t.name,isRead:!0}]:[{name:"Loading",value:e,isRead:!0}]}),o={};null===(n=e.application)||void 0===n||n.forEach((e=>{const t=e.split("."),n=t[0],a=t[1];o[n]?o[n].push(a):o[n]=[a]}));const i=Object.keys(o).map((e=>{var n;const a=null==t?void 0:t.find((t=>t.name===e)),i=null===(n=null==a?void 0:a.children)||void 0===n?void 0:n.filter((t=>o[e].includes(t.name)));return l(e,a,i)}));return((null===(a=e.bundle)||void 0===a?void 0:a.map((e=>{const n=null==t?void 0:t.find((t=>t.name===e));return l(e,n,null==n?void 0:n.children)})))||[]).concat(i)}),[]);c().useEffect((()=>{r(m(t,0!==e.length?e:void 0))}),[e,m]);const p=c().useMemo((()=>({label:"Application",type:"custom",filterValues:{children:c().createElement(lt,{groups:e,placeholder:"Filter by Application",filters:o,updateFilters:r})}})),[e,o]),E=c().useMemo((()=>s.activeFiltersConfig.filters.filter((e=>e&&!e.bundleId)).concat(o)),[o,s.activeFiltersConfig.filters]),g=c().useMemo((()=>(0,fe.ZP)(t.bundle,(t=>{if(0===e.length)return;const n=[];return e.forEach((e=>{o.some((t=>{var n,a;return t.bundleId===e.name&&(0===(null===(n=e.children)||void 0===n?void 0:n.length)&&1===t.chips.length||(null===(a=e.children)||void 0===a?void 0:a.length)===t.chips.length)}))&&n.push(e.name)})),et(t,n,!0)?t:n}))),[e,t.bundle,o]),v=c().useMemo((()=>(0,fe.ZP)(t.application,(t=>{if(0===e.length)return;const n=[];return o.forEach((t=>{var a,l;const o=e.find((e=>e.name===t.bundleId)),i=null===(a=t.chips)||void 0===a?void 0:a.map((e=>e.value));i&&(null===(l=o.children)||void 0===l?void 0:l.some((e=>!i.includes(e.name))))&&i.forEach((e=>{const t=`${o.name}.${e}`;n.push(t)}))})),et(t,n,!0)?t:n}))),[e,t.application,o]);return n.bundle(g),n.application(v),(0,fe.ZP)(s,(e=>{e.filterConfig.items[1]=p,e.activeFiltersConfig.filters=E,e.activeFiltersConfig.onDelete=d}))})(e.bundleOptions,e.filters,e.setFilters,e.clearFilter,o),u=s.useCallback(((t,n)=>{(0,e.pageChanged)(n)}),[e.pageChanged]),d=s.useCallback(((t,n)=>{(0,e.perPageChanged)(n)}),[e.perPageChanged]),m=s.useMemo((()=>({itemCount:e.count,page:e.page,perPage:e.perPage,isCompact:!0,variant:a.PaginationVariant.top,onSetPage:u,onFirstClick:u,onPreviousClick:u,onNextClick:u,onLastClick:u,onPageInput:u,onPerPageSelect:d})),[e.count,e.page,e.perPage,u,d]),p=s.useMemo((()=>({...m,isCompact:!1,variant:a.PaginationVariant.bottom})),[m]);return s.createElement("div",{...(0,Xe.k)("Notifications/EventLog/DualToolbar",e)},s.createElement(We.Z,{...r,filterConfig:r.filterConfig,activeFiltersConfig:r.activeFiltersConfig,dedicatedAction:s.createElement(ke,{value:e.dateFilter,setValue:e.setDateFilter,retentionDays:e.retentionDays,setPeriod:e.setPeriod,period:e.period}),pagination:m}),e.children,s.createElement(We.Z,{pagination:p}))};var st=n(64258),ct=n(43542);const ut=(0,u.style)({paddingTop:st.S.value}),dt=(0,u.style)({marginLeft:ct.p.value}),mt=e=>s.createElement(v.Z,{className:"pf-u-pb-md"},s.createElement(a.Split,null,s.createElement(a.SplitItem,{isFilled:!0},s.createElement(f(),{title:e.title}),s.createElement(a.TextContent,{className:ut},s.createElement(a.Text,null,e.subtitle))),e.action&&s.createElement(a.SplitItem,{className:dt},e.action)));var pt=n(2028),Et=n(77836);const gt=e=>({id:e.id,bundle:e.bundle,application:e.application,event:e.event_type,date:(0,i.fromUtc)(new Date(e.created)),actions:vt(ht(e.actions))}),vt=e=>e.sort(((e,t)=>e.endpointType.localeCompare(t.endpointType))),ht=e=>{const t={},n=[];return e.forEach((e=>{if(e.endpoint_id)if(t[e.endpoint_id]){const n=ft(e),a=t[e.endpoint_id];yt(n.status.last)?a.status.isDegraded=!0:a.status.last=n.status.last,a.errorCount+=n.errorCount,a.successCount+=n.successCount}else t[e.endpoint_id]=ft(e);else n.push(ft(e))})),[...Object.values(t),...n]},ft=e=>{var t;return{id:null!==(t=e.endpoint_id)&&void 0!==t?t:void 0,endpointType:(0,Et.LW)({type:e.endpoint_type,sub_type:e.endpoint_sub_type}),status:{last:e.status,isDegraded:yt(e.status)},successCount:yt(e.status)?0:1,errorCount:yt(e.status)?1:0}},yt=e=>"FAILED"===e,bt=(0,V.validationResponseTransformer)((e=>200===e.status?(0,V.validatedResponse)("Events",200,{...e.value,data:e.value.data.map(gt)},e.errors):e));var Ct=n(45295);const Tt=e=>Ct.B.EndpointResourceGetEndpoint.actionCreator({id:e});var St=n(33479),kt=n(19013);const It="yyyy-MM-dd",Nt=()=>{const e=(0,m.useFlag)("platform.notifications.overhaul"),t=(0,T.useParameterizedQuery)(Tt),{rbac:n}=(0,E.b)(),l=k(!0),o=s.useMemo((()=>{const e=l.payload;return 200===(null==e?void 0:e.status)?e.value:[]}),[l.payload]),[c,u]=s.useState(de.LAST_14),d=((e=250)=>{const t=(0,s.useMemo)((()=>{const e=()=>(0,i.useUrlStateMultipleOptions)("application"),t=()=>(0,i.useUrlStateMultipleOptions)("bundle"),n=()=>(0,i.useUrlStateMultipleOptions)("endpointTypes"),a=()=>(0,i.useUrlStateMultipleOptions)("invocationResults"),l=()=>(0,i.useUrlStateString)("event");return o=>{switch(o){case Ke.APPLICATION:return e;case Ke.BUNDLE:return t;case Ke.EVENT:return l;case Ke.ACTION_TYPE:return n;case Ke.ACTION_STATUS:return a;default:(0,ce.ZP)(o)}}}),[]);return(0,i.useFilters)(Ke,e,t)})(),[p,v]=s.useState([void 0,void 0]),[h,f]=s.useState("desc"),[y,b]=s.useState(He.DATE),C=s.useCallback(((e,t)=>{f(t),b(e)}),[f,b]),I=((e,t,n)=>(0,s.useCallback)((a=>{const l=new i.Filter;if(null==a?void 0:a.bundle){const t=null==a?void 0:a.bundle,n=e.filter((e=>t.includes(e.name))).map((e=>e.id));l.and("bundleIds",i.Operator.EQUAL,n)}if(null==a?void 0:a.application){const t=a.application,n=[];t.forEach((t=>{var a;const l=t.split("."),o=l[0],i=l[1],r=e.find((e=>e.name===o));if(r){const e=null===(a=r.children)||void 0===a?void 0:a.find((e=>e.name===i));e&&n.push(e.id)}})),l.and("appIds",i.Operator.EQUAL,n)}(null==a?void 0:a.event)&&l.and("event",i.Operator.EQUAL,a.event),(null==a?void 0:a.invocationResults)&&l.and("invocationResults",i.Operator.EQUAL,a.invocationResults),(null==a?void 0:a.endpointTypes)&&l.and("endpointTypes",i.Operator.EQUAL,a.endpointTypes);let o=[void 0,void 0];const s=(0,i.toUtc)(new Date);switch(t){case de.LAST_14:o=[(0,St.Z)((0,kt.Z)(s),{days:14}),s];break;case de.LAST_7:o=[(0,St.Z)((0,kt.Z)(s),{days:7}),s];break;case de.TODAY:o=[s,s];break;case de.YESTERDAY:{const e=(0,St.Z)((0,kt.Z)(s),{days:1});o=[e,e];break}case de.CUSTOM:o=n}return o[0]&&o[1]&&(l.and("start",i.Operator.EQUAL,(0,r.Z)(o[0],It)),l.and("end",i.Operator.EQUAL,(0,r.Z)(o[1],It))),l}),[e,t,n]))(o,c,p),N=s.useMemo((()=>{const e=h.toUpperCase();let t;if(y!==He.DATE)throw new Error(`Invalid sorting index: ${y}`);return t="created",i.Sort.by("created",e)}),[y,h]),w=(0,pt.q)(g.ZP.paging.defaultPerPage,I,d.filters,N),D=(e=>{const t=(null!=e?e:i.Page.defaultPage()).toQuery();return(0,i.useTransformQueryResponse)((0,T.useQuery)(S.B.EventResourceGetEvents.actionCreator({limit:+t.limit,offset:+t.offset,bundleIds:t.filterBundleIds,appIds:t.filterAppIds,invocationResults:t.filterInvocationResults,endpointTypes:t.filterEndpointTypes,startDate:t.filterStart,endDate:t.filterEnd,eventTypeDisplayName:t.filterEvent,sortBy:`${t.sortColumn}:${t.sortDirection}`,includeActions:!0})),bt)})(w.page),L=s.useMemo((()=>{var e;return 200===(null===(e=D.payload)||void 0===e?void 0:e.status)?{data:D.payload.value.data,count:D.payload.value.meta.count}:{data:[],count:0}}),[D]),P=s.useMemo((()=>{const e=d.filters.bundle;return e&&e.length>0?Fl.notifications(e[0]):Fl.notifications("")}),[d.filters]),F=s.useCallback((async e=>{var n;const a=t.query,l=await a(e);if("Endpoint"===(null===(n=l.payload)||void 0===n?void 0:n.type)){const e=l.payload.value.type;switch(e){case"camel":case"webhook":case"ansible":return l.payload.value.name;case"email_subscription":case"drawer":return l.payload.value.properties.only_admins?"Users: Admin":"Users: All";default:(0,ce.ZP)(e)}}return"Error while loading"}),[t.query]);return s.createElement(s.Fragment,null,s.createElement(mt,{title:O.V.pages.notifications.eventLog.title,subtitle:O.V.pages.notifications.eventLog.subtitle,action:!e&&s.createElement(ue,{isDisabled:!n.canReadEvents,to:P,variant:a.ButtonVariant.secondary},O.V.pages.notifications.eventLog.viewNotifications)}),s.createElement(A,null,s.createElement(rt,{...d,bundleOptions:o,dateFilter:c,setDateFilter:u,count:L.count,perPageChanged:w.changeItemsPerPage,pageChanged:w.changePage,perPage:w.page.size,page:w.page.index,pageCount:L.data.length,retentionDays:14,period:p,setPeriod:v},s.createElement(Ye,{events:L.data,loading:D.loading,onSort:C,sortColumn:y,sortDirection:h,getIntegrationRecipient:F}))))};var wt=n(35664),At=n(97481),Dt=n(36271);const Lt=()=>{const e=(0,Dt.Z)({type:"AppSkeleton"});return s.createElement("div",{...e},s.createElement(v.Z,null,s.createElement("div",{className:"pf-c-content"},s.createElement(f(),{title:s.createElement(wt.Z,{size:"sm"})}))),s.createElement(A,null,s.createElement(P.Z,null,s.createElement(a.Bullseye,null,s.createElement(At.Z,{centered:!0})))))},Pt=e=>S.B.NotificationResourceGetApplicationsFacets.actionCreator({bundleName:e}),Ot=()=>(0,T.useParameterizedQuery)(Pt);var Ft=n(28551);const Rt=e=>{const[t,n]=c().useState(0),l=c().useCallback((e=>{n(e)}),[]);return c().createElement("div",{className:"pf-v5-u-background-color-100"},c().createElement(a.Tabs,{className:"pf-v5-u-pl-lg",defaultActiveKey:t,role:"region",onClick:l},e.children))};var xt,Gt=n(91654),Bt=n(77125),Mt=n(96191),_t=n(29987),Ut=n(3276);!function(e){e.ASC="asc",e.DESC="desc"}(xt||(xt={}));const Zt=Object.freeze([]),Vt=Object.freeze({}),$t=()=>c().createElement(a.EmptyState,{variant:"full"},c().createElement(a.EmptyStateIcon,{className:"pf-u-mb-xl",icon:x.SearchIcon}),c().createElement(a.Title,{headingLevel:"h2",size:"lg"},"No results found"),c().createElement(a.EmptyStateBody,null,c().createElement(a.TextContent,null,c().createElement(a.Text,null,"No notifications match your filter choices above. Try removing or changing the filters to see results.")))),Ht=e=>{return t=e,"id",e=>e.id===t;var t},qt=()=>s.createElement("span",null,", "),zt=e=>{const t=s.useCallback((()=>{const t=e.onSelect;t&&t(e.notification,e.behaviorGroup,!1)}),[e.onSelect,e.behaviorGroup,e.notification]);return s.createElement(a.Chip,{onClick:t,isReadOnly:e.behaviorGroup.isDefault},e.behaviorGroup.displayName)},Yt=e=>{const[t,n]=s.useState(!1),l=s.useCallback((t=>{var n,a,l;const o=null!==(l=null===(a=null===(n=null==t?void 0:t.currentTarget)||void 0===n?void 0:n.firstChild)||void 0===a?void 0:a.dataset)&&void 0!==l?l:Vt,i=e.onSelect;if(!e.behaviorGroupContent.isLoading&&!e.behaviorGroupContent.hasError&&i&&o.behaviorGroupId){const t=e.behaviorGroupContent.content.find(Ht(o.behaviorGroupId));if(t){const n=!!e.selected.find(Ht(t.id));i(e.notification,t,!n)}}}),[e.onSelect,e.behaviorGroupContent,e.notification,e.selected]),o=s.useMemo((()=>e.behaviorGroupContent.isLoading||e.behaviorGroupContent.hasError?[s.createElement(a.OptionsMenuItem,{key:"is-loading",isDisabled:!0},"Loading")]:0===e.behaviorGroupContent.content.length?[s.createElement(a.OptionsMenuItem,{key:"empty",isDisabled:!0},s.createElement("span",{className:"pf-v5-u-text-align-left"},"You have no behavior groups. ",s.createElement("br",null),"Create a new group by clicking on the ",s.createElement("br",null),"'Create new group' button above."))]:[...e.selected.filter((e=>e.isDefault)),...e.behaviorGroupContent.content.filter((e=>!e.isDefault))].map((t=>{const n=!!e.selected.find(Ht(t.id));return s.createElement(a.OptionsMenuItem,{key:t.id,onSelect:l,"data-behavior-group-id":t.id,isSelected:n,isDisabled:t.isDefault},t.isDefault&&s.createElement(x.LockIcon,{className:"pf-v5-u-mr-sm"})," ",t.displayName)}))),[e.behaviorGroupContent,e.selected,l]),r=s.useMemo((()=>[...e.selected.filter((e=>e.isDefault)),...e.selected.filter((e=>!e.isDefault))]),[e.selected]),c=s.useMemo((()=>s.createElement(a.OptionsMenuToggle,{onToggle:n,toggleTemplate:0===r.length?s.createElement("span",{className:"pf-v5-u-disabled-color-100"},"Select behavior group"):s.createElement(a.ChipGroup,null,r.map((t=>s.createElement(zt,{key:t.id,behaviorGroup:t,notification:e.notification,onSelect:e.onSelect}))))})),[r,e.notification,e.onSelect]),u=s.useMemo((()=>0===r.length?s.createElement("span",null,s.createElement(a.Icon,{className:"pf-v5-u-mr-sm pf-v5-u-disabled-color-100",isInline:!0},s.createElement(x.BellSlashIcon,null)),"Mute"):(0,i.join)(r.map((e=>s.createElement(s.Fragment,{key:e.id},e.isDefault&&s.createElement(a.Tooltip,{content:`${e.displayName} behavior is attached to this event and cannot be changed.\n                Add additional behavior groups to assign different actions or recipients.`},s.createElement(x.LockIcon,{className:"pf-v5-u-mr-sm pf-v5-u-disabled-color-100"}))," ",e.displayName))),qt)),[r]);return e.isEditMode?s.createElement(a.OptionsMenu,{id:e.id,direction:"down",menuItems:o,toggle:c,isOpen:t,menuAppendTo:document.body}):s.createElement(Ie.TableText,{wrapModifier:"truncate"}," ",u," ")};var Wt;!function(e){e[e.EVENT=0]="EVENT",e[e.APPLICATION=1]="APPLICATION",e[e.BEHAVIOR=2]="BEHAVIOR"}(Wt||(Wt={}));const Qt=(0,u.style)({float:"right"}),jt=()=>s.createElement(s.Fragment,null),Kt=(e,t)=>{const n="done"!==e.loadingActionStatus;return e.isEditMode?{actionsToggle:jt,items:[{key:"done",className:Qt,title:s.createElement(a.Button,{"aria-label":"done",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(x.CheckIcon,{color:n?Mt.J.value:_t.h.value})),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onFinishEditing(e.id),isDisabled:n||!t},{key:"cancel",className:Qt,title:s.createElement(a.Button,{"aria-label":"cancel",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(x.CloseIcon,{color:n?Mt.J.value:Ut.p.value})),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onCancelEditing(e.id),isDisabled:n||!t}]}:{actionsToggle:jt,items:[{key:"edit",className:Qt,title:s.createElement(a.Button,{"aria-label":"edit",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(x.PencilAltIcon,null)),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onStartEditing(e.id),isDisabled:n||!t}]}},Jt=((e,t)=>{var n;const a=t=>s.createElement("div",{...(0,Xe.k)("Notifications/Table",t)},s.createElement(e,{...t}));return a.displayName=`Ouia(${null!==(n=e.displayName)&&void 0!==n?n:e.name})`,a})((e=>{const t=s.useMemo((()=>{if(e.onStartEditing&&e.onFinishEditing&&e.onCancelEditing)return{onStartEditing:e.onStartEditing,onFinishEditing:e.onFinishEditing,onCancelEditing:e.onCancelEditing,onBehaviorGroupLinkUpdated:e.onBehaviorGroupLinkUpdated}}),[e.onStartEditing,e.onFinishEditing,e.onCancelEditing,e.onBehaviorGroupLinkUpdated]),n=s.useCallback(((t,n,a,l)=>{(0,e.onSort)(n,(e=>{switch(e.toLowerCase()){case xt.ASC:return xt.ASC;case xt.DESC:return xt.DESC;default:throw new Error(`Invalid sort direction ${e}`)}})(a))}),[e.onSort]),l=s.useMemo((()=>{const t={direction:e.sortDirection,index:e.sortBy};return{[Wt.EVENT]:{sortBy:t,columnIndex:Wt.EVENT,onSort:n},[Wt.APPLICATION]:{sortBy:t,columnIndex:Wt.APPLICATION,onSort:n},[Wt.BEHAVIOR]:void 0}}),[e.sortDirection,e.sortBy,n]),o=s.useMemo((()=>{const n=e.notifications,l=e.behaviorGroupContent;return n.map((e=>{var n;return s.createElement(Ie.Tr,{key:e.id},s.createElement(Ie.Td,null,e.eventTypeDisplayName),s.createElement(Ie.Td,null,e.applicationDisplayName),s.createElement(Ie.Td,null,"loading"===e.loadingActionStatus?s.createElement(a.Skeleton,{width:"90%"}):s.createElement(Yt,{id:`behavior-group-cell-${e.id}`,notification:e,behaviorGroupContent:l,selected:null!==(n=e.behaviors)&&void 0!==n?n:Zt,onSelect:null==t?void 0:t.onBehaviorGroupLinkUpdated,isEditMode:e.isEditMode})),s.createElement(Ie.Td,{actions:Kt(e,t)}))}))}),[e.notifications,e.behaviorGroupContent,t]);return s.createElement(Ie.TableComposable,{"aria-label":"Notifications",isStickyHeader:!0,variant:Ie.TableVariant.compact,id:"configure-events-table"},s.createElement(Ie.Thead,null,s.createElement(Ie.Tr,null,s.createElement(Ie.Th,{sort:l[Wt.EVENT]},"Event"),s.createElement(Ie.Th,{sort:l[Wt.APPLICATION]},"Application"),s.createElement(Ie.Th,{sort:l[Wt.BEHAVIOR],width:35},"Behavior"),s.createElement(Ie.Th,null))),s.createElement(Ie.Tbody,null,0===e.notifications.length?s.createElement($t,null):o))}));var Xt,en,tn=n(55490),nn=n(58399);!function(e){e.NAME="name",e.APPLICATION="application",e.ACTION="action"}(Xt||(Xt={})),function(e){e[e.NONE=0]="NONE",e[e.PAGE=1]="PAGE",e[e.ALL=2]="ALL"}(en||(en={}));const an=[Xt.NAME,Xt.APPLICATION,Xt.ACTION],ln=e=>{var t;const n=(0,i.getInsights)(),l=null!==(t=e.filterColumns)&&void 0!==t?t:an,o=(0,s.useMemo)((()=>{const t=e.appFilterOptions.map((e=>({value:e.displayName,label:s.createElement(s.Fragment,null," ",e.displayName)})));return{[Xt.NAME]:l.includes(Xt.NAME)?{label:"Event type",placeholder:"Filter by event type"}:void 0,[Xt.APPLICATION]:l.includes(Xt.APPLICATION)?{label:"Application",placeholder:"Filter by application",options:{exclusive:!1,default:[],items:t}}:void 0,[Xt.ACTION]:l.includes(Xt.ACTION)&&(0,nn.Zg)(n)?{label:"Action",placeholder:"Filter by action"}:void 0}}),[e.appFilterOptions,n,l]),r=s.useMemo((()=>{var t;const n=e.onSelectionChanged,a=e.count,l=e.pageAdapter,o=e.selectedCount,i=l.page.size;if(!n)return;const r=()=>n(en.ALL),s=()=>n(en.NONE);return{count:null!=o?o:0,items:[{title:"Select none (0)",onClick:s},{title:`Select page (${null!==(t=e.pageCount)&&void 0!==t?t:i})`,onClick:()=>n(en.PAGE)},{title:`Select all (${a})`,onClick:r}],checked:0!==o&&o===a,onSelect:e=>e?r():s(),isDisabled:e.bulkSelectionDisabled}}),[e.onSelectionChanged,e.selectedCount,e.pageAdapter,e.count,e.bulkSelectionDisabled,e.pageCount]),c=(0,i.usePrimaryToolbarFilterConfig)(Xt,e.filters,e.setFilters,e.clearFilter,o),u=(0,tn.B)(e.onExport),d=c.filterConfig,m=c.activeFiltersConfig,p=(0,i.useInsightsEnvironmentFlag)((0,i.getInsights)(),nn._n,void 0,(0,s.useCallback)((()=>u),[u])),E=s.useCallback(((t,n)=>{(0,e.pageAdapter.changePage)(n)}),[e.pageAdapter]),g=s.useCallback(((t,n)=>{(0,e.pageAdapter.changeItemsPerPage)(n)}),[e.pageAdapter]),v=s.useMemo((()=>({itemCount:e.count,page:e.pageAdapter.page.index,perPage:e.pageAdapter.page.size,isCompact:!0,variant:a.PaginationVariant.top,onSetPage:E,onFirstClick:E,onPreviousClick:E,onNextClick:E,onLastClick:E,onPageInput:E,onPerPageSelect:g})),[e.count,e.pageAdapter,E,g]),h=s.useMemo((()=>({...v,isCompact:!1,variant:a.PaginationVariant.bottom})),[v]);return s.createElement("div",{...(0,Xe.k)("Notifications/DualToolbar",e)},s.createElement(We.Z,{bulkSelect:r,filterConfig:d,activeFiltersConfig:m,exportConfig:p,pagination:v}),e.children,s.createElement(We.Z,{pagination:h}))},on=(e,t,n)=>{const a=((e,t,n=250)=>{const a=(0,s.useMemo)((()=>{const n=e=>(0,i.useUrlStateString)("name",e),a=t=>(0,i.useUrlStateMultipleOptions)("app",e,t),l=e=>(0,i.useUrlStateString)("action",e);return e=>{switch(e){case Xt.NAME:return t?n:s.useState;case Xt.ACTION:return t?l:s.useState;case Xt.APPLICATION:return t?a:s.useState;default:(0,ce.vE)(e)}}}),[]);return(0,i.useFilters)(Xt,n,a)})(t.map((e=>e.displayName.toString())),n),l=((e,t)=>(0,s.useCallback)((n=>{const a=new i.Filter,l=n&&n[Xt.APPLICATION];if(l){const e=[];for(const n of(0,i.arrayValue)(l)){const a=t.find((e=>e.displayName===n));a&&e.push(a.id)}a.and("applicationId",i.Operator.EQUAL,e)}a.and("bundleId",i.Operator.EQUAL,e.id);const o=n&&n[Xt.NAME];if(o){const e=(0,i.stringValue)(o);a.and("eventFilterName",i.Operator.EQUAL,e)}return a}),[e,t]))(e,t),[o,r]=s.useState({sortDirection:xt.ASC,sortBy:Wt.APPLICATION}),c=s.useCallback(((e,t)=>{r({sortBy:e,sortDirection:t})}),[r]),u=s.useMemo((()=>{const e=o.sortDirection.toUpperCase();let t;switch(o.sortBy){case Wt.APPLICATION:t="application";break;case Wt.EVENT:t="display_name";break;default:throw new Error(`Invalid sorting index: ${o.sortBy}`)}return i.Sort.by(t,e)}),[o]);return{pageController:(0,pt.q)(g.ZP.paging.defaultPerPage,l,a.filters,u),onSort:c,sortBy:o.sortBy,sortDirection:o.sortDirection,filters:a.filters,setFilters:a.setFilters,clearFilters:a.clearFilter}};var rn=n(64799),sn=n(36219),cn=n(36853);const un=n.p+"fonts/WebhookIcon.svg",dn=(0,u.style)({verticalAlign:"-0.125em",width:"1em",height:"1em"}),mn=()=>s.createElement("img",{alt:"Webhook",className:dn,src:un}),pn=e=>{switch(e.actionType){case Je.k$.DRAWER:return s.createElement(cn.ZP,null);case Je.k$.EMAIL_SUBSCRIPTION:return s.createElement(x.EnvelopeIcon,null);case Je.k$.INTEGRATION:return s.createElement(mn,null);default:(0,ce.vE)(e.actionType)}},En=e=>s.createElement("div",{...(0,Xe.k)("Notifications/ActionComponent",e)},e.children),gn=e=>e.loading?s.createElement(En,{...e},s.createElement(a.Spinner,{size:"md"})):e.hasError?s.createElement(En,{...e},s.createElement("span",null,"Error loading actions")):e.action?s.createElement(En,{...e},s.createElement(pn,{actionType:e.action.type}),s.createElement("span",{className:"pf-v5-u-ml-sm"},g.ZP.notifications.types[e.action.type].name),e.action.type===Je.k$.INTEGRATION&&s.createElement("span",null,": ",g.ZP.integrations.types[e.action.integration.type].name)):s.createElement(En,{...e},s.createElement("span",{className:"pf-v5-u-color-200"},s.createElement("div",null,"No actions."),s.createElement("div",null,"Users will not be notified.")));var vn=n(69696);const hn=e=>{const t="User Access group (Not found)";return s.createElement(a.Tooltip,{content:"This User Access group was not found, and may have been deleted. Remove it from your behavior group to stop seeing it."},e.onClose?s.createElement(a.Label,{variant:"outline",color:"red",onClose:e.onClose},t):s.createElement("span",{className:"pf-v5-u-color-300"}," ",t," "))},fn=()=>s.createElement("span",null,", "),yn=e=>{if(e.action.type===Je.k$.INTEGRATION)return s.createElement(s.Fragment,null,e.action.integration.isEnabled?e.action.integration.name:s.createElement("span",{className:"pf-v5-u-color-300"}," ",e.action.integration.name,s.createElement(a.Tooltip,{content:"This integration has been disabled. This action wil not fire until it is enabled.",position:"bottom"},s.createElement(x.BanIcon,{className:"pf-v5-u-color-300"}))));const t=e.action.recipient.filter((e=>e instanceof vn.dt)),n=e.action.recipient.filter((e=>e instanceof vn.nc));return s.createElement("span",null,t.length>0&&s.createElement("div",null,"Users:"," ",(0,i.join)(t.map((e=>s.createElement(s.Fragment,null,e.displayName,e.ignorePreferences&&s.createElement("span",null,s.createElement(a.Tooltip,{content:"You may still receive forced notifications for this service",position:"bottom"},s.createElement(x.LockIcon,{className:"pf-v5-u-ml-sm pf-v5-u-color-300"})))," "))),fn)),n.length>0&&s.createElement("div",null,"User Access Groups:"," ",(0,i.join)(n.map((e=>e.hasError?s.createElement(hn,{key:e.groupId}):e.isLoading?s.createElement(a.Skeleton,{width:"40px",key:e.groupId}):e.displayName)),fn)))},bn=e=>s.createElement(a.Grid,null,s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Action"))),s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Recipient"))),e.children),Cn=e=>s.createElement(bn,null,e.actions.map(((e,t)=>s.createElement(s.Fragment,{key:`${t}-${e.type}`},s.createElement(a.GridItem,{span:6},s.createElement(gn,{action:e})),s.createElement(a.GridItem,{className:"pf-u-text-break-word",span:6},s.createElement(yn,{action:e})))))),Tn=()=>{const e="150px";return s.createElement(bn,null,[...Array(3).values()].map(((t,n)=>s.createElement(s.Fragment,{key:`skeleton-${n}`},s.createElement(a.GridItem,{span:6},s.createElement(a.Skeleton,{width:e})),s.createElement(a.GridItem,{span:6},s.createElement(a.Skeleton,{width:e}))))))},Sn=e=>e.actions?s.createElement(Cn,{actions:e.actions}):s.createElement(Tn,null),kn=(0,u.style)({width:450,height:"100%"}),In=e=>{const[t,n]=s.useState(!1),l=s.useCallback((()=>n((e=>!e))),[n]);return s.createElement(a.Card,{isFlat:!0,className:kn},s.createElement(a.CardHeader,null,s.createElement(a.CardHeaderMain,null,s.createElement(a.Split,null,s.createElement(a.SplitItem,null,e.isDefaultBehavior&&s.createElement(a.Tooltip,{position:"top",appendTo:()=>document.body,content:s.createElement("div",null,"System required behavior group",s.createElement("br",null),s.createElement("br",null),"This group is system generated and can not be edited, deleted, or removed from being applied to an event")},s.createElement(x.LockIcon,{className:"pf-v5-u-mr-sm"}))),s.createElement(a.SplitItem,null,s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h4}," ",e.title," "))))),s.createElement(a.CardActions,null,!e.isDefaultBehavior&&s.createElement(a.Dropdown,{onSelect:l,toggle:s.createElement(a.KebabToggle,{onToggle:n,isDisabled:!e.dropdownItems}),isOpen:t,isPlain:!0,dropdownItems:e.dropdownItems,position:a.DropdownPosition.right,menuAppendTo:()=>document.body}))),s.createElement(a.CardBody,null,e.children))},Nn=e=>{const t=s.useCallback((()=>{const t=e.onEdit;t&&t(e.behaviorGroup)}),[e.behaviorGroup,e.onEdit]),n=s.useCallback((()=>{const t=e.onDelete;t&&t(e.behaviorGroup)}),[e.behaviorGroup,e.onDelete]),l=s.useMemo((()=>[s.createElement(a.DropdownItem,{key:"on-edit",onClick:t,isDisabled:!t}," ","Edit"," "),s.createElement(a.DropdownItem,{key:"on-delete",onClick:n,isDisabled:!n}," ","Delete"," ")]),[t,n]);return s.createElement(In,{title:e.behaviorGroup.displayName,dropdownItems:l,isDefaultBehavior:e.behaviorGroup.isDefault},s.createElement(Sn,{actions:e.behaviorGroup.actions}))},wn=()=>s.createElement(In,{title:s.createElement(a.Skeleton,{width:"300px"})},s.createElement(Sn,null)),An=e=>e.behaviorGroup?s.createElement(Nn,{...e,behaviorGroup:e.behaviorGroup}):s.createElement(wn,null),Dn=(0,u.style)({overflow:"auto"}),Ln=e=>s.createElement("div",{"data-testid":"ref-card-list-container"},s.createElement(a.Flex,{alignItems:{default:"alignItemsStretch"},alignContent:{default:"alignContentSpaceBetween"},flexWrap:{default:"nowrap"},className:Dn,"data-testid":"card-list-container"},e.children)),Pn=e=>s.createElement(Ln,null,e.behaviorGroups.map((t=>s.createElement(a.FlexItem,{key:t.id,className:"pf-v5-u-pb-md"},s.createElement(An,{behaviorGroup:t,onEdit:e.onEdit,onDelete:e.onDelete}))))),On=()=>s.createElement(Ln,null,[...Array(3).values()].map(((e,t)=>s.createElement(a.FlexItem,{key:`behavior-group-card-skeleton-${t}`,className:"pf-v5-u-pb-md"},s.createElement(An,null))))),Fn=e=>e.behaviorGroups?s.createElement(Pn,{...e,behaviorGroups:e.behaviorGroups}):s.createElement(On,null);var Rn=n(52857),xn=n(45871),Gn=n(92534);const Bn=e=>{var t;const n=s.useContext(a.WizardContext);return s.createElement(a.WizardFooter,null,s.createElement(a.Button,{variant:a.ButtonVariant.primary,type:"submit",onClick:()=>{e.onNext(n.onNext)},isDisabled:e.isLoading||!n.activeStep.enableNext},null!==(t=n.activeStep.nextButtonText)&&void 0!==t?t:"Next"),!n.activeStep.hideBackButton&&s.createElement(a.Button,{variant:a.ButtonVariant.secondary,onClick:()=>{e.onBack(n.onBack)},isDisabled:0===n.activeStep.id||e.isLoading},"Back"),!n.activeStep.hideCancelButton&&s.createElement(a.Button,{variant:a.ButtonVariant.link,onClick:n.onClose,isDisabled:e.isLoading},"Cancel"),e.isLoading?s.createElement("div",{className:"pf-v5-u-mt-auto pf-v5-u-mb-md"},s.createElement(a.Spinner,{size:"md"})):e.error&&s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.Icon,{status:"danger",className:"pf-v5-u-mr-xs"},s.createElement(x.ExclamationCircleIcon,null))),s.createElement(a.SplitItem,null,e.error)))},Mn=e=>{const{values:t}=(0,Gn.useFormikContext)(),n=(t.id?"Edit":"Create")+" behavior group";return s.createElement(Gn.Form,null,s.createElement(a.Wizard,{title:n,steps:e.steps,footer:s.createElement(Bn,{isLoading:e.loading,onNext:e.onNext,onBack:e.onBack}),isOpen:!0,startAtStep:1,onGoToStep:t=>{var n;return e.onGoToStep(null!==(n=t.id)&&void 0!==n?n:1)},onClose:e.onClose,onSave:e.onSave}))},_n=(0,s.createContext)({getIntegrations:async()=>{throw new Error("No IntegrationContext found")},getNotificationRecipients:async()=>{throw new Error("No RecipientContext found")}}),Un=()=>(0,s.useContext)(_n),Zn=_n.Provider;var Vn,$n=n(45093),Hn=n(81952),qn=n(21503),zn=n(21551);!function(e){e[e.CREATE=0]="CREATE",e[e.UPDATE=1]="UPDATE"}(Vn||(Vn={}));var Yn=n(37176);class Wn{constructor(e){this.recipient=e}compareTo(e){return e instanceof Wn&&this.recipient.equals(e.recipient)}toString(){return this.recipient.displayName}}const Qn=(e,t,n,l)=>n?l?l():[s.createElement(a.SelectOption,{key:"loading-option",isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"}))]:t(e),jn=(e,t,n)=>s.useMemo((()=>"default"===e.show?Qn(e.defaultValues,t,e.loadingDefault,n):"filter"===e.show?Qn(e.filterValues,t,e.loadingFilter,n):void(0,ce.ZP)(e.show)),[e,t,n]);var Kn,Jn=n(62554);!function(e){e[e.LOAD_FILTER_VALUE=0]="LOAD_FILTER_VALUE",e[e.SET_FILTER_VALUE=1]="SET_FILTER_VALUE",e[e.USE_DEFAULTS=2]="USE_DEFAULTS",e[e.SET_DEFAULTS=3]="SET_DEFAULTS"}(Kn||(Kn={}));const Xn=(e,t)=>(0,fe.ZP)(e,(n=>{switch(t.type){case Kn.SET_FILTER_VALUE:t.search===e.lastSearch&&t.values!==n.filterValues&&(n.loadingFilter=!1,n.filterValues=(0,fe.cA)(t.values));break;case Kn.LOAD_FILTER_VALUE:t.search===n.lastSearch&&"filter"===n.show||(n.loadingFilter=!0,n.filterValues=[],n.lastSearch=t.search,n.show="filter");break;case Kn.USE_DEFAULTS:"default"!==n.show&&(n.show="default");break;case Kn.SET_DEFAULTS:n.defaultValues=(0,fe.cA)(t.values),n.loadingDefault=!1;break;default:(0,ce.ZP)(t)}})),ea=()=>{const[e,t]=(0,s.useReducer)(Xn,{filterValues:[],defaultValues:[],show:"default",loadingFilter:!1,loadingDefault:!0,lastSearch:""}),[n,a]=(0,s.useState)(e);(0,Jn.Z)((()=>{a(e)}),400,[e]);const l=(0,s.useCallback)(((e,n)=>t({type:Kn.SET_FILTER_VALUE,values:n,search:e})),[t]),o=(0,s.useCallback)((e=>t({type:Kn.LOAD_FILTER_VALUE,search:e})),[t]),i=(0,s.useCallback)((e=>t({type:Kn.SET_DEFAULTS,values:e})),[t]),r=(0,s.useCallback)((()=>t({type:Kn.USE_DEFAULTS})),[t]);return[n,(0,s.useMemo)((()=>({setFilterValue:l,loadFilterValue:o,setDefaults:i,useDefaults:r})),[l,o,i,r])]},ta=e=>{const[t,n]=s.useState(!1),l=(0,Yn.Z)(t),{getIntegrations:o}=Un(),{values:i}=(0,Gn.useFormikContext)(),[r,c]=ea(),u=s.useCallback((e=>{n(e)}),[n]);s.useEffect((()=>{const n=e.onOpenChange;void 0!==l&&l!==t&&n&&n(t)}),[l,t,e.onOpenChange]),s.useEffect((()=>{o(e.integrationType,"").then((e=>{const t=e.map((e=>new vn.YO(e)));c.setDefaults(t)}))}),[o,e.integrationType,c]),s.useEffect((()=>{r.loadingFilter&&o(e.integrationType,r.lastSearch).then((e=>c.setFilterValue(r.lastSearch,e.map((e=>new vn.YO(e))))))}),[o,e.integrationType,r.loadingFilter,r.lastSearch,c]);const d=s.useMemo((()=>{var e;const t=(null!==(e=i.actions)&&void 0!==e?e:[]).filter((e=>(null==e?void 0:e.type)===Je.k$.INTEGRATION)).map((e=>{var t;return null===(t=e)||void 0===t?void 0:t.integration.id}));return new Set(t)}),[i]),m=s.useCallback((e=>e.map((e=>{const t=null==d?void 0:d.has(e.integration.id);return s.createElement(a.SelectOption,{key:e.getKey(),value:new Wn(e),description:t?"This integration has already been added":void 0,isDisabled:t})}))),[d]),p=jn(r,m),E=s.useCallback((e=>{var t;if(null===e)return p;const n=null===(t=e.target.value)||void 0===t?void 0:t.trim();return""===n?c.useDefaults():c.loadFilterValue(n),p}),[c,p]),v=s.useMemo((()=>{const t=e.selected;if(void 0!==t&&void 0!==t.name&&void 0!==t.id&&void 0!==t.type)return new Wn(new vn.YO(t))}),[e.selected]),h=s.useCallback(((t,a)=>{const l=e.onSelected;a instanceof Wn&&(l(a),n(!1))}),[e.onSelected]),f=`Choose ${g.ZP.integrations.types[e.integrationType].name.toLowerCase()}`;return s.createElement("div",{...(0,Xe.k)("IntegrationRecipientTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.typeahead,typeAheadAriaLabel:f,placeholderText:f,selections:v,onSelect:h,onToggle:u,isOpen:t,onFilter:E,menuAppendTo:document.body,isDisabled:e.isDisabled,validated:e.error?"error":void 0},p))},na="groups",aa="User Access Groups",la=(e,t,n)=>n.length>0?s.createElement(a.SelectGroup,{key:e,label:t},n.map((e=>e instanceof vn.nc&&e.isLoading?s.createElement(a.SelectOption,{key:e.getKey(),isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"})):s.createElement(a.SelectOption,{key:e.getKey(),value:new Wn(e),description:e.description})))):s.createElement(s.Fragment,{key:e}),oa=e=>[la(na,aa,e)],ia=()=>[s.createElement(a.SelectGroup,{key:na,label:aa},s.createElement(a.SelectOption,{key:"loading-group",isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"})))],ra=[la("users","Users",[new vn.dt(void 0,!1,!1),new vn.dt(void 0,!0,!1)])],sa=e=>{const[t,n]=s.useState(!1),[l,o]=ea(),i=(0,Yn.Z)(t),{getNotificationRecipients:r}=Un();s.useEffect((()=>{r().then((e=>o.setDefaults(e)))}),[r,o]),s.useEffect((()=>{l.loadingFilter&&r().then((e=>o.setFilterValue(l.lastSearch,e)))}),[r,l.loadingFilter,l.lastSearch,o]);const c=s.useCallback((e=>{n(e)}),[n]);s.useEffect((()=>{const n=e.onOpenChange;void 0!==i&&i!==t&&n&&n(t)}),[i,t,e.onOpenChange]);const u=jn(l,oa,ia),d=s.useMemo((()=>[...ra,...u]),[u]),m=s.useMemo((()=>{const t=e.selected;if(void 0!==t)return t.map((e=>new Wn(e)))}),[e.selected]),p=s.useCallback(((t,n)=>{const a=e.onSelected;n instanceof Wn&&a(n)}),[e.onSelected]),E=s.useMemo((()=>null==m?void 0:m.map((e=>{const t=e=>t=>{t.stopPropagation(),p(t,e)},n=e.recipient.getKey();if(e.recipient instanceof vn.nc){if(e.recipient.isLoading)return s.createElement(a.Chip,{key:n,onClick:t(e)},s.createElement(a.Skeleton,{"data-testid":"loading-group",width:"40px"}));if(e.recipient.hasError)return s.createElement(hn,{key:n,onClose:t(e)})}return s.createElement(a.Chip,{onClick:t(e),key:n},e.recipient.displayName)}))),[m,p]);return s.createElement("div",{...(0,Xe.k)("RecipientTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.checkbox,selections:m,onSelect:p,onToggle:c,isOpen:t,menuAppendTo:document.body,isDisabled:e.isDisabled,onClear:e.onClear,validated:e.error?"error":void 0,isGrouped:!0,isCheckboxSelectionBadgeHidden:!0,isInputValuePersisted:!0,placeholderText:s.createElement(a.ChipGroup,null,E)},d))},ca=()=>!1,ua=e=>{var t,n;let l;return l=e.action?e.action.type===Je.k$.INTEGRATION?s.createElement(ta,{onSelected:e.integrationSelected,integrationType:null!==(n=null===(t=e.action.integration)||void 0===t?void 0:t.type)&&void 0!==n?n:te.WN.WEBHOOK,selected:e.action.integration,onOpenChange:e.onOpenChange,error:!!e.error}):s.createElement(sa,{onSelected:e.recipientSelected,selected:e.action.recipient,onClear:e.recipientOnClear,onOpenChange:e.onOpenChange,error:!!e.error}):s.createElement("div",null,s.createElement(a.Select,{variant:a.SelectVariant.typeahead,isDisabled:!0,onToggle:ca,isOpen:!1})),s.createElement(s.Fragment,null," ",l,e.error&&s.createElement(a.FormHelperText,{isError:!0,isHidden:!e.error},e.error))};class da{constructor(e){"integration"===e.kind?(this.notificationType=Je.k$.INTEGRATION,this.integrationType=e.type):(this.notificationType=e.type,this.integrationType=void 0)}compareTo(e){return e instanceof da&&e.notificationType===this.notificationType&&e.integrationType===this.integrationType}toString(){const e=g.ZP.notifications.types[this.notificationType].name;return this.integrationType?`${e}: ${g.ZP.integrations.types[this.integrationType].name}`:e}}const ma=e=>s.createElement(s.Fragment,null,s.createElement("div",null,"You have no integration configured."),s.createElement("div",null,"Go to Settings ",">"," ",s.createElement(p.Link,{style:{pointerEvents:"all"},rel:e.testNoIntegrationRenderWithoutRelAndTarget?void 0:"noopener noreferrer",target:e.testNoIntegrationRenderWithoutRelAndTarget?void 0:"_blank",to:Fl.integrations()},"Integrations")," ","to configure.")),pa=e=>{const[t,n]=s.useState(!1),{getIntegrations:l}=Un(),[o,i]=s.useState(Object.values(te.j3).reduce(((e,t)=>(e[t]=!0,e)),{}));s.useEffect((()=>{Object.values(te.j3).forEach((async e=>{const t=await l(e);i((0,fe.ZP)((n=>{n[e]=t.length>0})))}))}),[l]);const r=s.useCallback((e=>{n(e)}),[n]),c=s.useCallback(((t,a)=>{const l=e.onSelected;a instanceof da&&(l(a),n(!1))}),[e.onSelected,n]),u=s.useMemo((()=>{if(e.action)return e.action.type===Je.k$.INTEGRATION?new da({kind:"integration",type:e.action.integration.type}):new da({kind:"notification",type:e.action.type})}),[e.action]),d=(0,Qe.N)(),m=je(),p=s.useMemo((()=>{return(t=m,n=d,l=e.selectedNotifications,[...t.filter((e=>!l.includes(e))).map((e=>new da({kind:"notification",type:e}))),...n.map((e=>new da({kind:"integration",type:e})))]).map((t=>{const n=(0,te.F8)(t.integrationType)&&!o[t.integrationType];return s.createElement(a.SelectOption,{isDisabled:n,key:t.toString(),value:t,description:n&&s.createElement(ma,{testNoIntegrationRenderWithoutRelAndTarget:e.testNoIntegrationRenderWithoutRelAndTarget})})}));var t,n,l}),[m,d,e.selectedNotifications,o,e.testNoIntegrationRenderWithoutRelAndTarget]);return s.createElement("div",{...(0,Xe.k)("ActionTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.single,"aria-label":"Select action",placeholderText:"Select action",selections:u,onToggle:r,isOpen:t,onSelect:c,menuAppendTo:document.body,isDisabled:e.isDisabled},p))};(0,u.cssRaw)("\n    @media only screen and (max-width: 768px) {\n        .pf-c-select .pf-c-select__toggle-typeahead {\n            --pf-c-select__toggle-typeahead--FlexBasis: 0;\n        }\n    }\n");const Ea=(0,u.style)({$nest:{"& tr":{borderBottom:(0,me.important)(0)},"& th:first-child":{paddingLeft:(0,me.important)(0)},"& th:last-child, & td:last-child":{paddingRight:(0,me.important)(0)}}}),ga=(0,u.style)({$nest:{"& td:first-child":{paddingLeft:(0,me.important)(0)},"& td:last-child":{paddingRight:(0,me.important)(0)},"& td":{verticalAlign:(0,me.important)("top")}}}),va=(0,u.style)({textAlign:"left",paddingLeft:0}),ha=[{title:"Actions",transforms:[(0,Ie.cellWidth)(50)]},{title:"Recipient"}],fa=()=>s.createElement("span",null),ya=e=>{const{values:t,setValues:n,errors:l,touched:o,setFieldTouched:i}=e.form,r=s.useMemo((()=>{var e;return null!==(e=t.actions)&&void 0!==e?e:[]}),[t]),c=s.useMemo((()=>{var e;return null!==(e=null==o?void 0:o.actions)&&void 0!==e?e:[]}),[o]),u=s.useMemo((()=>{var e;return null!==(e=null==l?void 0:l.actions)&&void 0!==e?e:[]}),[l]),d=s.useMemo((()=>new Array(...new Set(r.filter((e=>e)).map((e=>e.type))))),[r]),m=s.useCallback((e=>{n((0,fe.ZP)((t=>{const n=t;n.actions=e instanceof Function?(0,fe.cA)(e(n.actions)):(0,fe.cA)(e)})),!1)}),[n]),p=s.useCallback((()=>{(0,e.push)(void 0)}),[e.push]);s.useEffect((()=>{0===r.length&&p()}),[r,p]);const E=(g=m,{handleActionSelected:(0,s.useCallback)((e=>t=>{g((0,fe.ZP)((n=>{n[e]||(n[e]={});const a=n[e];a.type=t.notificationType,t.integrationType?a.integration={type:t.integrationType}:a.recipient=[]})))}),[g]),handleIntegrationSelected:(0,s.useCallback)((e=>t=>{g((0,fe.ZP)((n=>{t.recipient instanceof vn.YO&&(n[e].integration=t.recipient.integration)})))}),[g]),handleRecipientSelected:(0,s.useCallback)((e=>t=>{g((0,fe.ZP)((n=>{const a=n[e];if(a.type!==Je.k$.INTEGRATION){const e=a,n=(0,fe.Js)(e.recipient);if(n){const a=n.findIndex((e=>t.recipient.equals(e)));-1===a?e.recipient.push((0,fe.cA)(t.recipient)):e.recipient.splice(a,1)}}})))}),[g]),handleRecipientOnClear:(0,s.useCallback)((e=>()=>{g((0,fe.ZP)((t=>{const n=t[e];n.type!==Je.k$.INTEGRATION&&(n.recipient=[])})))}),[g])});var g;const v=s.useMemo((()=>((e,t,n,a,l,o)=>e.map(((e,i)=>{var r,c;let u,d,m=!1;return d=(null==e?void 0:e.type)===Je.k$.INTEGRATION?`actions.${i}.integration`:`actions.${i}.recipient`,(null==e?void 0:e.type)===Je.k$.INTEGRATION&&((null===(r=n[i])||void 0===r?void 0:r.integration)&&(m=!0),m&&(null===(c=t[i])||void 0===c?void 0:c.integration)&&(u="Select a recipient for this integration.")),!u&&m&&o(d,!1,!1),{id:i,key:i,cells:[{title:s.createElement(pa,{selectedNotifications:a,action:e,onSelected:l.handleActionSelected(i)})},{title:s.createElement(ua,{action:e,integrationSelected:l.handleIntegrationSelected(i),recipientSelected:l.handleRecipientSelected(i),recipientOnClear:l.handleRecipientOnClear(i),error:u,onOpenChange:e=>{e||o(d,!0,!1)}})}]}})))(r,u,c,d,E,i)),[r,u,c,d,E,i]),h=s.useCallback((t=>{const n=e.handleRemove;return v.length>1?[{key:"delete",title:s.createElement(a.Button,{"aria-label":"delete-action",variant:a.ButtonVariant.plain},s.createElement(x.MinusCircleIcon,null)),isOutsideDropdown:!0,onClick:n(t.id)}]:[]}),[v,e.handleRemove]);return s.createElement(s.Fragment,null,s.createElement(Ie.Table,{"aria-label":"behavior-group-actions-form",rows:v,cells:ha,actionResolver:h,actionsToggle:fa,borders:!1,variant:Ie.TableVariant.compact,isStickyHeader:!0},s.createElement(Ie.TableHeader,{className:Ea}),s.createElement(Ie.TableBody,{className:ga})),s.createElement(a.GridItem,{span:12},s.createElement(a.Button,{className:va,variant:a.ButtonVariant.link,icon:s.createElement(x.PlusCircleIcon,null),onClick:p},"Add action")))},ba=e=>s.createElement("div",{...(0,Xe.k)("Notifications/BehaviorGroupForm",e)},s.createElement(a.Grid,{hasGutter:!0},s.createElement(Gn.FieldArray,{name:"actions"},(e=>s.createElement(s.Fragment,null,s.createElement(ya,{...e})))))),Ca=Z.Ry({type:Z.nK().oneOf([Je.k$.INTEGRATION]).required(),integration:Z.Ry({id:Z.Z_().required()}).required(),integrationId:Z.Z_().min(1)}),Ta=Z.Ry({type:Z.nK().oneOf([Je.k$.EMAIL_SUBSCRIPTION,Je.k$.DRAWER]).required(),recipient:Z.IX(Z.Ry()).min(1),integrationId:Z.Z_().min(0)}),Sa=Z.IX(Z.Vo((e=>e&&e.hasOwnProperty("type")&&e.type===Je.k$.INTEGRATION?Ca:Ta))).test("no-repeated","${path} can't contain repeated actions",((e,t)=>{const n=[];let a=!1;const l=[];if(!e)return!0;for(let o=0;o<e.length;++o){const i=e[o],r=i.integrationId;i.type===Je.k$.EMAIL_SUBSCRIPTION?(a&&n.push(t.createError({message:"Only 1 send email action is allowed",path:`actions.${o}`})),a=!0):r&&(l.includes(r)?n.push(t.createError({message:"Integration already used in the group, please select other",path:`actions.${o}`})):l.push(r))}return 0===n.length||{...t.createError(),inner:n}})),ka=(Z.Ry({actions:Sa}),Z.Ry({displayName:Z.Z_().required("You must specify a name for the behavior group"),actions:Sa}),"Actions and recipients"),Ia=()=>{const{values:e}=(0,Gn.useFormikContext)();return s.createElement(i.Form,null,s.createElement("div",null,s.createElement(a.Title,{headingLevel:"h4",size:"xl"},ka),s.createElement(a.TextContent,{className:"pf-v5-u-pt-sm"},s.createElement(a.Text,null,"Select action and recipient pairs to assign to your notification events.")),s.createElement(ba,{behaviorGroup:e})))},Na=Z.Ry({actions:Sa}),wa=e=>s.createElement(Ie.TableComposable,{variant:Ie.TableVariant.compact},s.createElement(Ie.Thead,null,s.createElement(Ie.Tr,null,s.createElement(Ie.Th,null),s.createElement(Ie.Th,null,"Event type"),s.createElement(Ie.Th,null,"Application"))),s.createElement(Ie.Tbody,null,e.children)),Aa=()=>s.createElement(wa,null,[...Array(10)].map(((e,t)=>s.createElement(Ie.Tr,{key:t},s.createElement(Ie.Td,{select:{isSelected:!1,rowIndex:t,disable:!0}}),s.createElement(Ie.Td,null,s.createElement(a.Skeleton,{width:"80%"})),s.createElement(Ie.Td,null,s.createElement(a.Skeleton,{width:"80%"})))))),Da=e=>s.createElement(wa,null,e.events.map(((t,n)=>s.createElement(Ie.Tr,{key:t.id},s.createElement(Ie.Td,{modifier:e.selectionLoading?"fitContent":void 0,noPadding:e.selectionLoading,select:e.selectionLoading?void 0:{rowIndex:n,onSelect:(n,a)=>e.onSelect&&e.onSelect(a,t),isSelected:t.isSelected,disable:e.selectionLoading}},e.selectionLoading&&s.createElement(a.Spinner,{size:"sm"})),s.createElement(Ie.Td,null,t.eventTypeDisplayName),s.createElement(Ie.Td,null,t.applicationDisplayName))))),La=e=>e.events?s.createElement(Da,{...e,events:e.events}):s.createElement(Aa,null),Pa="Associate event types",Oa=e=>{const{setValues:t,values:n}=(0,Gn.useFormikContext)(),[l,o]=s.useState((()=>{const e={};return n.events.forEach((t=>{e[t.id]=t})),e})),r=on(e.bundle,e.applications,!1),c=z(r.pageController.page),u=(0,i.useTransformQueryResponse)((0,T.useParameterizedQuery)(H),q);(0,s.useEffect)((()=>{t((0,fe.ZP)((e=>{e.events=Object.values(l)})))}),[t,l]);const d=s.useMemo((()=>{const e=c.payload;return 200===(null==e?void 0:e.status)?e.value.meta.count:0}),[c.payload]),m=s.useMemo((()=>{var e;return"eventTypesArray"===(null===(e=c.payload)||void 0===e?void 0:e.type)?c.payload.value.data.map((e=>({...e,isSelected:Object.keys(l).includes(e.id)}))):[]}),[c.payload,l]),p=s.useCallback(((e,t)=>{o((0,fe.ZP)((n=>{e?n[t.id]=t:delete n[t.id]})))}),[o]),E=s.useCallback((e=>{const t=r.pageController.page;switch(e){case en.ALL:if(d===m.length)return o((0,fe.ZP)((e=>{m.forEach((t=>{e[t.id]=t}))})));(async()=>{var e;let n=1;const a={},l=i.Page.lastPageForElements(d,t.size);for(;;){const o=t.withPage(n);if(o.index>l.index)break;if(t.index===o.index)m.forEach((e=>{a[e.id]=e}));else{const l=await u.query(t.withPage(n));if("eventTypesArray"!==(null===(e=l.payload)||void 0===e?void 0:e.type))break;l.payload.value.data.forEach((e=>{a[e.id]=e}))}n++}o((0,fe.ZP)((e=>{for(const t of Object.values(a))e[t.id]=t})))})();break;case en.PAGE:o((0,fe.ZP)((e=>{m.forEach((t=>{e[t.id]=t}))})));break;case en.NONE:o({})}}),[o,m,u,r.pageController.page,d]);return s.createElement(i.Form,null,s.createElement("div",null,s.createElement(a.Title,{headingLevel:"h4",size:"xl"},Pa),s.createElement(a.TextContent,{className:"pf-v5-u-pt-sm"},s.createElement(a.Text,null,"Select event types you would like to assign this behavior group to."))),s.createElement(ln,{filters:r.filters,setFilters:r.setFilters,clearFilter:r.clearFilters,appFilterOptions:e.applications,pageAdapter:r.pageController,count:d,pageCount:m.length,onSelectionChanged:E,selectedCount:Object.keys(l).length,bulkSelectionDisabled:u.loading},s.createElement(La,{onSelect:p,events:c.loading?void 0:m,selectionLoading:u.loading})))},Fa="Name",Ra=()=>s.createElement(i.Form,{ouiaId:"basic-information-step"},s.createElement(a.Title,{headingLevel:"h4",size:"xl"},Fa),s.createElement(i.FormTextInput,{ouiaId:"name",id:"name",name:"displayName",label:"Behavior group name",isRequired:!0})),xa=Z.Ry({displayName:Z.Z_().min(1).max(150,"Must be 150 characters or less").required("Behavior group name is required")}),Ga="Review",Ba=e=>s.createElement(a.Grid,null,s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Event type"))),s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Application"))),e.events.map((e=>s.createElement(s.Fragment,{key:e.id},s.createElement(a.GridItem,{span:6},e.eventTypeDisplayName),s.createElement(a.GridItem,{span:6},e.applicationDisplayName))))),Ma=()=>{const{values:e}=(0,Gn.useFormikContext)();return s.createElement(i.Form,{ouiaId:"review-step"},s.createElement(a.Title,{headingLevel:"h2",size:"xl"},Ga),s.createElement(a.DescriptionList,{isHorizontal:!0},s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null,"Name"),s.createElement(a.DescriptionListDescription,null," ",e.displayName)),s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null," Actions and recipients"),s.createElement(a.DescriptionListDescription,null,s.createElement(Sn,{actions:e.actions}))),s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null,"Associate event types"),s.createElement(a.DescriptionListDescription,null,s.createElement(Ba,{events:e.events})))))},_a=()=>{},Ua=e=>{const[t,n]=s.useState(0),{isValid:a,validateForm:l}=(0,Gn.useFormikContext)(),o=(e=>{const t=J(),{query:n}=(0,s.useContext)(T.ClientContext),[a,l]=(0,s.useState)(!1);return{save:(0,s.useCallback)((async a=>{var o,i,r,s;const c=t.mutate;let u=!1,d=!1,m=!1;void 0===a.id&&(u=!0,d=!0),a.displayName!==(null==e?void 0:e.displayName)&&(u=!0);const p=[...null!==(o=null==e?void 0:e.events)&&void 0!==o?o:[]].sort(),E=[...null!==(i=a.events)&&void 0!==i?i:[]].sort();p.length===E.length&&p.every(((e,t)=>e===E[t]))||(m=!0),(0,Je.VL)(null!==(r=null==e?void 0:e.actions)&&void 0!==r?r:[],null!==(s=a.actions)&&void 0!==s?s:[])||(d=!0);const g=(0,zn.uniqWith)([].concat(...a.actions.filter(Je.Yh).map((e=>(0,fe.ZP)(e,(e=>{e.recipient=e.recipient.filter((e=>!e.integrationId))})))).map((e=>(0,$.OO)(e)))),zn.isEqual);if(g.find((e=>![Je.k$.EMAIL_SUBSCRIPTION,Je.k$.DRAWER].includes(e.type))))throw new Error("Only email and drawer subscriptions are created when assigning behavior groups");g.length>0&&l(!0);const v=await Promise.all(g.map((e=>{return n((t=e,(0,Je.K4)(t)?Ct.B.EndpointResourceGetOrCreateEmailSubscriptionEndpoint.actionCreator({body:{only_admins:t.props.onlyAdmins,group_id:t.props.groupId}}):(0,Je.L6)(t)?Ct.B.EndpointResourceGetOrCreateDrawerSubscriptionEndpoint.actionCreator({body:{only_admins:t.props.onlyAdmins,group_id:t.props.groupId}}):void(0,ce.ZP)(t))).then((e=>{var t;return"Endpoint"===(null===(t=e.payload)||void 0===t?void 0:t.type)?e.payload.value.id:void 0}));var t}))).then((e=>{if(e.includes(void 0))throw new Error("Unexpected ids were returned when querying for system endpoints");const t=[...e];return((e,t)=>{const n=t?[...t]:void 0;return e.reduce(((a,l)=>{if((0,Je.Yh)(l))l.recipient.forEach((l=>{if(l.integrationId)a.push(l.integrationId);else if(void 0===n)a.push(void 0);else{if(!(n.length>0))throw new Error(`No more ids remaining to assign: actions ${e} newIds: ${t}`);a.push(n.shift())}}));else{if(!(0,Je._f)(l))throw new Error(`Unknown action type: ${l}`);a.push(l.integration.id)}return a}),[])})(a.actions,t)})),h={...a,displayName:u?a.displayName:void 0,endpointIds:d?v:void 0,eventTypesIds:m?a.events.map((e=>e.id)):void 0};return u||d||m?c(h).then((e=>{var t;return{operation:void 0===a.id?Vn.CREATE:Vn.UPDATE,status:200===(null===(t=e.payload)||void 0===t?void 0:t.status)}})).catch((()=>({operation:void 0===a.id?Vn.CREATE:Vn.UPDATE,status:!1}))):{operation:void 0===a.id?Vn.CREATE:Vn.UPDATE,status:!0}}),[t.mutate,n,e]),isSaving:(0,s.useMemo)((()=>t.loading||a),[t.loading,a])}})(e.behaviorGroup),{values:i}=(0,Gn.useFormikContext)(),{addDangerNotification:r,addSuccessNotification:c}=(0,qn.l)(),u=((e,t,n,a)=>{const l=s.useMemo((()=>({name:Fa,component:s.createElement(Ra,null),schema:xa})),[]),o=(({applications:e,bundle:t})=>s.useMemo((()=>({name:Pa,component:s.createElement(Oa,{applications:e,bundle:t})})),[e,t]))(e),i=s.useMemo((()=>({name:ka,component:s.createElement(Ia,null),schema:Na})),[]),[r,c]=(0,s.useState)(0),[u,d]=(0,s.useState)((()=>new Set));(0,s.useEffect)((()=>{c((e=>Math.max(t,e)))}),[t]),(0,s.useEffect)((()=>{d((0,fe.ZP)((e=>{n?e.delete(t):e.add(t)})))}),[t,n]);const m=0===u.size?r:Math.min(...Array.from(u));return(0,s.useMemo)((()=>[l,i,o,{name:Ga,component:s.createElement(Ma,null),nextButtonText:"Finish"}].map(((e,t)=>({...e,id:t,canJumpTo:!a&&t<=m,hideCancelButton:!1,enableNext:n})))),[l,i,n,m,a,o])})({bundle:e.bundle,applications:e.applications},t,a,o.isSaving),d=u[t],m=null==d?void 0:d.schema;s.useEffect((()=>{e.setValidationSchema(m)}),[t]),s.useEffect((()=>{l()}),[e.validationSchema,l]);const p=s.useCallback((async()=>{const t=e.onClose,n=o.save,a={...i,bundleId:e.bundle.id},l=await n(a);l.status?(l.operation===Vn.CREATE?c("New behavior group created",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null," ",a.displayName," ")," created successfully.")):c("Behavior group saved",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null," ",a.displayName," ")," was saved successfully.")),t(!0)):l.operation===Vn.CREATE?r("Behavior group failed to be created",s.createElement(s.Fragment,null,"Failed to create group ",s.createElement("b",null," ",a.displayName),".",s.createElement("br",null),"Please try again.")):r("Behavior group failed to save",s.createElement(s.Fragment,null,"Failed to save group ",s.createElement("b",null," ",a.displayName),".",s.createElement("br",null),"Please try again."))}),[i,o.save,e.bundle,e.onClose,r,c]);return s.createElement(Mn,{steps:u,onNext:async e=>{let t=!0;(null==d?void 0:d.isValid)&&(t=await d.isValid()),t&&(n((e=>Math.min(e+1,u.length))),e())},onBack:async e=>{n((e=>e-1)),e()},onGoToStep:n,loading:o.isSaving,onClose:()=>{e.onClose(!1)},onSave:p})},Za=e=>{var t;const n=(()=>{const e=(0,Hn.P)();return(0,s.useCallback)((async()=>e.groups.map((e=>new vn.nc(void 0,e.id,e.name)))),[e])})(),a=(()=>{const{query:e}=(0,s.useContext)(T.ClientContext);return s.useCallback((async(t,n)=>e((0,$n.Kr)(i.Page.of(1,20,(new i.Filter).and("type",i.Operator.EQUAL,[t]).and("name",i.Operator.EQUAL,null!=n?n:"")))).then((e=>{let t=[];const n=e.payload?(0,$n.us)(e.payload):void 0;return"IntegrationPage"===(null==n?void 0:n.type)&&(t=n.value.data),t}))),[e])})(),l=s.useMemo((()=>({getIntegrations:a,getNotificationRecipients:n})),[a,n]),[o,r]=s.useState();return s.createElement(Zn,{value:l},s.createElement(Gn.Formik,{validateOnMount:!0,onSubmit:_a,initialValues:null!==(t=e.behaviorGroup)&&void 0!==t?t:{actions:[],events:[],displayName:void 0},validationSchema:o,validateOnBlur:!0,validateOnChange:!0},s.createElement(Ua,{...e,validationSchema:o,setValidationSchema:r})))},Va=e=>{const t=((e,t)=>(0,s.useCallback)((()=>e(t)),[e,t]))(e.onDelete,e.behaviorGroup),n=s.useMemo((()=>0===e.conflictingNotifications.length?"Cancel":"Close"),[e.conflictingNotifications]),l=s.useMemo((()=>0===e.conflictingNotifications.length?a.ButtonVariant.link:a.ButtonVariant.secondary),[e.conflictingNotifications]),[o,r]=s.useState(!1),c=s.useMemo((()=>{if(0===e.conflictingNotifications.length)return s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,"Action and recipient pairings assigned in"," ",s.createElement("b",null,e.behaviorGroup.displayName)," will lost. You will no longer be able to assign this behavior group to events."),s.createElement(a.StackItem,null,s.createElement(a.Checkbox,{id:"checkbox-delete-i-acknowledge",label:"I acknowledge that this action cannot be undone",onChange:r,isChecked:o})));{const t=e.conflictingNotifications;return s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,"You will no longer be able to assign"," ",s.createElement("b",null,e.behaviorGroup.displayName)," to events, and existing associations to events listed below will be removed."),s.createElement(a.StackItem,null,s.createElement(a.ExpandableSection,{toggleText:`View ${t.length} event${0===t.length?"":"s"}`},s.createElement(a.List,null,t.map((e=>s.createElement(a.ListItem,{key:e.id},`${e.applicationDisplayName} - ${e.eventTypeDisplayName}`)))))),s.createElement(a.StackItem,null,s.createElement(a.Checkbox,{id:"checkbox-delete-i-acknowledge",label:"I acknowledge that this action cannot be undone",onChange:r,isChecked:o})))}}),[e.conflictingNotifications,e.behaviorGroup,o,r]);return s.createElement(i.DeleteModal,{isOpen:!0,isDeleting:e.isDeleting,title:"Delete behavior group",content:c,onClose:e.onClose,onDelete:t,error:e.error,titleIconVariant:"warning",actionButtonDisabled:!o,cancelButtonTitle:n,cancelButtonVariant:l})},$a=()=>!1,Ha=e=>s.createElement(i.DeleteModal,{isOpen:!0,title:"Delete behavior group",actionButtonDisabled:!0,titleIconVariant:"warning",content:s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,s.createElement(a.Skeleton,{width:"500px"})),s.createElement(a.StackItem,null,s.createElement(a.Skeleton,{width:"500px"}))),onClose:e.onClose,isDeleting:!1,onDelete:$a}),qa=e=>S.B.NotificationResourceDeleteBehaviorGroup.actionCreator({id:e}),za=(0,V.validationResponseTransformer)((e=>200===e.status?(0,V.validatedResponse)("Notifications",200,(0,$.Jc)(e.value),e.errors):e)),Ya=e=>{var t;const n=(0,T.useMutation)(qa),a=(c=e.behaviorGroup.id,(0,i.useTransformQueryResponse)((0,T.useQuery)((e=>S.B.NotificationResourceGetEventTypesAffectedByRemovalOfBehaviorGroup.actionCreator({behaviorGroupId:e}))(c)),za)),{addDangerNotification:l,addSuccessNotification:o}=(0,qn.l)(),r=s.useCallback((async e=>{var t;const a=n.mutate;return 200===(null===(t=(await a(e.id)).payload)||void 0===t?void 0:t.status)?(o("Behavior group deleted",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null,e.displayName)," deleted successfully.")),!0):(l("Behavior group failed to be deleted",s.createElement(s.Fragment,null,"Failed to delete group ",s.createElement("b",null," ",e.displayName),".",s.createElement("br",null),"Please try again.")),!1)}),[n.mutate,l,o]);var c;return(0,s.useEffect)((()=>{const t=a.payload,n=e.onClose;t&&200!==t.status&&(l("Associated events failed to load ",s.createElement(s.Fragment,null,"Failed to load associated events for group"," ",s.createElement("b",null," ",e.behaviorGroup.displayName),".",s.createElement("br",null),"Please try again.")),n(!1))}),[l,a.payload,e.behaviorGroup,e.onClose]),a.loading?s.createElement(Ha,{onClose:e.onClose}):200!==(null===(t=a.payload)||void 0===t?void 0:t.status)?null:s.createElement(Va,{onDelete:r,isDeleting:n.loading,onClose:e.onClose,behaviorGroup:e.behaviorGroup,conflictingNotifications:a.payload.value})},Wa={backgroundColor:rn.C.var,paddingLeft:Ft.J.var,paddingRight:Ft.J.var},Qa=(0,u.style)(Wa,{paddingBottom:Ft.J.var}),ja=(0,u.style)(Wa,{paddingTop:Ft.J.var}),Ka=(0,u.style)({marginTop:"-0.15em",color:sn.U.var}),Ja=(0,u.style)({marginTop:"2px",marginLeft:"-16px"}),Xa=(0,u.style)({marginTop:"10px",marginLeft:"-16px"}),el=(0,u.style)({marginTop:"-0.2em"}),tl=e=>{const{isDisabled:t,...n}=e,{isOrgAdmin:l}=(0,E.b)(),o=s.createElement(a.Button,{...n,isAriaDisabled:t,variant:a.ButtonVariant.primary},"Create new group");if(t){const e=l?"You need the Notifications administrator role to perform this action":"You do not have permissions to perform this action. Contact your org admin for more information";return s.createElement(a.Tooltip,{content:e},o)}return o},nl=e=>{const[t,n]=s.useState(!0),[l,o]=s.useState(""),{rbac:i}=(0,E.b)(),r=s.useMemo((()=>{if(!e.behaviorGroupContent.isLoading&&!e.behaviorGroupContent.hasError){const t=l.toLowerCase();return e.behaviorGroupContent.content.filter((e=>e.displayName.toLowerCase().includes(t)))}return Zt}),[l,e.behaviorGroupContent]),[c,u]=(0,xn.A)(),[d,m]=(0,Rn.S)(),p=s.useCallback((e=>{e.stopPropagation(),u.create({events:[],actions:[],displayName:""})}),[u]),g=s.useCallback((t=>{const n=e.behaviorGroupContent.reload;t&&n(),u.reset()}),[u,e.behaviorGroupContent.reload]),v=s.useCallback((e=>{u.edit({id:e.id,events:e.events,actions:e.actions,displayName:e.displayName})}),[u]),h=s.useCallback((e=>{m.delete(e)}),[m]),f=s.useCallback((t=>{const n=e.behaviorGroupContent.reload;t&&n(),m.reset()}),[m,e.behaviorGroupContent.reload]),y=s.useCallback((()=>{o("")}),[o]),b="behavior-group-section-content";return s.createElement(s.Fragment,null,s.createElement("div",{className:ja},s.createElement(a.Split,{hasGutter:!0},s.createElement(a.ExpandableSectionToggle,{isExpanded:t,onToggle:n,contentId:b,direction:"down"},s.createElement(a.SplitItem,null,s.createElement(a.Title,{className:Ka,headingLevel:"h2"},"Behavior groups"))),s.createElement(a.SplitItem,null,!e.behaviorGroupContent.isLoading&&!e.behaviorGroupContent.hasError&&(e.behaviorGroupContent.content.length>0?s.createElement(a.Badge,{className:Xa,isRead:!0},e.behaviorGroupContent.content.length):s.createElement(tl,{className:el,component:"a",onClick:p,isDisabled:!i.canWriteNotifications}))),s.createElement(a.SplitItem,null,s.createElement(a.Popover,{position:"right",hideOnOutsideClick:!0,appendTo:()=>document.body,headerContent:s.createElement("div",{className:"pf-u-color-100"},"Behavior groups"),bodyContent:s.createElement("div",{className:"pf-u-font-size-sm pf-u-color-100"},"Behavior groups are made up of action/recipient pairings that allow you to configure which notification actions different users will be able to receive. Once you've created a behavior group, you can assign it to an event using the Events table below."," "),footerContent:s.createElement("div",{className:"pf-u-font-size-sm pf-u-color-100"}," ","You may also prevent users from changing assigned actions by locking action/recipient pairings when creating or editing behavior groups.")},s.createElement(a.Button,{className:Ja,variant:"plain","aria-label":"Help"},s.createElement(x.OutlinedQuestionCircleIcon,null)))))),s.createElement(a.ExpandableSection,{className:Qa,contentId:b,isExpanded:t,onToggle:n,isDetached:!0},s.createElement(a.Stack,{hasGutter:!0},(e.behaviorGroupContent.isLoading||e.behaviorGroupContent.hasError||e.behaviorGroupContent.content.length>0)&&s.createElement(s.Fragment,null,s.createElement(a.StackItem,null,s.createElement(a.Split,{hasGutter:!0},s.createElement(a.SplitItem,null,s.createElement(a.SearchInput,{value:l,onChange:o,onClear:y,type:"text","aria-label":"Search by name",placeholder:"Search by name",isDisabled:e.behaviorGroupContent.isLoading})),s.createElement(a.SplitItem,null,s.createElement(tl,{isDisabled:e.behaviorGroupContent.isLoading||!i.canWriteNotifications,onClick:p})))),s.createElement(a.StackItem,null,e.behaviorGroupContent.isLoading?s.createElement(Fn,null):e.behaviorGroupContent.hasError?s.createElement("div",null,"Error loading behavior groups"):s.createElement(Fn,{onEdit:i.canWriteNotifications?v:void 0,onDelete:i.canWriteNotifications?h:void 0,behaviorGroups:r})))),c.isOpen&&s.createElement(Za,{bundle:e.bundle,applications:e.applications,behaviorGroup:c.template,onClose:g}),d.isOpen&&s.createElement(Ya,{behaviorGroup:d.data,onClose:f})))};var al=n(96702);const ll=(0,V.validationResponseTransformer)((e=>200===e.status?(0,V.validatedResponse)("BehaviorGroups",200,e.value.map(al.V),e.errors):e));class ol extends Error{}const il=(e,t)=>{const n=e.find(Ht(t));if(!n)throw new ol("Notification not found in rows");return n},rl=(0,u.style)({marginBottom:Bt.K.var}),sl=[],cl=e=>{var t;const n=(e=>{const t=(e=>(0,i.useTransformQueryResponse)((0,T.useQuery)(S.B.NotificationResourceFindBehaviorGroupsByBundleId.actionCreator({bundleId:e})),ll))(e),{groups:n,isLoading:a}=(0,Hn.P)(),l=s.useMemo((()=>{const e=t.payload,n=t.errorObject,a=t.loading,l=t.query;return a?{isLoading:!0,reload:l}:200===(null==e?void 0:e.status)?{isLoading:!1,hasError:!1,content:e.value,reload:l}:{isLoading:!1,hasError:!0,error:n.toString(),reload:l}}),[t.payload,t.loading,t.errorObject,t.query]);return(0,s.useMemo)((()=>l.isLoading||l.hasError?l:(0,fe.ZP)(l,(e=>{const t=(0,fe.Js)(e);t&&t.content.forEach(((t,l)=>t.actions.forEach(((t,o)=>{(0,Je.Yh)(t)&&t.recipient.forEach(((t,i)=>{var r;if(t instanceof vn.nc&&t.isLoading){const t=e.content[l].actions[o].recipient,s=t[i];t[i]=new vn.nc(s.integrationId,s.groupId,(null===(r=n.find((e=>e.id===s.groupId)))||void 0===r?void 0:r.name)||a)}}))}))))}))),[l,n,a])})(e.bundle.id),{rbac:l}=(0,E.b)(),o=s.useCallback((e=>{console.log("Export to",e)}),[]),r=on(e.bundle,e.applications,!0),c=z(r.pageController.page),u=s.useMemo((()=>{const e=c.payload;return 200===(null==e?void 0:e.status)?e.value.meta.count:0}),[c.payload]),d=n.isLoading||n.hasError?void 0:n.content,{rows:m,updateBehaviorGroupLink:p,startEditMode:g,finishEditMode:v,cancelEditMode:h,updateBehaviorGroups:f}=((e,t)=>{const[n,a]=s.useState([]),l=(0,Yn.Z)(e),{query:o}=s.useContext(T.ClientContext),r=s.useCallback(((e,t)=>{a((0,fe.ZP)((n=>{const a=il(n,e),l=a.behaviors.findIndex(Ht(t));if(-1===l)throw new Error("Behavior group not found in rows");a.behaviors.splice(l,1)})))}),[a]),c=s.useCallback((e=>{a((0,fe.ZP)((t=>{for(const n of t)n.behaviors=[],e.forEach((e=>{e.events.find((e=>e.id===n.id))&&n.behaviors.push((0,fe.cA)(e))}))})))}),[a]),u=s.useCallback(((e,t,n)=>{n?a((0,fe.ZP)((n=>{il(n,e).behaviors.push({...(0,fe.cA)(t)})}))):r(e,t.id)}),[r,a]),d=s.useCallback((async(e,t)=>{var l;if("finish"===t){const t=il(n,e);t.isEditMode&&(a((0,fe.ZP)((t=>{il(t,e).loadingActionStatus="loading"}))),200===(null===(l=(await o(Q(e,t.behaviors.map((e=>e.id))))).payload)||void 0===l?void 0:l.status)?a((0,fe.ZP)((t=>{const n=il(t,e);n.isEditMode=!1,n.loadingActionStatus="done"}))):((0,i.addDangerNotification)("Saving behavior",s.createElement(s.Fragment,null,"There was an error saving the behavior of"," ",s.createElement("b",null,t.applicationDisplayName," -"," ",t.eventTypeDisplayName),".")),a((0,fe.ZP)((t=>{const n=il(t,e);n.isEditMode=!0,n.loadingActionStatus="done"})))))}else a((0,fe.ZP)((n=>{const a=il(n,e);a.isEditMode&&"cancel"===t&&(a.behaviors=a.oldBehaviors),a.isEditMode="edit"===t,a.isEditMode&&(a.oldBehaviors=a.behaviors)})))}),[a,n,o]),m=s.useCallback((e=>{d(e,"edit")}),[d]),p=s.useCallback((e=>{d(e,"finish")}),[d]),E=s.useCallback((e=>{d(e,"cancel")}),[d]);return s.useEffect((()=>{e!==l&&(a((t=>e.map((e=>({...e,loadingActionStatus:"done",behaviors:[],isEditMode:!1}))))),t&&c(t))}),[t,e,l,a,c]),{rows:n,updateBehaviorGroupLink:u,updateBehaviorGroups:c,startEditMode:m,finishEditMode:p,cancelEditMode:E}})(c.loading||"eventTypesArray"!==(null===(t=c.payload)||void 0===t?void 0:t.type)?sl:c.payload.value.data,d);s.useEffect((()=>{d&&f(d)}),[d,f]);const y=s.useCallback(((e,t,n)=>{t&&p(e.id,t,n)}),[p]),b=s.useCallback((e=>{g(e)}),[g]),C=s.useCallback((e=>{v(e)}),[v]),k=s.useCallback((e=>{h(e)}),[h]);return s.createElement(Rt,{configuration:e.children,settings:e.children},s.createElement(a.Tab,{eventKey:0,title:s.createElement(a.TabTitleText,null,"Configuration")},s.createElement(ln,{filters:r.filters,setFilters:r.setFilters,clearFilter:r.clearFilters,appFilterOptions:e.applications,onExport:o,count:u,pageAdapter:r.pageController},s.createElement(Jt,{notifications:m,behaviorGroupContent:n,onBehaviorGroupLinkUpdated:y,onStartEditing:l.canWriteNotifications?b:void 0,onFinishEditing:l.canWriteNotifications?C:void 0,onCancelEditing:l.canWriteNotifications?k:void 0,onSort:r.onSort,sortBy:r.sortBy,sortDirection:r.sortDirection}))),s.createElement(a.Tab,{eventKey:1,title:s.createElement(a.TabTitleText,null,"Behavior Groups")},s.createElement("div",{className:rl},s.createElement(nl,{bundle:e.bundle,applications:e.applications,behaviorGroupContent:n}))))},ul=e=>{const{updateDocumentTitle:t}=(0,o.Z)();null==t||t(`${e.bundle.displayName} - Notifications`);const n=(0,m.useFlag)("platform.notifications.overhaul"),{rbac:l}=(0,E.b)(),r=c().useMemo((()=>Fl.eventLog(e.bundle.name)),[e.bundle.name]),d=Ot(),[p,g]=(0,s.useState)(0),v=c().createElement(I.ZP,null,c().createElement(cl,{applications:e.applications,bundle:e.bundle})),h=(0,u.style)({paddingLeft:Ft.J.value}),f=()=>n?null:c().createElement(ue,{isDisabled:!l.canReadEvents,to:r,variant:a.ButtonVariant.secondary},O.V.pages.notifications.list.viewHistory),y=c().createElement(I.ZP,null,c().createElement(Gt.TimeConfigComponent,null));(0,s.useEffect)((()=>{n&&(0,d.query)(e.bundleTabs[p].name)}),[p,d.query,e.bundleTabs,n]);const b=(0,s.useMemo)((()=>d.payload?d.payload.value:[]),[d.payload]);if(n){const t=(e,t)=>{g(t)};return c().createElement(c().Fragment,null,c().createElement(mt,{title:n?"Configure Events":`${O.V.pages.notifications.list.title} | ${e.bundle.displayName}`,subtitle:c().createElement("span",null,"This service allows you to configure which notifications different users within your organization will be entitled to receiving. To do this, create behavior groups and apply",c().createElement("a",{href:(0,i.localUrl)(`/user-preferences/notifications/${e.bundle.name}`,(0,i.getInsights)().chrome.isBeta())}," ","User Preferences"),"."),action:f()}),c().createElement(a.Flex,{direction:{default:"column"}},c().createElement(a.FlexItem,null,c().createElement(a.Tabs,{activeKey:p,onSelect:t,className:h},c().createElement(a.Tab,{eventKey:0,title:c().createElement(a.TabTitleText,null,"Red Hat Enterprise Linux")},c().createElement(I.ZP,null,c().createElement(cl,{applications:b,bundle:e.bundleTabs[0]}))),c().createElement(a.Tab,{eventKey:1,title:c().createElement(a.TabTitleText,null,"Console")},c().createElement(I.ZP,null,c().createElement(cl,{applications:b,bundle:e.bundleTabs[1]}))),c().createElement(a.Tab,{eventKey:2,title:c().createElement(a.TabTitleText,null,"Openshift")},c().createElement(I.ZP,null,c().createElement(cl,{applications:b,bundle:e.bundleTabs[2]})))))))}return c().createElement(c().Fragment,null,c().createElement(mt,{title:`${O.V.pages.notifications.list.title} | ${e.bundle.displayName}`,subtitle:c().createElement("span",null,"This service allows you to configure which notifications different users within your organization will be entitled to receiving. To do this, create behavior groups and apply them to different events. Users will be able to opt-in or out of receiving authorized event notifications in their",c().createElement("a",{href:(0,i.localUrl)(`/user-preferences/notifications/${e.bundle.name}`,(0,i.getInsights)().chrome.isBeta())}," ","User Preferences"),"."),action:f()}),c().createElement(Rt,{configuration:e.children,settings:e.children},c().createElement(a.Tab,{eventKey:0,title:c().createElement(a.TabTitleText,null,"Configuration")},v),c().createElement(a.Tab,{eventKey:1,title:c().createElement(a.TabTitleText,null,"Settings")},y)))};var dl;!function(e){e[e.LOADING=0]="LOADING",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.FAILED_TO_LOAD=2]="FAILED_TO_LOAD"}(dl||(dl={}));const ml=()=>{const e=(0,p.useNavigate)(),t=(0,p.useParams)(),n=(0,m.useFlag)("platform.notifications.overhaul"),a=["rhel","console","openshift"],l=(0,s.useMemo)((()=>n?"rhel":t.bundleName),[n,t.bundleName]),o=k(),i=Ot(),r=(0,s.useMemo)((()=>{var e,t;return 200===(null===(e=o.payload)||void 0===e?void 0:e.status)?null!==(t=o.payload.value.find((e=>e.name===l)))&&void 0!==t?t:dl.NOT_FOUND:o.payload?dl.FAILED_TO_LOAD:dl.LOADING}),[o.payload,l]),c=[];n&&(()=>{var e;if(200!==(null===(e=o.payload)||void 0===e?void 0:e.status)){if(o.payload)throw new Error("Unable to load bundle information");return s.createElement(Lt,null)}a.forEach((e=>{var t,n;(null===(t=o.payload)||void 0===t?void 0:t.value)&&c.push(null!==(n=o.payload.value.find((t=>t.name===e)))&&void 0!==n?n:dl.NOT_FOUND)}))})(),s.useEffect((()=>{const e=i.query;(e=>"number"==typeof e)(r)||e(r.name)}),[r,i.query]);const u=(0,s.useMemo)((()=>{if(i.payload)return 200===i.payload.status?i.payload.value:null}),[i.payload]);if(r===dl.NOT_FOUND){if("/rhel"===l)throw new Error("Default bundle information not found");return e("/notifications/rhel"),s.createElement(s.Fragment,null)}if(r===dl.FAILED_TO_LOAD)throw new Error("Unable to load bundle information");if(null===u)throw new Error("Unable to load application facets");return r!==dl.LOADING&&u?s.createElement(ul,{bundleTabs:c,bundle:r,applications:u}):s.createElement(Lt,null)};var pl;!function(e){e.TODAY="today",e.YESTERDAY="yesterday",e.LAST_7="last_7",e.LAST_14="last_14",e.CUSTOM="custom"}(pl||(pl={}));const El={[pl.TODAY]:"Today",[pl.YESTERDAY]:"Yesterday",[pl.LAST_7]:"Last 7 days",[pl.LAST_14]:"Last 14 days",[pl.CUSTOM]:"Custom"},gl=(0,u.style)({backgroundColor:(0,me.important)("var(-pf-v5-global--BackgroundColor--100)"),cursor:"pointer",$nest:{"&::placeholder":{color:(0,me.important)("var(--pf-v5-global--palette--black-1000)")},"&:hover":{borderBottomColor:"var(--pf-v5-global--active-color--100)"}}});class vl{constructor(e){this.value=e}toString(){return El[this.value]}compareTo(e){return e instanceof vl&&e.value===this.value}}const hl={isReadOnly:!0,className:gl},fl=(e,t,n)=>[a=>(0,Ee.Z)(a,e)?"Date is before the retention policy":(0,ge.Z)(a,t)?"Date is after today":n[1]&&(0,ge.Z)(a,n[1])?"Start date must be before end date":""],yl=(e,t,n)=>[a=>(0,Ee.Z)(a,e)?"Date is before the retention policy":(0,ge.Z)(a,t)?"Date is after today":n[0]&&(0,Ee.Z)(a,n[0])?"End date must be after start date":""],bl=({period:e,setPeriod:t})=>{const n=(0,s.useMemo)((()=>new Date),[]),l=(0,s.useMemo)((()=>(0,pe.Z)(n,{days:-14})),[n]),o=e=>e?(0,r.Z)(e,"yyyy-MM-dd"):void 0,i=o(e[0]),u=o(e[1]),d=(0,s.useRef)(null),m=(0,s.useRef)(null);return c().createElement(a.Split,null,c().createElement(a.SplitItem,null,c().createElement(a.DatePicker,{placeholder:"Start",inputProps:{...hl,onClick:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.setCalendarOpen(!0)}},validators:fl(l,n,e),onChange:e=>{const a=(0,ve.Z)(e);t((0,fe.ZP)((e=>{e[0]=a,e[1]||(e[1]=(0,he.Z)([(0,pe.Z)(a,{days:1}),n]))})))},value:i,ref:d})),c().createElement(a.SplitItem,{className:"pf-v5-u-align-self-center pf-v5-u-px-sm pf-v5-u-color-300"},"to"),c().createElement(a.SplitItem,null,c().createElement(a.DatePicker,{placeholder:"End",inputProps:{...hl,onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.setCalendarOpen(!0)}},validators:yl(l,n,e),onChange:e=>{t((0,fe.ZP)((t=>{t[1]=(0,ve.Z)(e)})))},value:u,ref:m})))},Cl=({value:e,setValue:t,period:n,setPeriod:l,retentionDays:o})=>{const[i,r]=(0,s.useState)(!1),u=(0,s.useMemo)((()=>new vl(e)),[e]);return c().createElement(a.Split,null,c().createElement(a.SplitItem,null,c().createElement(a.Select,{isOpen:i,variant:a.SelectVariant.single,onToggle:()=>r((e=>!e)),selections:u,onSelect:(e,n)=>{n instanceof vl&&(t(n.value),r(!1))}},Object.values(pl).map((e=>c().createElement(a.SelectOption,{key:e,value:new vl(e)}))))),e===pl.CUSTOM&&c().createElement(a.SplitItem,null,c().createElement(bl,{period:n,setPeriod:l,retentionDays:o})))},Tl=()=>c().createElement(a.Bullseye,null,c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.small},c().createElement(a.EmptyStateIcon,{icon:x.SearchIcon}),c().createElement(a.Title,{headingLevel:"h2",size:"lg"},"No results found"),c().createElement(a.EmptyStateBody,null,"Clear all filters and try again."),c().createElement(a.Button,{variant:"link"},"Clear all filters"))),Sl=({isEmptyState:e,onSort:t,sort:n,drawer:l,onPagination:o,pagination:i})=>{const r=e=>({sortBy:{index:n.columnIndex,direction:n.direction,defaultDirection:"asc"},onSort:(e,n,a)=>{t(n,a)},columnIndex:e});return c().createElement(c().Fragment,null,c().createElement(Ie.TableComposable,null,c().createElement(Ie.Thead,null,c().createElement(Ie.Tr,null,c().createElement(Ie.Th,{sort:r(0)},"Event type"),c().createElement(Ie.Th,null,"Service"),c().createElement(Ie.Th,{sort:r(2)},"Timestamp"))),c().createElement(Ie.Tbody,null,e?c().createElement(Ie.Tr,null,c().createElement(Ie.Td,{colSpan:8},c().createElement(Tl,null))):c().createElement(c().Fragment,null,l.map((e=>c().createElement(Ie.Tr,{key:e.id},c().createElement(Ie.Td,null,e.title),c().createElement(Ie.Td,null,e.source),c().createElement(Ie.Td,null,e.created))))))),c().createElement(a.Pagination,{itemCount:i.count,perPage:i.limit,page:i.offset/i.limit+1,onSetPage:(e,t,n)=>{o({limit:null!=n?n:i.limit,offset:(t-1)*(null!=n?n:i.limit)})},widgetId:"pagination-id",onPerPageSelect:(e,t)=>{o({limit:null!=t?t:i.limit,offset:0})}}))},kl=({onPagination:e,pagination:t,...n})=>c().createElement(c().Fragment,null,c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(a.ToolbarItem,null,c().createElement(a.MenuToggle,{icon:c().createElement(a.Icon,null,c().createElement(x.FilterIcon,null))},"Event")))),c().createElement(a.Divider,null),c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(a.ToolbarItem,null,c().createElement(Cl,{value:n.dateFilter,setValue:n.setDateFilter,retentionDays:n.retentionDays,setPeriod:n.setPeriod,period:n.period})),c().createElement(a.ToolbarItem,{className:"pf-u-ml-auto"},c().createElement(a.Pagination,{itemCount:t.count,perPage:t.limit,page:t.offset/t.limit+1,onSetPage:(n,a,l)=>{e({limit:null!=l?l:t.limit,offset:(a-1)*(null!=l?l:t.limit)})},widgetId:"pagination-id",onPerPageSelect:(n,a)=>{e({limit:null!=a?a:t.limit,offset:0})},isCompact:!0}))))),Il={0:"title",2:"time"},Nl=()=>{var e,t,n,l;const[o,u]=(0,s.useState)([]),[d,m]=(0,s.useState)([void 0,void 0]),[p,E]=(0,s.useState)(pl.LAST_14),[g,v]=(0,s.useState)({offset:0,limit:20,count:0}),[h,f]=(0,s.useState)({columnIndex:2,direction:"desc"}),y=(0,s.useMemo)((()=>((e,t)=>{const n=[void 0,void 0],a="yyyy-MM-dd",l=new i.Filter;return(e=>{const t=(0,i.toUtc)(new Date);(0,St.Z)((0,kt.Z)(t),{days:1}),pl.LAST_14,(0,St.Z)((0,kt.Z)(t),{days:14}),pl.LAST_7,(0,St.Z)((0,kt.Z)(t),{days:7}),pl.TODAY,pl.YESTERDAY})(),n[0]&&n[1]&&(l.and("start",i.Operator.EQUAL,(0,r.Z)(n[0],a)),l.and("end",i.Operator.EQUAL,(0,r.Z)(n[1],a))),{startDate:n[0]?(0,r.Z)(n[0],a):void 0,endDate:n[1]?(0,r.Z)(n[1],a):void 0}})()),[p,null===(e=d[0])||void 0===e?void 0:e.toString(),null===(t=d[1])||void 0===t?void 0:t.toString()]),b=(0,s.useCallback)(((e,t,n)=>{const a=new URLSearchParams({offset:`${e.offset}`,limit:`${e.limit}`,sort_by:`${Il[t.columnIndex]}:${t.direction}`});n.startDate&&a.append("startDate",n.startDate+"T00:00:00"),n.endDate&&a.append("endDate",n.endDate+"T23:59:59"),fetch(`/api/notifications/v1/notifications/drawer?${a.toString()}`).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{u(e.data),v((t=>({...t,count:e.meta.count})))})).catch((e=>{console.error("Error while fetching data: ",e)}))}),[]);return(0,s.useEffect)((()=>{b(g,h,y)}),[p,null===(n=d[0])||void 0===n?void 0:n.toString(),null===(l=d[1])||void 0===l?void 0:l.toString()]),c().createElement(c().Fragment,null,c().createElement(mt,{title:O.V.pages.notifications.notificationsLog.title,subtitle:O.V.pages.notifications.notificationsLog.subtitle}),c().createElement(I.ZP,null,c().createElement(a.Card,null,c().createElement(kl,{pagination:g,onPagination:({limit:e,offset:t})=>{v((n=>({...n,offset:t,limit:e}))),b({limit:e,offset:t},h,y)},dateFilter:p,setDateFilter:E,retentionDays:14,period:d,setPeriod:m}),c().createElement(Sl,{isEmptyState:0===o.length,sort:h,onSort:(e,t)=>{f({columnIndex:e,direction:t}),b(g,{columnIndex:e,direction:t},y)},drawer:o,pagination:g,onPagination:({limit:e,offset:t})=>{v((n=>({...n,offset:t,limit:e}))),b({limit:e,offset:t},h,y)}}))))},wl=n.p+"fonts/notifications-product-icon.svg";var Al;!function(e){e.USER="user",e.RUNNING="running",e.INTEGRATION="integration",e.USERS="users",e.BELL="bell"}(Al||(Al={}));const Dl=({icon:e,heading:t,linkTitle:n,linkTarget:l,expandableContent:o,isRedirect:i})=>{const r=(0,p.useNavigate)();let s=null;const[u,d]=c().useState(!1);switch(e){case Al.USER:s=c().createElement(x.UserIcon,{className:"pf-u-primary-color-100"});break;case Al.RUNNING:s=c().createElement(x.RunningIcon,{className:"pf-u-primary-color-100"});break;case Al.INTEGRATION:s=c().createElement(x.IntegrationIcon,{className:"pf-u-primary-color-100"});break;case Al.USERS:s=c().createElement(x.UsersIcon,{className:"pf-u-primary-color-100"});break;case Al.BELL:s=c().createElement(x.BellIcon,{className:"pf-u-primary-color-100"})}return c().createElement(c().Fragment,null,c().createElement(a.DataListItem,{"aria-labelledby":"item1",isExpanded:u},c().createElement(a.DataListItemRow,{className:"pf-u-align-items-center"},c().createElement(a.DataListToggle,{isExpanded:u,id:"toggle1","aria-controls":"expand1",onClick:()=>d(!u)}),c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"cell-"+e.toString().toLowerCase()},c().createElement("div",null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,{className:"pf-u-align-self-center"},c().createElement(a.Icon,{size:"lg"},s)),c().createElement(a.Divider,{orientation:{default:"vertical"}}),c().createElement(a.FlexItem,{className:"pf-u-align-self-center"},c().createElement(a.Title,{headingLevel:"h4"},t)))))]}),n&&l&&c().createElement(a.DataListAction,{"aria-labelledby":"item1 action1",id:"action1","aria-label":"Actions",isPlainButtonAction:!0},c().createElement(a.Button,{component:"a",href:l,variant:"link",onClick:e=>{i||(e.preventDefault(),r(l.replace("/preview","")))}},n))),c().createElement(a.DataListContent,{"aria-label":t+" - Detailed Explanation",id:"expand1",isHidden:!u},c().createElement("p",null,o))))},Ll="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_notifications_on_the_red_hat_hybrid_cloud_console/index",Pl="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_notifications_on_the_red_hat_hybrid_cloud_console/assembly-intro_notifications",Ol="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_sources_for_red_hat_services/index",Fl={overview:()=>"/",configureEvents:()=>"/configure-events",integrations:()=>"/settings/integrations",notifications:e=>`/${e}`,eventLog:e=>"/eventlog"+(e?`?bundle=${e}`:""),notificationsLog:()=>"/notificationslog",splunk:()=>"/integrations/splunk-setup"},Rl=[{path:"/",component:()=>{const{getApp:e}=(0,o.Z)();return"integrations"===e()?s.createElement(R,null):null}},{path:Fl.integrations(),component:R},{path:Fl.eventLog(),component:Nt},{path:Fl.notifications(":bundleName"),component:ml},{path:Fl.splunk(),component:()=>{const[e,t]=(0,s.useState)(2),[n,l]=(0,s.useState)(!1),[o,i]=(0,s.useState)("info"),[r,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[p,E]=(0,s.useState)(["Logs from the automation would appear here\n"]),[g,h]=(0,s.useState)();return c().createElement(c().Fragment,null,c().createElement(v.Z,null,c().createElement(se,null)),c().createElement(A,null,c().createElement(a.Card,null,c().createElement(a.CardBody,null,c().createElement(a.Split,{hasGutter:!0},c().createElement(a.SplitItem,null,c().createElement(a.ProgressStepper,{isVertical:!0},c().createElement(a.ProgressStep,{isCurrent:1===e,variant:"success",description:"Create Index and HEC",id:"step1-splunk-app-step",titleId:"step1-splunk-app-step","aria-label":"completed Splunk app step (step 1)"},"Step 1"),c().createElement(a.ProgressStep,{isCurrent:2===e,icon:2===e&&n?c().createElement(x.InProgressIcon,null):void 0,variant:e<2?"info":o,description:"Configure Splunk integration in Insights",id:"step2-setup-step",titleId:"step2-setup-step","aria-label":"setup step (step 2)"},"Step 2"),c().createElement(a.ProgressStep,{isCurrent:3===e,variant:e<3?"pending":o,description:"Review",id:"step3-review-step",titleId:"step3-review-step","aria-label":"review step (step 3)"},"Step 3"))),c().createElement(a.Divider,{isVertical:!0}),c().createElement(a.SplitItem,{isFilled:!0},2===e&&c().createElement(oe,{setStep:t,stepIsInProgress:n,setStepIsInProgress:l,stepVariant:o,setStepVariant:i,hecToken:r,setHecToken:u,splunkServerHostName:d,setHostName:m,automationLogs:p,setAutomationLogs:E,setError:h}),3===e&&c().createElement(M,{isSuccess:"success"===o,error:g})))))))}},{path:Fl.notificationsLog(),component:Nl}],xl=[{path:Fl.overview(),component:()=>{const e=(0,p.useNavigate)(),t=(0,m.useFlag)("platform.sources.integrations"),[n,l]=c().useState(null),{auth:i,isBeta:r,getBundle:s}=(0,o.Z)(),u=(0,m.useFlag)("platform.notifications.overhaul");return c().useEffect((()=>{i&&(async()=>{const{identity:{user:e}}=await i.getUser();l(e.is_org_admin)})()}),[i]),c().createElement(c().Fragment,null,c().createElement(v.Z,null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement("img",{src:wl})),c().createElement(a.Divider,{orientation:{default:"vertical"}}),c().createElement(a.FlexItem,{className:"pf-u-align-self-flex-start"},c().createElement(f(),{title:"Notifications",className:"pf-u-mb-sm"}),c().createElement("p",{className:"pf-u-mb-sm"},"A standardized way of notifying users of events for supported services on the Hybrid Cloud Console.")))),c().createElement(I.ZP,null,n?c().createElement(c().Fragment,null,c().createElement(a.Card,{className:"pf-u-mb-lg"},c().createElement(a.Grid,{hasGutter:!0},c().createElement(a.GridItem,{sm:12,md:6,lg:8},c().createElement(a.CardTitle,null,c().createElement(a.Title,{headingLevel:"h2"},"Manage events for your organization")),c().createElement(a.CardBody,null,c().createElement("p",null,"This service allows you to configure which notifications different users within your organization will be entitled to receiving. To do this, create behavior groups and apply them to different events. Users will be able to opt-in or out of receiving authorized event notifications in their"," ",c().createElement("a",{href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/user-preferences`)}},"User Preferences"),".")),c().createElement(a.CardFooter,null,c().createElement(a.Button,{variant:"primary",component:"a",href:`${r()?"/preview":""}/${s()}/notifications/configure-events`,isLarge:!0,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/configure-events`)}},"Configure events"))),c().createElement(a.GridItem,{md:6,lg:4,className:"pf-u-display-none pf-u-display-block-on-md pf-c-card__cover-image"})))):c().createElement(c().Fragment,null,c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Get started with Notifications on the Hybrid Cloud Console"),c().createElement(a.Grid,{hasGutter:!0,className:"pf-u-mb-lg"},c().createElement(a.GridItem,{sm:12,md:6},c().createElement(a.Card,{className:"pf-u-h-100"},c().createElement(a.CardTitle,null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement(a.Icon,{size:"lg"},c().createElement(x.UserIcon,{className:"pf-u-primary-color-100"}))),c().createElement(a.FlexItem,null,c().createElement(a.Title,{headingLevel:"h2"},"Manage your own notifications with My User Preferences")))),c().createElement(a.CardBody,null,c().createElement("p",null,"This service allows you to opt-in and out of receiving notifications. Your Organization Administrator has configured which notifications you can or can not receive in their Settings.")),c().createElement(a.CardFooter,null,c().createElement(a.Button,{variant:"primary",isLarge:!0,component:"a",href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/user-preferences`)}},"Go to My User Preferencesss")))),c().createElement(a.GridItem,{sm:12,md:6},c().createElement(a.Card,{className:"pf-u-h-100"},c().createElement(a.CardTitle,null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement(a.Icon,{size:"lg"},c().createElement(x.RunningIcon,{className:"pf-u-primary-color-100"}))),c().createElement(a.FlexItem,null,c().createElement(a.Title,{headingLevel:"h2"},"Monitor all fired events with the Event log")))),c().createElement(a.CardBody,null,c().createElement("p",null,"See all the events affecting your organization and view details around the events fired.")),c().createElement(a.CardFooter,null,!u&&c().createElement(a.Button,{variant:"secondary",isLarge:!0,component:"a",href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/eventlog`)}},"View Event log")))))),n?c().createElement(c().Fragment,null,c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Supporting features"),c().createElement(a.DataList,{"aria-label":"Supporting features list",className:"pf-u-mb-lg"},c().createElement(Dl,{icon:Al.USER,heading:"Manage your own notifications with My User Preferences",linkTitle:"Go to My User Preferences",linkTarget:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,expandableContent:"This service allows you to opt-in and out of receiving notifications. Your Organization\n                            Administrator has configured which notifications you can or can not receive in their Settings."}),c().createElement(Dl,{icon:Al.RUNNING,heading:"Monitor all fired events with the Event log",linkTitle:"View Event log",linkTarget:`${r()?"/preview":""}/${s()}/notifications/eventlog `,expandableContent:"See all the events affecting your organization and view details around the events fired."}),c().createElement(Dl,{icon:Al.INTEGRATION,heading:"Set up Integrations to customize your notifications",linkTitle:"Set up Integrations",...t&&{isRedirect:!0},linkTarget:t?(r()?"/preview":"")+"/settings/sources?category=Integrations":`${r()?"/preview":""}/${s()}/notifications/integrations`,expandableContent:"Notifications and integrations services work together to transmit messages to third-party application\n                    endpoints, such as instant messaging platforms and external ticketing systems, when triggering events occur. Integrations\n                    include Splunk, Slack, ServiceNow, and more."}),c().createElement(Dl,{icon:Al.USERS,heading:"Create behavior groups to easily notify the right users",linkTitle:"Create new behavior group",linkTarget:`${r()?"/preview":""}/${s()}/notifications/configure-events`,expandableContent:"Behavior groups are made up of action/recipient pairings that allow you to configure which notification\n                    actions different users will be able to receive. Once you've created a behavior group, you can assign it to an event. You\n                    may also prevent users from changing assigned actions by locking action/recipient pairings when creating or editing behavior\n                    groups."}))):c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Supporting features list",className:"pf-u-mb-lg"},c().createElement(Dl,{icon:Al.BELL,heading:"About Notifications",expandableContent:"Notifications are a way for users to be alerted of important events that occur in the Hybrid Cloud\n                            Console. You can receive notifications within the console via the notifications drawer as well as through email and\n                            third-party integrations, such as Slack or ServiceNow."}))),c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Recommended content"),n?c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Recommended content list",className:"pf-u-mb-lg"},c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row1-col1"},c().createElement("span",null,"Configuring notifications and integrations")),c().createElement(a.DataListCell,{key:"row1-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row1-col3"},c().createElement("a",{href:Ll,onClick:e=>{e.preventDefault(),window.open(Ll,"_blank")}},"View documentation ",c().createElement(x.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row2-col1"},c().createElement("span",null,"Configuring integrations and events")),c().createElement(a.DataListCell,{key:"row2-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row2-col3"},c().createElement("a",{href:Pl,onClick:e=>{e.preventDefault(),window.open(Pl,"_blank")}},"View documentation ",c().createElement(x.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row3-col1"},c().createElement("span",null,"Restricting access to a service to a team")),c().createElement(a.DataListCell,{key:"row3-col2"},c().createElement(a.Label,{color:"green"},"Quick start")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row3-col3"},c().createElement("a",{href:(r()?"/preview":"")+"/iam/my-user-access?bundle=rhel&quickstart=rbac-admin-vuln-permissions"},"Begin Quick start ",c().createElement(x.ArrowRightIcon,null)))]}))))):c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Recommended content list",className:"pf-u-mb-lg"},c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row1-col1"},c().createElement("span",null,"Configuring notifications and integrations")),c().createElement(a.DataListCell,{key:"row1-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row1-col3"},c().createElement("a",{href:Pl,onClick:e=>{e.preventDefault(),window.open(Pl,"_blank")}},"View documentation ",c().createElement(x.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row2-col1"},c().createElement("span",null,"Configuring integrations for Red Hat services")),c().createElement(a.DataListCell,{key:"row2-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row2-col3"},c().createElement("a",{href:Ol,onClick:e=>{e.preventDefault(),window.open(Ol,"_blank")}},"View documentation ",c().createElement(x.ExternalLinkAltIcon,null)))]}))))),c().createElement("a",{href:(r()?"/preview":"")+"/settings/learning-resources",className:"pf-u-mb-lg"},"View all Settings Learning Resources")))}},{path:Fl.integrations(),component:R},{path:Fl.configureEvents(),component:ml},{path:Fl.eventLog(),component:Nt},{path:Fl.notificationsLog(),component:Nl}],Gl=()=>{const e=(0,m.useFlag)("platform.notifications.overhaul"),t=s.useMemo((()=>e?xl:Rl),[e]);return s.createElement(p.Routes,null,t.map((e=>s.createElement(p.Route,{key:e.path,path:e.path,element:s.createElement(L,null,s.createElement(e.component,null))}))),!e&&s.createElement(p.Route,{path:"*",element:s.createElement(p.Navigate,{to:"/",replace:!0})}))};var Bl=n(54926),Ml=n(56335),_l=n(3121);const Ul="HH:mm",Zl="hh:mma",Vl=(0,u.style)({padding:8}),$l=()=>{const{updateDocumentTitle:e}=(0,o.Z)();null==e||e("Notifications");const{rbac:t,server:n,isOrgAdmin:c}=(0,_l.q)(),u=(0,i.getInsights)(),[m,p]=s.useState(!1),g=s.useCallback((e=>{e?(u.chrome.getEnvironmentOriginal=u.chrome.getEnvironment,u.chrome.getEnvironment=()=>"ci"):u.chrome.getEnvironment=u.chrome.getEnvironmentOriginal,p(e)}),[u]);if(!t||!n)return s.createElement(Lt,null);if(n.status===Bl.U.MAINTENANCE){const e=(0,r.Z)((0,i.toUtc)(n.from),Ul),t=(0,r.Z)((0,i.toUtc)(n.to),Ul),a=(0,r.Z)(n.from,Zl),o=(0,r.Z)(n.to,Zl),c=(0,r.Z)(n.to,"O");return s.createElement(l.Z,{utcStartTime:e,utcEndTime:t,startTime:a,endTime:o,timeZone:c})}return s.createElement(E.I.Provider,{value:{rbac:t,server:n,isOrgAdmin:!!c}},s.createElement(Ml.d,null,s.createElement(d.q,null),s.createElement(i.InsightsEnvDetector,{insights:u,onEnvironment:nn.ok},s.createElement(i.RenderIfTrue,null,s.createElement(a.Switch,{className:Vl,isChecked:m,onChange:g,labelOff:"Enable experimental features",label:"Disable experimental features"}))),s.createElement(Gl,null)))}},2412:(e,t,n)=>{n.d(t,{Y:()=>o});var a=n(94782),l=n(16721);const o=()=>(0,a.useQuery)(l.B.OrgConfigResourceGetDailyDigestTimePreference.actionCreator())},60207:(e,t,n)=>{n.d(t,{I:()=>i});var a=n(94782),l=n(16721);const o=e=>l.B.OrgConfigResourceSaveDailyDigestTimePreference.actionCreator({body:e.body}),i=()=>(0,a.useMutation)(o)}}]);
//# sourceMappingURL=../sourcemaps/2970.b5d849bf9bd89b50f191ce0836ede1e4.js.map