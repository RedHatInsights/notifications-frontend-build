"use strict";(self.webpackChunknotifications_frontend=self.webpackChunknotifications_frontend||[]).push([[2728],{75861:(e,t,n)=>{n.d(t,{Z:()=>Dl});var a=n(21242),l=n(20687),i=n(55140),o=n(55128),r=n(21472),s=n(10756),c=n.n(s),u=n(42150),d=n(89063),m=n(62012),p=n(84456),E=n(79153),v=n(80123),g=n(69622),h=n.n(g),f=n(85333),y=n(86896),b=n(77365),C=n(94782),T=n(16721);const S=(e,t=!0)=>(0,C.useQuery)((e=>T.B.NotificationResourceGetBundleFacets.actionCreator({includeApplications:e}))(!!e),t),k=()=>{var e,t;const n=(0,i.Z)(),{bundleName:l}=(0,m.useParams)(),r=S(),u=(0,s.useMemo)((()=>{var e;if(200===(null===(e=r.payload)||void 0===e?void 0:e.status))return r.payload.value.find((e=>e.name===l))}),[l,null===(e=r.payload)||void 0===e?void 0:e.status,null===(t=r.payload)||void 0===t?void 0:t.value]),d=(0,m.useLocation)(),p=(0,y.Z)(),g=c().createElement("a",{href:(0,o.localUrl)("/user-preferences/notifications/",n.isBeta())}," ","User Preferences"),C=c().createElement("a",{href:(0,o.localUrl)("/settings/my-user-access?bundle=rhel }",n.isBeta())}," ","My User Access"," "),T=c().useMemo((()=>{switch(n.getApp()){case E.ZP.integrations.subAppId:return p.formatMessage(b.Z.integrations);case E.ZP.notifications.subAppId:return d.pathname===yl.eventLog()?"Event Log":p.formatMessage(b.Z.notifications);default:return""}}),[p,d.pathname,n]),k=c().useMemo((()=>"Notifications"===T&&u?`${T} | ${null==u?void 0:u.displayName}`:`${T}`),[u,T]),I=c().useMemo((()=>"Notifications"===T?c().createElement("span",null,"Configure which event notifications different users within your organization are entitled to receive."):c().createElement("span",null)),[T,n]);return c().createElement(c().Fragment,null,c().createElement(v.Z,null,c().createElement(a.Split,null,c().createElement(a.SplitItem,{isFilled:!0},c().createElement(h(),{title:k,paddingBottom:"8px"}," "),c().createElement(a.StackItem,null,I)))),c().createElement(f.Z,{description:c().createElement(c().Fragment,null,"Contact your organization administrator for more information or visit",C," to learn more about your permissions. To manage your notifications, go to your ",g,"."),serviceName:T}))},I=e=>{const t=(0,i.Z)(),{rbac:n}=(0,p.b)(),a=(0,m.useLocation)(),l=c().useMemo((()=>{switch(t.getApp()){case E.ZP.integrations.subAppId:return null==n?void 0:n.canReadIntegrationsEndpoints;case E.ZP.notifications.subAppId:return a.pathname===yl.eventLog()?null==n?void 0:n.canReadEvents:null==n?void 0:n.canReadNotifications}return!1}),[n,a,t]);return c().createElement(c().Fragment,null,l?e.children:c().createElement(k,null))};var N=n(98901),w=n.n(N),D=n(44873),A=n(18115),L=n(78576);const P=()=>{const{updateDocumentTitle:e,getBundle:t}=(0,i.Z)();null==e||e("Integrations");const n=(0,d.useFlag)("platform.notifications.overhaul");return s.createElement(D.Z,{className:"pf-c-page__main-section pf-m-light"},s.createElement(w(),null,s.createElement(a.Split,null,s.createElement(a.SplitItem,{isFilled:!0},s.createElement(h(),{title:A.V.pages.integrations.list.title})),!n&&s.createElement(a.SplitItem,null,s.createElement(a.Button,{variant:"secondary",component:()=>s.createElement(m.Link,{to:`/${t()}/notifications${yl.eventLog()}`})}," ","View event log"," ")))),s.createElement(L.Z,null))};var O=n(43551);const F=A.V.pages.splunk.page.helpUrl,x="https://access.redhat.com/support/cases/#/case/new/open-case/describe-issue?intcmp=hp|a|a3|case&caseCreate=true&product=Red%20Hat%20Insights&version=Red%20Hat%20Insights",R=({isSuccess:e,error:t})=>e?c().createElement(G,null):c().createElement(_,{error:t}),G=()=>c().createElement(a.EmptyState,null,c().createElement(a.EmptyStateIcon,{icon:O.CheckCircleIcon,color:"var(--pf-global--success-color--100)"}),c().createElement(a.Title,{headingLevel:"h4",size:"lg"},"Splunk integration in Insights completed"),c().createElement(a.EmptyStateBody,null,"Splunk integration in Insights was completed. To confirm these changes,"," ",c().createElement("strong",null,"go back to Splunk application"),".")),_=({error:e})=>c().createElement(a.EmptyState,null,c().createElement(a.EmptyStateIcon,{icon:O.ExclamationCircleIcon,color:"var(--pf-global--danger-color--100)"}),c().createElement(a.Title,{headingLevel:"h4",size:"lg"},"Configuration failed"),c().createElement(a.EmptyStateBody,null,c().createElement("p",{className:"pf-u-mb-md"},"There was a problem processing the request. Please try again. If the problem persists, contact Red Hat support by opening the ticket."),e&&c().createElement("p",null,`${e}`)),c().createElement(a.Button,{variant:"primary",component:"a",href:x,target:"_blank",rel:"noopener noreferrer"},"Open a Red Hat Support ticket"),c().createElement(a.EmptyStateSecondaryActions,null,c().createElement(a.Button,{variant:"link",component:"a",href:F,target:"_blank",rel:"noopener noreferrer"},"Go to documentation")));var B=n(63055),M=n(70070),V=n(10406);const Z=e=>{const t=(null!=e?e:o.Page.defaultPage()).toQuery();return T.B.NotificationResourceGetEventTypes.actionCreator({limit:+t.limit,offset:+t.offset,applicationIds:t.filterApplicationId,eventTypeName:t.filterEventFilterName,bundleId:t.filterBundleId,sortBy:`${t.sortColumn}:${t.sortDirection}`})},U=(0,M.validationResponseTransformer)((e=>200===e.status?(0,M.validatedResponse)("eventTypesArray",200,{...e.value,data:(0,V.Jc)(e.value.data)},e.errors):e)),$=e=>(0,o.useTransformQueryResponse)((0,C.useQuery)(Z(e)),U),H=(0,M.validationResponseTransformer)((e=>200===e.status?(0,M.validatedResponse)("BehaviorGroupId",200,e.value.map((e=>e.id)),e.errors):e));var q=T.B.NotificationResourceUpdateEventTypeBehaviors;const Y=(e,t)=>q.actionCreator({body:t,eventTypeId:e}),z=(0,M.validationResponseTransformer)((e=>{if("CreateBehaviorGroupResponse"===e.type){const t={id:e.value.id,displayName:e.value.display_name,bundleId:e.value.bundle_id,isDefault:!1,bundleName:void 0,actions:[],events:[]};return(0,M.validatedResponse)("BehaviorGroup",e.status,t,e.errors)}return e})),W=e=>"id"in e?T.B.NotificationResourceUpdateBehaviorGroup.actionCreator({id:e.id,body:{display_name:e.displayName,endpoint_ids:e.endpointIds,event_type_ids:e.eventTypesIds}}):T.B.NotificationResourceCreateBehaviorGroup.actionCreator({body:{bundle_id:e.bundleId,display_name:e.displayName,endpoint_ids:e.endpointIds,event_type_ids:e.eventTypesIds}}),Q=()=>(0,o.useTransformQueryResponse)((0,C.useMutation)(W),z),j=e=>T.B.NotificationResourceUpdateBehaviorGroupActions.actionCreator({behaviorGroupId:e.behaviorGroupId,body:e.endpointIds});var K=n(5543),J=n(73091);const X={advisor:"*",policies:"*",drift:"*",compliance:"*","malware-detection":"*",patch:"*",vulnerability:"*"},ee=()=>{const e=(()=>{const{query:e}=(0,C.useClient)(),t=async n=>{var a;n||(n=o.Page.defaultPage().withSort(o.Sort.by("application",o.Direction.ASCENDING)));const{errorObject:l,payload:i}=await e(Z(n));if(l)throw l;if("PageEventType"===(null==i?void 0:i.type)){const e=null===(a=null==i?void 0:i.value)||void 0===a?void 0:a.data;return 0===e.length?[]:[...e,...await t(n.nextPage())]}throw new Error(`Unknow payload type for eventTypes ${null==i?void 0:i.type}`)};return t})(),t=(0,C.useClient)(),n=(()=>{const e=(0,C.useClient)();return async t=>{const{errorObject:n,payload:a}=await e.query((e=>T.B.NotificationResourceGetLinkedBehaviorGroups.actionCreator({eventTypeId:e}))(t));if(n)throw n;return H(a)}})(),a=async(e,a)=>{const l=[...(await n(e.id)).value,a.id],{payload:i,errorObject:o,error:r}=await t.query(Y(e.id,l));if(o)throw o;if(r)throw new Error(`Unsuccessful linking of event type ${e.id}`);return i};return async(t,n,l)=>{var i;const o=(await e()).filter((e=>{if(!(null==e?void 0:e.application))return!1;if(e.application.bundle_id!==t.bundleId)return!1;const a=n[e.application.name];return!(!a||"*"!==a&&!a.includes(e.name))}));for(const e of o){l(`  ${null===(i=e.application)||void 0===i?void 0:i.display_name} - ${e.display_name}...`);try{await a(e,t),l(" ASSOCIATED\n","pf-u-success-color-200")}catch(e){l(" ERROR!\n","pf-u-danger-color-200"),console.log(e)}}}},te=(0,B.Z_)().url().test("has-no-path","URL contains path or parameters",(e=>{let t;try{t=new URL(e)}catch{return!1}return("/"===t.pathname||""===t.pathname)&&""===t.search})),ne=({setStep:e,stepIsInProgress:t,setStepIsInProgress:n,stepVariant:l,setStepVariant:i,hecToken:r,setHecToken:u,splunkServerHostName:d,setHostName:m,automationLogs:p,setAutomationLogs:E,setError:v})=>{const g=(()=>{const e=(()=>{const{mutate:e}=(0,K.TK)();return async({integrationName:t,splunkServerHostName:n,hecToken:a})=>{const l={type:J.WN.SPLUNK,name:t,url:n,secretToken:a,isEnabled:!0,sslVerificationEnabled:!0},{payload:i,error:o,errorObject:r}=await e(l);if(r)throw r;if(o)throw new Error(`Error when creating integration ${t}`);return null==i?void 0:i.value}})(),t=(()=>{const{mutate:e}=Q(),t=(()=>{const{query:e}=S(!1,!1);return async t=>{const n=await e(),a=n.payload;if(n.errorObject)throw n.errorObject;if(n.error||!a)throw new Error(`Unable to retrieve bundles, status ${a.status}`);return a.value.find((e=>e.name===t))}})();return async({behaviorGroupName:n,bundleName:a})=>{const l=await t(a);if(!l)throw new Error(`Unable to find bundle ${a}`);const i={bundleId:l.id,displayName:n,actions:[],events:[]},{payload:o,error:r,errorObject:s}=await e(i);if(s)throw s;if(r)throw new Error(`Error when creating behavior group ${n}`);return null==o?void 0:o.value}})(),n=(()=>{const{mutate:e}=(0,C.useMutation)(j);return async(t,n)=>{const a=t.actions||[];a.push(n.id);const l={behaviorGroupId:t.id,endpointIds:a},{payload:i,error:o,errorObject:r}=await e(l);if(r)throw r;if(o)throw new Error(`Error when linking behavior group ${t.id} with integration ${n.id}`);return null==i?void 0:i.value}})(),a=ee();return async({hecToken:l,splunkServerHostName:i},o)=>{const r="SPLUNK_AUTOMATION",s="SPLUNK_AUTOMATION_GROUP",c=X;o(`Creating Integration ${r}...`);const u=await e({integrationName:r,hecToken:l,splunkServerHostName:i});o(" OK","pf-u-success-color-200"),o(`\nCreating Behavior Group ${s}...`);const d=await t({behaviorGroupName:s,bundleName:"rhel"});o(" OK","pf-u-success-color-200"),o("\nAssociating integration as an action for the behavior group..."),await n(d,u),o(" OK","pf-u-success-color-200"),o("\n\nAssociating events to the behavior group:\n"),await a(d,c,o)}})(),[h,f]=(0,s.useState)(!0),[y,b]=(0,s.useState)(a.ValidatedOptions.default),[T,k]=(0,s.useState)(a.ValidatedOptions.default);(0,s.useEffect)((()=>{[y,T].every((e=>e===a.ValidatedOptions.success))?f(!1):f(!0)}),[y,T]);const I=(e,t)=>{let n=e;t&&(n=c().createElement("span",{className:t},e)),E((e=>[...e,n]))};return c().createElement(a.Grid,null,c().createElement(a.GridItem,{span:6},c().createElement(a.Form,{className:"pf-u-mr-md"},c().createElement(a.FormGroup,{label:"Splunk HEC URL",labelIcon:c().createElement(a.Popover,{headerContent:c().createElement("div",null,"The server ",c().createElement("b",null,"hostname/IP Address")," and ",c().createElement("b",null,"port")," of your splunk HTTP Event Collector"),bodyContent:c().createElement("div",null,"For Splunk Enterprise the port is by default 8088.",c().createElement("br",null),"For Splunk Cloud Platform see"," ",c().createElement("a",{target:"_blank",rel:"noreferrer",href:"https://docs.splunk.com/Documentation/SplunkCloud/latest/Data/UsetheHTTPEventCollector#Send_data_to_HTTP_Event_Collector"},"documentation"),".")},c().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"splunk-server-hostname",className:"pf-c-form__group-label-help"},c().createElement(O.HelpIcon,{noVerticalAlign:!0}))),isRequired:!0,fieldId:"splunk-server-hostname",helperTextInvalid:"Invalid URL. Example: https://hostname:8088",validated:y},c().createElement(a.TextInput,{isRequired:!0,type:"text",id:"splunk-server-hostname",name:"splunk-server-hostname","aria-describedby":"splunk-server-hostname-helper",value:d,validated:y,onChange:async e=>{if(m(e),""===e)b(a.ValidatedOptions.default);else{const t=await te.isValid(e);b(t?a.ValidatedOptions.success:a.ValidatedOptions.error)}}})),c().createElement(a.FormGroup,{label:"Splunk HEC Token",fieldId:"splunk-hec-token",isRequired:!0,helperTextInvalid:"Invalid HEC token. Example: 123e4567-e89b-12d3-a456-426614174000",validated:T},c().createElement(a.TextInput,{isRequired:!0,type:"text",id:"splunk-hec-token",name:"splunk-hec-token","aria-describedby":"splunk-hec-token-helper",validated:T,value:r,onChange:async e=>{if(u(e),""===e)k(a.ValidatedOptions.default);else{const t=await(0,B.Z_)().uuid().isValid(e);k(t?a.ValidatedOptions.success:a.ValidatedOptions.error)}}})),c().createElement(a.ActionGroup,null,c().createElement(ae,{onStart:async()=>{n(!0),E([]);try{await g({hecToken:r,splunkServerHostName:d},I)}catch(e){return I(`\n${e}`,"pf-u-danger-color-200"),n(!1),i("danger"),(0,o.addDangerNotification)("Configuration failed",c().createElement(le,null),!0),void v(e)}f(!1),n(!1),i("success"),I("\nDONE!","pf-u-success-color-200")},onFinish:()=>{e((e=>e+1))},stepIsInProgress:t,stepVariant:l,isDisabled:h})))),c().createElement(a.GridItem,{span:6},c().createElement(a.CodeBlock,null,c().createElement(a.CodeBlockCode,null,p))))},ae=({onStart:e,onFinish:t,stepIsInProgress:n,stepVariant:l,isDisabled:i})=>n?c().createElement(a.Button,{variant:"primary",isLoading:!0},"Configuration in progress"):"success"===l||"danger"===l?c().createElement(a.Button,{variant:"primary",onClick:t},"success"===l?c().createElement(O.CheckCircleIcon,null):c().createElement(O.ExclamationCircleIcon,null)," ","Next: Review"):c().createElement(a.Button,{variant:"primary",isDisabled:i,onClick:e},"Run Configuration"),le=()=>c().createElement(c().Fragment,null,c().createElement("p",{className:"pf-u-mb-md"},"There was a problem processing the request. Please try again. If the problem persists, contact Red Hat support by opening the ticket."),c().createElement(a.List,{variant:a.ListVariant.inline},c().createElement(a.ListItem,null,c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:x},"Open a Red Hat Support ticket")),c().createElement(a.ListItem,null,c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:F},"Go to documentation")))),ie=()=>c().createElement(c().Fragment,null,c().createElement(h(),{title:c().createElement(c().Fragment,null,A.V.pages.splunk.page.title,c().createElement(a.Popover,{bodyContent:A.V.pages.splunk.page.help,footerContent:c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:F},"Learn more ",c().createElement(O.ExternalLinkSquareAltIcon,null))},c().createElement(a.Button,{variant:"plain","aria-label":"Help description",className:"title-help-label"},c().createElement(O.HelpIcon,{noVerticalAlign:!0}))))}),A.V.pages.splunk.page.description);var oe=n(46242);const re=({to:e,...t})=>{const{getBundle:n}=(0,i.Z)();return s.createElement(m.Link,{to:`/${n()}/notifications${e}`},s.createElement(a.Button,{...t},t.children))};var se,ce=n(47435),ue=n(29422),de=n(313),me=n(42699),pe=n(23855),Ee=n(37950),ve=n(18172),ge=n(8813);!function(e){e.TODAY="today",e.YESTERDAY="yesterday",e.LAST_7="last_7",e.LAST_14="last_14",e.CUSTOM="custom"}(se||(se={}));const he={[se.TODAY]:"Today",[se.YESTERDAY]:"Yesterday",[se.LAST_7]:"Last 7 days",[se.LAST_14]:"Last 14 days",[se.CUSTOM]:"Custom"},fe=(0,ge.style)({backgroundColor:(0,ce.important)("white"),cursor:"pointer",$nest:{"&::placeholder":{color:(0,ce.important)("black")},"&:hover":{borderBottomColor:"var(--pf-v5-global--active-color--100)"}}});class ye{constructor(e){this.value=e}toString(){return he[this.value]}compareTo(e){return e instanceof ye&&e.value===this.value}}const be={isReadOnly:!0,className:fe},Ce=e=>{const t=s.useMemo((()=>new Date),[]),n=s.useMemo((()=>(0,ue.Z)(t,{days:-14})),[t]),l=s.useMemo((()=>[a=>(0,de.Z)(a,n)?"Date is before the retention policy":(0,me.Z)(a,t)?"Date is after today":e.period[1]&&(0,me.Z)(a,e.period[1])?"Start date must be before end date":""]),[n,t,e.period]),i=s.useMemo((()=>[a=>(0,de.Z)(a,n)?"Date is before the retention policy":(0,me.Z)(a,t)?"Date is after today":e.period[0]&&(0,de.Z)(a,e.period[0])?"End date must be after start date":""]),[n,t,e.period]),o=s.useCallback((n=>{const a=e.setPeriod,l=(0,pe.Z)(n);a((0,ve.ZP)((e=>{e[0]=l,e[1]||(e[1]=(0,Ee.Z)([(0,ue.Z)(l,{days:1}),t]))})))}),[e.setPeriod,t]),c=s.useCallback((t=>{(0,e.setPeriod)((0,ve.ZP)((e=>{e[1]=(0,pe.Z)(t)})))}),[e.setPeriod]),u=s.useMemo((()=>e.period[0]?(0,r.Z)(e.period[0],"yyyy-MM-dd"):void 0),[e.period]),d=s.useMemo((()=>e.period[1]?(0,r.Z)(e.period[1],"yyyy-MM-dd"):void 0),[e.period]),m=(0,s.useRef)(null),p=(0,s.useRef)(null),E=s.useCallback((()=>{var e;null===(e=m.current)||void 0===e||e.setCalendarOpen(!0)}),[m]),v=s.useCallback((()=>{var e;null===(e=p.current)||void 0===e||e.setCalendarOpen(!0)}),[p]),g=s.useMemo((()=>({...be,onClick:E})),[E]),h=s.useMemo((()=>({...be,onClick:v})),[v]);return s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.DatePicker,{placeholder:"Start",inputProps:g,validators:l,onChange:o,value:u,ref:m})),s.createElement(a.SplitItem,{className:"pf-v5-u-align-self-center pf-v5-u-px-sm pf-v5-u-color-300"},"to"),s.createElement(a.SplitItem,null,s.createElement(a.DatePicker,{placeholder:"End",inputProps:h,validators:i,onChange:c,value:d,ref:p})))},Te=e=>{const t=s.useMemo((()=>Object.values(se).map((e=>s.createElement(a.SelectOption,{key:e,value:new ye(e)})))),[]),[n,l]=s.useState(!1),i=s.useCallback((()=>l((e=>!e))),[l]),o=s.useMemo((()=>new ye(e.value)),[e.value]),r=s.useCallback(((t,n)=>{const a=e.setValue;n instanceof ye&&(a(n.value),l(!1))}),[e.setValue]);return s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.Select,{isOpen:n,variant:a.SelectVariant.single,onToggle:i,selections:o,onSelect:r},t)),e.value===se.CUSTOM&&s.createElement(a.SplitItem,null,s.createElement(Ce,{period:e.period,setPeriod:e.setPeriod,retentionDays:e.retentionDays})))};var Se=n(76871),ke=n(64107),Ie=n(71652),Ne=n(51622);const we=e=>"string"==typeof e?s.createElement(a.TextContent,null,s.createElement(a.Text,{component:"h6"},e)):e,De=e=>s.createElement(a.Popover,{hasAutoWidth:!0,headerContent:we(e.title),bodyContent:s.createElement(Ne.W,{tableBody:e.tableBody})},s.createElement(s.Fragment,null,e.children));var Ae=n(12990),Le=n(4088),Pe=n(32564),Oe=n(54971);const Fe=()=>s.createElement(Oe.q,{text:"Failure"},s.createElement(O.ExclamationCircleIcon,{"data-testid":"fail-icon",color:Ae.Q.value})),xe=()=>s.createElement(Oe.q,{text:"Unknown"},s.createElement(O.UnknownIcon,{"data-testid":"unknown-icon"})),Re=()=>s.createElement(Oe.q,{text:"Processing"},s.createElement(O.InProgressIcon,{"data-testid":"in-progress-icon"})),Ge=()=>s.createElement(Oe.q,{text:"Sent"},s.createElement(O.CheckCircleIcon,{"data-testid":"success-icon",color:Le.g.value})),_e=()=>s.createElement(Oe.q,{text:"Success"},s.createElement(O.CheckCircleIcon,{"data-testid":"success-icon",color:Le.g.value})),Be=()=>s.createElement(Oe.q,{text:"Warning"},s.createElement(O.ExclamationTriangleIcon,{color:Pe.k.value})),Me=[[s.createElement(_e,{key:"status-success"}),"The notification was executed successfully"],[s.createElement(Ge,{key:"status-sent"}),"The notification was sent for processing - but there is no way to assert if it was executed successfully"],[s.createElement(Be,{key:"status-warning"}),"The notification was executed successfully after some retries"],[s.createElement(Re,{key:"status-processing"}),"The notification was sent for processing and is awaiting an outcome result"],[s.createElement(Fe,{key:"status-failed-externally"}),"An unexpected error occurred while processing the notification"]],Ve=e=>s.createElement(De,{title:"Action status meaning",tableBody:Me},s.createElement(s.Fragment,null,e.children));var Ze=n(21095);const Ue=(0,ge.style)({minWidth:(0,ce.important)("90px")}),$e=e=>{const{action:{id:t},getIntegrationRecipient:n}=e,l=(0,Ze.Z)((async()=>t&&n(t)),[t,n]);return s.createElement(Se.TableComposable,{borders:!1,variant:Se.TableVariant.compact,isStickyHeader:!0},s.createElement(Se.Thead,null,s.createElement(Se.Tr,null,s.createElement(Se.Th,{className:Ue},"Action"),s.createElement(Se.Th,{className:Ue},"Recipient"),s.createElement(Se.Th,{className:Ue},"Status"))),s.createElement(Se.Tbody,null,s.createElement(Se.Tr,null,s.createElement(Se.Td,null,E.ZP.integrations.types[e.action.endpointType].action),s.createElement(Se.Td,null,t?l.loading?s.createElement(a.Skeleton,{width:"150px"}):l.value:s.createElement(a.Tooltip,{content:"The integration no longer exists, it could have been deleted."},s.createElement("span",null,"Unknown integration"))),s.createElement(Se.Td,null,s.createElement("div",null,(e=>{switch(e.last){case"SUCCESS":return e.isDegraded?s.createElement(Be,null):s.createElement(_e,null);case"SENT":return s.createElement(Ge,null);case"PROCESSING":return s.createElement(Re,null);case"FAILED":return s.createElement(Fe,null);case"UNKNOWN":return s.createElement(xe,null);default:(0,oe.ZP)(e.last)}})(e.action.status)),e.action.successCount>1&&s.createElement("div",{className:"pf-v5-u-color-300"},e.action.successCount," ",e.action.endpointType===J.WN.EMAIL_SUBSCRIPTION?"emails sent":"succeeded"," "),e.action.errorCount>1&&s.createElement("div",{className:"pf-v5-u-color-300"},e.action.errorCount," ",e.action.endpointType===J.WN.EMAIL_SUBSCRIPTION?"emails failed":"failed"," ")))))};var He;!function(e){e[e.EVENT=0]="EVENT",e[e.SERVICE=1]="SERVICE",e[e.DATE=2]="DATE"}(He||(He={}));const qe=(0,ge.style)({cursor:"pointer"}),Ye=e=>{switch(e.last){case"FAILED":return{color:"red",icon:s.createElement(O.ExclamationCircleIcon,null)};case"SENT":case"SUCCESS":return e.isDegraded?{color:"orange",icon:s.createElement(O.ExclamationTriangleIcon,null)}:{color:"green",icon:s.createElement(O.CheckCircleIcon,null)};case"PROCESSING":return{color:"grey",icon:s.createElement(O.InProgressIcon,null)};case"UNKNOWN":return{color:"grey",icon:s.createElement(O.UnknownIcon,null)};default:(0,oe.ZP)(e.last)}},ze=e=>{const t=s.useCallback(((t,n,a,l)=>{(0,e.onSort)(n,a)}),[e.onSort]),n=s.useMemo((()=>({[He.EVENT]:void 0,[He.SERVICE]:void 0,[He.DATE]:{sortBy:{direction:e.sortDirection,index:e.sortColumn},columnIndex:He.DATE,onSort:t}})),[e.sortColumn,e.sortDirection,t]),l=s.useMemo((()=>{const t=e.events;return e.loading?[...Array(10)].map(((e,t)=>s.createElement(Se.Tr,{key:`loading-row-${t}`},s.createElement(Se.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Se.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Se.Td,null,s.createElement(a.Skeleton,null)),s.createElement(Se.Td,null,s.createElement(a.Skeleton,null))))):t.map((t=>s.createElement(Se.Tr,{key:t.id},s.createElement(Se.Td,null,t.event),s.createElement(Se.Td,null,t.application," - ",t.bundle),s.createElement(Se.Td,null,t.actions.length>0?s.createElement(a.LabelGroup,null,t.actions.map((t=>s.createElement(a.Popover,{key:t.id,hasAutoWidth:!0,bodyContent:s.createElement($e,{action:t,getIntegrationRecipient:e.getIntegrationRecipient})},s.createElement(a.Label,{className:qe,...Ye(t.status)},E.ZP.integrations.types[t.endpointType].action))))):"No actions"),s.createElement(Se.Td,null,s.createElement(ke.Z,{type:"exact",date:t.date})))))}),[e.loading,e.events,e.getIntegrationRecipient]);return 0===l.length?s.createElement(Ie.G,{variant:a.EmptyStateVariant.full,title:A.V.components.eventLog.table.notFound.title,description:A.V.components.eventLog.table.notFound.description}):s.createElement(Se.TableComposable,{isStickyHeader:!0},s.createElement(Se.Thead,null,s.createElement(Se.Tr,null,s.createElement(Se.Th,{sort:n[He.EVENT]},"Event type"),s.createElement(Se.Th,{sort:n[He.SERVICE]},"Service"),s.createElement(Se.Th,null,"Action taken"," ",s.createElement(Ve,null,s.createElement(a.Button,{variant:a.ButtonVariant.plain},s.createElement(O.HelpIcon,null)))),s.createElement(Se.Th,{sort:n[He.DATE]},"Date and time"))),s.createElement(Se.Tbody,null,l))};var We=n(95809),Qe=n(69930);const je=()=>{const e=(0,o.getInsights)(),t=(0,o.getInsightsEnvironment)(e);return(0,E.Lk)(t)};var Ke,Je=n(56437),Xe=n(37869);!function(e){e.EVENT="event",e.BUNDLE="bundle",e.SERVICE="service",e.ACTION_TYPE="endpointTypes",e.ACTION_STATUS="status"}(Ke||(Ke={}));const et=(e,t,n)=>!(!e||!t)&&(e===t||e.length===t.length&&e.every(((a,l)=>!!(n&&t.includes(a)||!n&&e[l]===t[l])))),tt=e=>!!e.checkProps.checked,nt=e=>e.children?e.children.some((e=>nt(e))):tt(e),at=e=>e.children?e.children.every((e=>at(e))):tt(e),lt=e=>{const{groups:t,placeholder:n,filters:l,updateFilters:i}=e,o=c().useMemo((()=>((e,t)=>{const n={};return e.forEach((e=>{var a;const l=t.find((t=>t.bundleId===e.name)),i=null===(a=null==l?void 0:l.chips)||void 0===a?void 0:a.map((e=>e.value)),o=e.children,r=0!==o.length&&o.every((e=>null==i?void 0:i.includes(e.name)));n[e.name]={id:e.name,name:e.displayName,checkProps:{checked:r||!!l&&null},children:0!==o.length?o.map((e=>({id:e.name,name:e.displayName,checkProps:{checked:r||(null==i?void 0:i.includes(e.name))}}))):void 0}})),n})(t,l)),[t,l]),[r,s]=c().useState(o),[u,d]=c().useState(!1),m=c().useMemo((()=>Object.values(r)),[r]),[p,E]=c().useMemo((()=>{const e=[];return[m.filter((e=>e.checkProps.checked||null===e.checkProps.checked)).map((t=>{var n,a;return e.push(t.id),{bundleId:t.id,category:t.name,chips:null!==(a=null===(n=t.children)||void 0===n?void 0:n.filter((e=>e.checkProps.checked)).map((e=>({name:e.name,value:e.id,isRead:!0}))))&&void 0!==a?a:[{name:t.name,value:t.id,isRead:!0}]}})),e]}),[m]);return c().useEffect((()=>{0!==t.length&&s((0,ve.ZP)((e=>0===Object.keys(e).length||0===l.length?o:void l.forEach((t=>{var n;const a=e[t.bundleId],l=t.chips.map((e=>e.value));null===(n=a.children)||void 0===n||n.forEach((e=>{e.checkProps.checked=l.includes(e.id)})),at(a)?a.checkProps.checked=!0:nt(a)?a.checkProps.checked=null:a.checkProps.checked=!1})))))}),[t,l,o]),c().useEffect((()=>{i((0,ve.ZP)((e=>{if(0===e.length&&0===p.length)return e;if(0!==e.length&&0===p.length)return[];{const t=e.map((e=>e.bundleId));return et(t,E)&&p.every(((t,n)=>{if(e[n]&&t.bundleId===e[n].bundleId){const a=e[n].chips.map((e=>e.value)),l=t.chips.map((e=>e.value));return et(a,l,!0)}return!1}))?e:p}})))}),[p,E,i]),c().createElement(a.Dropdown,{toggle:c().createElement(a.DropdownToggle,{onToggle:()=>d(!u),toggleIndicator:O.AngleDownIcon},n),isOpen:u},c().createElement(a.TreeView,{data:m,hasChecks:!0,onCheck:(e,t,n)=>{((e,t,n)=>{const a=e.target.checked;s((0,ve.ZP)((e=>{var l;if(n){const l=e[n.id].children;null==l||l.some((e=>e.id===t.id&&(e.checkProps.checked=a,!0))),at(e[n.id])?e[n.id].checkProps.checked=!0:nt(e[n.id])?e[n.id].checkProps.checked=null:e[n.id].checkProps.checked=a}else e[t.id].checkProps.checked=a,null===(l=e[t.id].children)||void 0===l||l.forEach((e=>e.checkProps.checked=a))})))})(e,t,n)}}))},it={[Je.k$.EMAIL_SUBSCRIPTION]:{name:"Email"},[Je.k$.DRAWER]:{name:"Drawer"},[Je.k$.INTEGRATION]:{name:"Integration"}},ot=[{value:"SUCCESS",chipValue:"Success",label:s.createElement("span",null,s.createElement(O.CheckCircleIcon,{color:"green"})," Success")},{value:"SENT",chipValue:"Sent",label:s.createElement("span",null,s.createElement(O.CheckCircleIcon,{color:"green"})," Sent")},{value:"UNKNOWN",chipValue:"Warning",label:s.createElement("span",null,s.createElement(O.ExclamationTriangleIcon,{className:"pf-v5-u-warning-color-100"})," ","Warning"," ")},{value:"PROCESSING",chipValue:"Processing",label:s.createElement("span",null,s.createElement(O.InProgressIcon,null)," Processing"," ")},{value:"FAILED",chipValue:"Failure",label:s.createElement("span",null,s.createElement(O.ExclamationCircleIcon,{color:"red"})," Failure")}],rt=e=>{const t=je(),n=(0,Qe.N)(),l=s.useMemo((()=>t.map((e=>({value:e.toUpperCase(),chipValue:it[e].name,label:it[e].name}))).concat(n.map((e=>({value:e.toUpperCase(),chipValue:E.ZP.integrations.types[e].name,label:E.ZP.integrations.types[e].name}))))),[t,n]),i=s.useMemo((()=>({[Ke.EVENT]:{label:"Event",placeholder:"Filter by event"},[Ke.SERVICE]:{label:"Service",placeholder:"Filter by service"},[Ke.ACTION_TYPE]:{label:"Action Type",placeholder:"Filter by action type",options:{exclusive:!1,items:l}},[Ke.ACTION_STATUS]:{label:"Action Status",placeholder:"Filter by action status",options:{exclusive:!1,items:ot}}})),[l]),r=((e,t,n,a,l)=>{const[i,r]=c().useState([]),s=(0,o.usePrimaryToolbarFilterConfig)(Ke,t,n,a,l),u=c().useMemo((()=>s.activeFiltersConfig.onDelete),[s.activeFiltersConfig.onDelete]),d=c().useCallback(((e,t)=>{const n=[],a=[];t.forEach((e=>{e.bundleId?a.push(e):n.push(e)})),u(e,n),0!==a.length&&r((0,ve.ZP)((e=>{const t=[];e.forEach(((e,n)=>{a.some((a=>{if(e.bundleId===a.bundleId){const l=a.chips.map((e=>e.value));return e.chips=e.chips.filter((e=>!l.includes(e.value))),0===e.chips.length&&t.push(n),!0}return!1}))})),t.forEach(((t,n)=>{e.splice(t-n,1)}))})))}),[u,r]),m=c().useCallback(((e,t)=>{var n,a;const l=(e,t,n)=>({bundleId:e,category:(null==t?void 0:t.displayName)||`${e} Loading...`,chips:(null==t?void 0:t.children)?0!==(null==n?void 0:n.length)?null==n?void 0:n.map((e=>({name:e.displayName,value:e.name,isRead:!0}))):[{name:t.displayName,value:t.name,isRead:!0}]:[{name:"Loading",value:e,isRead:!0}]}),i={};null===(n=e.service)||void 0===n||n.forEach((e=>{const t=e.split("."),n=t[0],a=t[1];i[n]?i[n].push(a):i[n]=[a]}));const o=Object.keys(i).map((e=>{var n;const a=null==t?void 0:t.find((t=>t.name===e)),o=null===(n=null==a?void 0:a.children)||void 0===n?void 0:n.filter((t=>i[e].includes(t.name)));return l(e,a,o)}));return((null===(a=e.bundle)||void 0===a?void 0:a.map((e=>{const n=null==t?void 0:t.find((t=>t.name===e));return l(e,n,null==n?void 0:n.children)})))||[]).concat(o)}),[]);c().useEffect((()=>{r(m(t,0!==e.length?e:void 0))}),[e,m]);const p=c().useMemo((()=>({label:"Service",type:"custom",filterValues:{children:c().createElement(lt,{groups:e,placeholder:"Filter by service",filters:i,updateFilters:r})}})),[e,i]),E=c().useMemo((()=>s.activeFiltersConfig.filters.filter((e=>e&&!e.bundleId)).concat(i)),[i,s.activeFiltersConfig.filters]),v=c().useMemo((()=>(0,ve.ZP)(t.bundle,(t=>{if(0===e.length)return;const n=[];return e.forEach((e=>{i.some((t=>{var n,a;return t.bundleId===e.name&&(0===(null===(n=e.children)||void 0===n?void 0:n.length)&&1===t.chips.length||(null===(a=e.children)||void 0===a?void 0:a.length)===t.chips.length)}))&&n.push(e.name)})),et(t,n,!0)?t:n}))),[e,t.bundle,i]);return n.bundle(v),(0,ve.ZP)(s,(e=>{e.filterConfig.items[1]=p,e.activeFiltersConfig.filters=E,e.activeFiltersConfig.onDelete=d}))})(e.bundleOptions,e.filters,e.setFilters,e.clearFilter,i),u=s.useCallback(((t,n)=>{(0,e.pageChanged)(n)}),[e.pageChanged]),d=s.useCallback(((t,n)=>{(0,e.perPageChanged)(n)}),[e.perPageChanged]),m=s.useMemo((()=>({itemCount:e.count,page:e.page,perPage:e.perPage,isCompact:!0,variant:a.PaginationVariant.top,onSetPage:u,onFirstClick:u,onPreviousClick:u,onNextClick:u,onLastClick:u,onPageInput:u,onPerPageSelect:d})),[e.count,e.page,e.perPage,u,d]),p=s.useMemo((()=>({...m,isCompact:!1,variant:a.PaginationVariant.bottom})),[m]);return s.createElement("div",{...(0,Xe.k)("Notifications/EventLog/DualToolbar",e)},s.createElement(We.Z,{...r,filterConfig:r.filterConfig,activeFiltersConfig:r.activeFiltersConfig,dedicatedAction:s.createElement(Te,{value:e.dateFilter,setValue:e.setDateFilter,retentionDays:e.retentionDays,setPeriod:e.setPeriod,period:e.period}),pagination:m}),e.children,s.createElement(We.Z,{pagination:p}))},st=e=>s.createElement(v.Z,{className:"pf-v5-u-pb-md"},s.createElement(a.Split,null,s.createElement(a.SplitItem,{isFilled:!0},s.createElement(h(),{title:e.title}),s.createElement(a.TextContent,{className:"pf-v5-u-pt-sm"},s.createElement(a.Text,null,e.subtitle))),e.action&&s.createElement(a.SplitItem,{className:"pf-v5-u-ml-3xl"},e.action)));var ct=n(2028),ut=n(77836);const dt=e=>({id:e.id,bundle:e.bundle,application:e.application,event:e.event_type,date:(0,o.fromUtc)(new Date(e.created)),actions:mt(pt(e.actions))}),mt=e=>e.sort(((e,t)=>e.endpointType.localeCompare(t.endpointType))),pt=e=>{const t={},n=[];return e.forEach((e=>{if(e.endpoint_id)if(t[e.endpoint_id]){const n=Et(e),a=t[e.endpoint_id];vt(n.status.last)?a.status.isDegraded=!0:a.status.last=n.status.last,a.errorCount+=n.errorCount,a.successCount+=n.successCount}else t[e.endpoint_id]=Et(e);else n.push(Et(e))})),[...Object.values(t),...n]},Et=e=>{var t;return{id:null!==(t=e.endpoint_id)&&void 0!==t?t:void 0,endpointType:(0,ut.LW)({type:e.endpoint_type,sub_type:e.endpoint_sub_type}),status:{last:e.status,isDegraded:vt(e.status)},successCount:vt(e.status)?0:1,errorCount:vt(e.status)?1:0}},vt=e=>"FAILED"===e,gt=(0,M.validationResponseTransformer)((e=>200===e.status?(0,M.validatedResponse)("Events",200,{...e.value,data:e.value.data.map(dt)},e.errors):e));var ht=n(45295);const ft=e=>ht.B.EndpointResourceGetEndpoint.actionCreator({id:e});var yt=n(33479),bt=n(19013);const Ct="yyyy-MM-dd",Tt=()=>{const e=(0,d.useFlag)("platform.notifications.overhaul"),t=(0,C.useParameterizedQuery)(ft),{rbac:n}=(0,p.b)(),l=S(!0),i=s.useMemo((()=>{const e=l.payload;return 200===(null==e?void 0:e.status)?e.value:[]}),[l.payload]),[c,u]=s.useState(se.LAST_14),m=((e=250)=>{const t=(0,s.useMemo)((()=>{const e=()=>(0,o.useUrlStateMultipleOptions)("service"),t=()=>(0,o.useUrlStateMultipleOptions)("bundle"),n=()=>(0,o.useUrlStateMultipleOptions)("endpointTypes"),a=()=>(0,o.useUrlStateMultipleOptions)("status"),l=()=>(0,o.useUrlStateString)("event");return i=>{switch(i){case Ke.SERVICE:return e;case Ke.BUNDLE:return t;case Ke.EVENT:return l;case Ke.ACTION_TYPE:return n;case Ke.ACTION_STATUS:return a;default:(0,oe.ZP)(i)}}}),[]);return(0,o.useFilters)(Ke,e,t)})(),[v,g]=s.useState([void 0,void 0]),[h,f]=s.useState("desc"),[y,b]=s.useState(He.DATE),k=s.useCallback(((e,t)=>{f(t),b(e)}),[f,b]),I=((e,t,n)=>(0,s.useCallback)((a=>{const l=new o.Filter;if(null==a?void 0:a.bundle){const t=null==a?void 0:a.bundle,n=e.filter((e=>t.includes(e.name))).map((e=>e.id));l.and("bundleIds",o.Operator.EQUAL,n)}if(null==a?void 0:a.service){const t=a.service,n=[];t.forEach((t=>{var a;const l=t.split("."),i=l[0],o=l[1],r=e.find((e=>e.name===i));if(r){const e=null===(a=r.children)||void 0===a?void 0:a.find((e=>e.name===o));e&&n.push(e.id)}})),l.and("appIds",o.Operator.EQUAL,n)}(null==a?void 0:a.event)&&l.and("event",o.Operator.EQUAL,a.event),(null==a?void 0:a.status)&&l.and("status",o.Operator.EQUAL,a.status),(null==a?void 0:a.endpointTypes)&&l.and("endpointTypes",o.Operator.EQUAL,a.endpointTypes);let i=[void 0,void 0];const s=(0,o.toUtc)(new Date);switch(t){case se.LAST_14:i=[(0,yt.Z)((0,bt.Z)(s),{days:14}),s];break;case se.LAST_7:i=[(0,yt.Z)((0,bt.Z)(s),{days:7}),s];break;case se.TODAY:i=[s,s];break;case se.YESTERDAY:{const e=(0,yt.Z)((0,bt.Z)(s),{days:1});i=[e,e];break}case se.CUSTOM:i=n}return i[0]&&i[1]&&(l.and("start",o.Operator.EQUAL,(0,r.Z)(i[0],Ct)),l.and("end",o.Operator.EQUAL,(0,r.Z)(i[1],Ct))),l}),[e,t,n]))(i,c,v),N=s.useMemo((()=>{const e=h.toUpperCase();let t;if(y!==He.DATE)throw new Error(`Invalid sorting index: ${y}`);return t="created",o.Sort.by("created",e)}),[y,h]),w=(0,ct.q)(E.ZP.paging.defaultPerPage,I,m.filters,N),D=(e=>{const t=(null!=e?e:o.Page.defaultPage()).toQuery();return(0,o.useTransformQueryResponse)((0,C.useQuery)(T.B.EventResourceGetEvents.actionCreator({limit:+t.limit,offset:+t.offset,bundleIds:t.filterBundleIds,appIds:t.filterAppIds,invocationResults:t.filterInvocationResults,status:t.filterStatus,endpointTypes:t.filterEndpointTypes,startDate:t.filterStart,endDate:t.filterEnd,eventTypeDisplayName:t.filterEvent,sortBy:`${t.sortColumn}:${t.sortDirection}`,includeActions:!0})),gt)})(w.page),L=s.useMemo((()=>{var e;return 200===(null===(e=D.payload)||void 0===e?void 0:e.status)?{data:D.payload.value.data,count:D.payload.value.meta.count}:{data:[],count:0}}),[D]),P=s.useMemo((()=>{const e=m.filters.bundle;return e&&e.length>0?yl.notifications(e[0]):yl.notifications("")}),[m.filters]),O=s.useCallback((async e=>{var n;const a=t.query,l=await a(e);if("Endpoint"===(null===(n=l.payload)||void 0===n?void 0:n.type)){const e=l.payload.value.type;switch(e){case"camel":case"webhook":case"ansible":return l.payload.value.name;case"email_subscription":case"drawer":return l.payload.value.properties.only_admins?"Users: Admin":"Users: All";default:(0,oe.ZP)(e)}}return"Error while loading"}),[t.query]);return s.createElement(s.Fragment,null,s.createElement(st,{title:A.V.pages.notifications.eventLog.title,subtitle:A.V.pages.notifications.eventLog.subtitle,action:!e&&s.createElement(re,{isDisabled:!n.canReadEvents,to:P,variant:a.ButtonVariant.secondary},A.V.pages.notifications.eventLog.viewNotifications)}),s.createElement(rt,{...m,bundleOptions:i,dateFilter:c,setDateFilter:u,count:L.count,perPageChanged:w.changeItemsPerPage,pageChanged:w.changePage,perPage:w.page.size,page:w.page.index,pageCount:L.data.length,retentionDays:14,period:v,setPeriod:g},s.createElement(ze,{events:L.data,loading:D.loading,onSort:k,sortColumn:y,sortDirection:h,getIntegrationRecipient:O})))};var St=n(35664),kt=n(97481),It=n(36271);const Nt=()=>{const e=(0,It.Z)({type:"AppSkeleton"});return s.createElement("div",{...e},s.createElement(v.Z,null,s.createElement("div",{className:"pf-c-content"},s.createElement(h(),{title:s.createElement(St.Z,{size:"sm"})}))),s.createElement(D.Z,null,s.createElement(a.Bullseye,null,s.createElement(kt.Z,{centered:!0}))))},wt=e=>T.B.NotificationResourceGetApplicationsFacets.actionCreator({bundleName:e}),Dt=()=>(0,C.useParameterizedQuery)(wt);var At=n(28551),Lt=n(14748);const Pt=e=>{const[t,n]=c().useState(0),l=c().useCallback((e=>{n(e)}),[]);return c().createElement("div",{className:"pf-v5-u-background-color-100"},c().createElement(a.Tabs,{className:"pf-v5-u-pl-lg",defaultActiveKey:t,role:"region",onClick:l},e.children))};var Ot,Ft=n(91654),xt=n(96191),Rt=n(29987),Gt=n(3276);!function(e){e.ASC="asc",e.DESC="desc"}(Ot||(Ot={}));const _t=Object.freeze([]),Bt=Object.freeze({}),Mt=()=>c().createElement(a.EmptyState,{variant:"full"},c().createElement(a.EmptyStateIcon,{className:"pf-u-mb-xl",icon:O.SearchIcon}),c().createElement(a.Title,{headingLevel:"h2",size:"lg"},"No results found"),c().createElement(a.EmptyStateBody,null,c().createElement(a.TextContent,null,c().createElement(a.Text,null,"No notifications match your filter choices above. Try removing or changing the filters to see results.")))),Vt=e=>{return t=e,"id",e=>e.id===t;var t},Zt=()=>s.createElement("span",null,", "),Ut=e=>{const t=s.useCallback((()=>{const t=e.onSelect;t&&t(e.notification,e.behaviorGroup,!1)}),[e.onSelect,e.behaviorGroup,e.notification]);return s.createElement(a.Chip,{onClick:t,isReadOnly:e.behaviorGroup.isDefault},e.behaviorGroup.displayName)},$t=e=>{const[t,n]=s.useState(!1),l=s.useCallback(((t,n)=>{var a,l,i;const o=null!==(i=null===(l=null===(a=null==t?void 0:t.currentTarget)||void 0===a?void 0:a.firstChild)||void 0===l?void 0:l.dataset)&&void 0!==i?i:Bt,r=e.onSelect;if(!e.behaviorGroupContent.isLoading&&!e.behaviorGroupContent.hasError&&r){let t;if((o.behaviorGroupId||n)&&(t=e.behaviorGroupContent.content.find(Vt(o.behaviorGroupId||n)),t)){const n=!!e.selected.find(Vt(t.id));r(e.notification,t,!n)}}}),[e.onSelect,e.behaviorGroupContent,e.notification,e.selected]),i=s.useMemo((()=>e.behaviorGroupContent.isLoading||e.behaviorGroupContent.hasError?[s.createElement(a.OptionsMenuItem,{key:"is-loading",isDisabled:!0},"Loading")]:0===e.behaviorGroupContent.content.length?[s.createElement(a.OptionsMenuItem,{key:"empty",isDisabled:!0},s.createElement("span",{className:"pf-v5-u-text-align-left"},"You have no behavior groups. ",s.createElement("br",null),"Create a new group by clicking on the ",s.createElement("br",null),"'Create new group' button above."))]:[[...e.selected.filter((e=>e.isDefault)),...e.behaviorGroupContent.content.filter((e=>!e.isDefault))].map((t=>{const n=!!e.selected.find(Vt(t.id));return s.createElement(a.MenuItem,{key:t.id,hasCheck:!0,onClick:e=>l(e,t.id),"data-behavior-group-id":t.id,isSelected:n,isDisabled:t.isDefault,className:"pf-v5-u-ml-sm"},t.isDefault&&s.createElement(O.LockIcon,{className:"pf-v5-u-ml-sm"})," ",s.createElement("span",{className:"pf-v5-u-ml-sm"}," ",t.displayName))}))]),[e.behaviorGroupContent,e.selected,l]),r=s.useMemo((()=>[...e.selected.filter((e=>e.isDefault)),...e.selected.filter((e=>!e.isDefault))]),[e.selected]),c=s.useMemo((()=>s.createElement(a.OptionsMenuToggle,{onToggle:n,toggleTemplate:0===r.length?s.createElement(s.Fragment,null,s.createElement("span",{className:"pf-v5-u-disabled-color-100"},"Select behavior group"),s.createElement(a.Badge,{className:"pf-v5-u-ml-xs",isRead:!0},r.length)):s.createElement(s.Fragment,null,s.createElement(a.ChipGroup,null,r.map((t=>s.createElement(Ut,{key:t.id,behaviorGroup:t,notification:e.notification,onSelect:e.onSelect})))),s.createElement(a.Badge,{className:"pf-v5-u-ml-xs",isRead:!0},r.length))})),[r,e.notification,e.onSelect]),u=s.useMemo((()=>0===r.length?s.createElement("span",null,s.createElement(a.Icon,{className:"pf-v5-u-mr-sm pf-v5-u-disabled-color-100",isInline:!0},s.createElement(O.BellSlashIcon,null)),"Mute"):(0,o.join)(r.map((e=>s.createElement(s.Fragment,{key:e.id},e.isDefault&&s.createElement(a.Tooltip,{content:`${e.displayName} behavior is attached to this event and cannot be changed.\n                Add additional behavior groups to assign different actions or recipients.`},s.createElement(O.LockIcon,{className:"pf-v5-u-mr-sm pf-v5-u-disabled-color-100"}))," ",s.createElement(a.Label,{isCompact:!0},e.displayName)))),Zt)),[r]);return e.isEditMode?s.createElement(a.OptionsMenu,{id:e.id,direction:"down",menuItems:i,toggle:c,isOpen:t,menuAppendTo:document.body}):s.createElement(Se.TableText,{wrapModifier:"truncate"}," ",u," ")};var Ht;!function(e){e[e.EVENT=0]="EVENT",e[e.APPLICATION=1]="APPLICATION",e[e.BEHAVIOR=2]="BEHAVIOR"}(Ht||(Ht={}));const qt=(0,ge.style)({float:"right"}),Yt=()=>s.createElement(s.Fragment,null),zt=(e,t)=>{const n="done"!==e.loadingActionStatus;return e.isEditMode?{actionsToggle:Yt,items:[{key:"done",className:qt,title:s.createElement(a.Button,{"aria-label":"done",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(O.CheckIcon,{color:n?xt.J.value:Rt.h.value})),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onFinishEditing(e.id),isDisabled:n||!t},{key:"cancel",className:qt,title:s.createElement(a.Button,{"aria-label":"cancel",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(O.CloseIcon,{color:n?xt.J.value:Gt.p.value})),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onCancelEditing(e.id),isDisabled:n||!t}]}:{actionsToggle:Yt,items:[{key:"edit",className:qt,title:s.createElement(a.Button,{"aria-label":"edit",variant:a.ButtonVariant.plain,isDisabled:n},s.createElement(O.PencilAltIcon,null)),isOutsideDropdown:!0,onClick:()=>null==t?void 0:t.onStartEditing(e.id),isDisabled:n||!t}]}},Wt=((e,t)=>{var n;const a=t=>s.createElement("div",{...(0,Xe.k)("Notifications/Table",t)},s.createElement(e,{...t}));return a.displayName=`Ouia(${null!==(n=e.displayName)&&void 0!==n?n:e.name})`,a})((e=>{const t=s.useMemo((()=>{if(e.onStartEditing&&e.onFinishEditing&&e.onCancelEditing)return{onStartEditing:e.onStartEditing,onFinishEditing:e.onFinishEditing,onCancelEditing:e.onCancelEditing,onBehaviorGroupLinkUpdated:e.onBehaviorGroupLinkUpdated}}),[e.onStartEditing,e.onFinishEditing,e.onCancelEditing,e.onBehaviorGroupLinkUpdated]),n=s.useCallback(((t,n,a,l)=>{(0,e.onSort)(n,(e=>{switch(e.toLowerCase()){case Ot.ASC:return Ot.ASC;case Ot.DESC:return Ot.DESC;default:throw new Error(`Invalid sort direction ${e}`)}})(a))}),[e.onSort]),l=s.useMemo((()=>{const t={direction:e.sortDirection,index:e.sortBy};return{[Ht.EVENT]:{sortBy:t,columnIndex:Ht.EVENT,onSort:n},[Ht.APPLICATION]:{sortBy:t,columnIndex:Ht.APPLICATION,onSort:n},[Ht.BEHAVIOR]:void 0}}),[e.sortDirection,e.sortBy,n]),i=s.useMemo((()=>{const n=e.notifications,l=e.behaviorGroupContent;return n.map((e=>{var n;return s.createElement(Se.Tr,{key:e.id},s.createElement(Se.Td,null,e.eventTypeDisplayName),s.createElement(Se.Td,null,e.applicationDisplayName),s.createElement(Se.Td,null,"loading"===e.loadingActionStatus?s.createElement(a.Skeleton,{width:"90%"}):s.createElement($t,{id:`behavior-group-cell-${e.id}`,notification:e,behaviorGroupContent:l,selected:null!==(n=e.behaviors)&&void 0!==n?n:_t,onSelect:null==t?void 0:t.onBehaviorGroupLinkUpdated,isEditMode:e.isEditMode})),s.createElement(Se.Td,{actions:zt(e,t)}))}))}),[e.notifications,e.behaviorGroupContent,t]);return s.createElement(Se.TableComposable,{"aria-label":"Notifications",isStickyHeader:!0,variant:Se.TableVariant.compact,id:"configure-events-table"},s.createElement(Se.Thead,null,s.createElement(Se.Tr,null,s.createElement(Se.Th,{sort:l[Ht.EVENT]},"Event Type"),s.createElement(Se.Th,{sort:l[Ht.APPLICATION]},"Service"),s.createElement(Se.Th,{sort:l[Ht.BEHAVIOR],width:35},"Configuration"),s.createElement(Se.Th,null))),s.createElement(Se.Tbody,null,0===e.notifications.length?s.createElement(Mt,null):i))}));var Qt,jt,Kt=n(55490),Jt=n(58399);!function(e){e.NAME="name",e.APPLICATION="application",e.ACTION="action"}(Qt||(Qt={})),function(e){e[e.NONE=0]="NONE",e[e.PAGE=1]="PAGE",e[e.ALL=2]="ALL"}(jt||(jt={}));const Xt=[Qt.NAME,Qt.APPLICATION,Qt.ACTION],en=e=>{var t;const n=(0,o.getInsights)(),l=null!==(t=e.filterColumns)&&void 0!==t?t:Xt,i=(0,s.useMemo)((()=>{const t=e.appFilterOptions.map((e=>({value:e.displayName,label:s.createElement(s.Fragment,null," ",e.displayName)})));return{[Qt.NAME]:l.includes(Qt.NAME)?{label:"Event type",placeholder:"Filter by event type"}:void 0,[Qt.APPLICATION]:l.includes(Qt.APPLICATION)?{label:"Service",placeholder:"Filter by service",options:{exclusive:!1,default:[],items:t}}:void 0,[Qt.ACTION]:l.includes(Qt.ACTION)&&(0,Jt.Zg)(n)?{label:"Action",placeholder:"Filter by action"}:void 0}}),[e.appFilterOptions,n,l]),r=s.useMemo((()=>{var t;const n=e.onSelectionChanged,a=e.count,l=e.pageAdapter,i=e.selectedCount,o=l.page.size;if(!n)return;const r=()=>n(jt.ALL),s=()=>n(jt.NONE);return{count:null!=i?i:0,items:[{title:"Select none (0)",onClick:s},{title:`Select page (${null!==(t=e.pageCount)&&void 0!==t?t:o})`,onClick:()=>n(jt.PAGE)},{title:`Select all (${a})`,onClick:r}],checked:0!==i&&i===a,onSelect:e=>e?r():s(),isDisabled:e.bulkSelectionDisabled}}),[e.onSelectionChanged,e.selectedCount,e.pageAdapter,e.count,e.bulkSelectionDisabled,e.pageCount]),c=(0,o.usePrimaryToolbarFilterConfig)(Qt,e.filters,e.setFilters,e.clearFilter,i),u=(0,Kt.B)(e.onExport),d=c.filterConfig,m=c.activeFiltersConfig,p=(0,o.useInsightsEnvironmentFlag)((0,o.getInsights)(),Jt._n,void 0,(0,s.useCallback)((()=>u),[u])),E=s.useCallback(((t,n)=>{(0,e.pageAdapter.changePage)(n)}),[e.pageAdapter]),v=s.useCallback(((t,n)=>{(0,e.pageAdapter.changeItemsPerPage)(n)}),[e.pageAdapter]),g=s.useMemo((()=>({itemCount:e.count,page:e.pageAdapter.page.index,perPage:e.pageAdapter.page.size,isCompact:!0,variant:a.PaginationVariant.top,onSetPage:E,onFirstClick:E,onPreviousClick:E,onNextClick:E,onLastClick:E,onPageInput:E,onPerPageSelect:v})),[e.count,e.pageAdapter,E,v]),h=s.useMemo((()=>({...g,isCompact:!1,variant:a.PaginationVariant.bottom})),[g]);return s.createElement("div",{...(0,Xe.k)("Notifications/DualToolbar",e)},s.createElement(We.Z,{bulkSelect:r,filterConfig:d,activeFiltersConfig:m,exportConfig:p,pagination:g}),e.children,s.createElement(We.Z,{pagination:h}))},tn=(e,t,n)=>{const a=((e,t,n=250)=>{const a=(0,s.useMemo)((()=>{const n=e=>(0,o.useUrlStateString)("name",e),a=t=>(0,o.useUrlStateMultipleOptions)("app",e,t),l=e=>(0,o.useUrlStateString)("action",e);return e=>{switch(e){case Qt.NAME:return t?n:s.useState;case Qt.ACTION:return t?l:s.useState;case Qt.APPLICATION:return t?a:s.useState;default:(0,oe.vE)(e)}}}),[]);return(0,o.useFilters)(Qt,n,a)})(t.map((e=>e.displayName.toString())),n),l=((e,t)=>(0,s.useCallback)((n=>{const a=new o.Filter,l=n&&n[Qt.APPLICATION];if(l){const e=[];for(const n of(0,o.arrayValue)(l)){const a=t.find((e=>e.displayName===n));a&&e.push(a.id)}a.and("applicationId",o.Operator.EQUAL,e)}a.and("bundleId",o.Operator.EQUAL,e.id);const i=n&&n[Qt.NAME];if(i){const e=(0,o.stringValue)(i);a.and("eventFilterName",o.Operator.EQUAL,e)}return a}),[e,t]))(e,t),[i,r]=s.useState({sortDirection:Ot.ASC,sortBy:Ht.APPLICATION}),c=s.useCallback(((e,t)=>{r({sortBy:e,sortDirection:t})}),[r]),u=s.useMemo((()=>{const e=i.sortDirection.toUpperCase();let t;switch(i.sortBy){case Ht.APPLICATION:t="application";break;case Ht.EVENT:t="display_name";break;default:throw new Error(`Invalid sorting index: ${i.sortBy}`)}return o.Sort.by(t,e)}),[i]);return{pageController:(0,ct.q)(E.ZP.paging.defaultPerPage,l,a.filters,u),onSort:c,sortBy:i.sortBy,sortDirection:i.sortDirection,filters:a.filters,setFilters:a.setFilters,clearFilters:a.clearFilter}};var nn=n(36853);const an=n.p+"fonts/WebhookIcon.svg",ln=(0,ge.style)({verticalAlign:"-0.125em",width:"1em",height:"1em"}),on=()=>s.createElement("img",{alt:"Webhook",className:ln,src:an}),rn=e=>{switch(e.actionType){case Je.k$.DRAWER:return s.createElement(nn.ZP,null);case Je.k$.EMAIL_SUBSCRIPTION:return s.createElement(O.EnvelopeIcon,null);case Je.k$.INTEGRATION:return s.createElement(on,null);default:(0,oe.vE)(e.actionType)}},sn=e=>s.createElement("div",{...(0,Xe.k)("Notifications/ActionComponent",e)},e.children),cn=e=>e.loading?s.createElement(sn,{...e},s.createElement(a.Spinner,{size:"md"})):e.hasError?s.createElement(sn,{...e},s.createElement("span",null,"Error loading actions")):e.action?s.createElement(sn,{...e},s.createElement(rn,{actionType:e.action.type}),s.createElement("span",{className:"pf-v5-u-ml-sm"},E.ZP.notifications.types[e.action.type].name),e.action.type===Je.k$.INTEGRATION&&s.createElement("span",null,": ",E.ZP.integrations.types[e.action.integration.type].name)):s.createElement(sn,{...e},s.createElement("span",{className:"pf-v5-u-color-200"},s.createElement("div",null,"No actions."),s.createElement("div",null,"Users will not be notified.")));var un=n(69696);const dn=e=>{const t="User Access group (Not found)";return s.createElement(a.Tooltip,{content:"This User Access group was not found, and may have been deleted. Remove it from your behavior group to stop seeing it."},e.onClose?s.createElement(a.Label,{variant:"outline",color:"red",onClose:e.onClose},t):s.createElement("span",{className:"pf-v5-u-color-300"}," ",t," "))},mn=()=>s.createElement("span",null,", "),pn=e=>{if(e.action.type===Je.k$.INTEGRATION)return s.createElement(s.Fragment,null,e.action.integration.isEnabled?e.action.integration.name:s.createElement("span",{className:"pf-v5-u-color-300"}," ",e.action.integration.name,s.createElement(a.Tooltip,{content:"This integration has been disabled. This action wil not fire until it is enabled.",position:"bottom"},s.createElement(O.BanIcon,{className:"pf-v5-u-color-300"}))));const t=e.action.recipient.filter((e=>e instanceof un.dt)),n=e.action.recipient.filter((e=>e instanceof un.nc));return s.createElement("span",null,t.length>0&&s.createElement("div",null,"Users:"," ",(0,o.join)(t.map((e=>s.createElement(s.Fragment,null,e.displayName,e.ignorePreferences&&s.createElement("span",null,s.createElement(a.Tooltip,{content:"You may still receive forced notifications for this service",position:"bottom"},s.createElement(O.LockIcon,{className:"pf-v5-u-ml-sm pf-v5-u-color-300"})))," "))),mn)),n.length>0&&s.createElement("div",null,"User Access Groups:"," ",(0,o.join)(n.map((e=>e.hasError?s.createElement(dn,{key:e.groupId}):e.isLoading?s.createElement(a.Skeleton,{width:"40px",key:e.groupId}):e.displayName)),mn)))},En=e=>s.createElement(a.Grid,null,s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Action"))),s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Recipient"))),e.children),vn=e=>s.createElement(En,null,e.actions.map(((e,t)=>s.createElement(s.Fragment,{key:`${t}-${e.type}`},s.createElement(a.GridItem,{span:6},s.createElement(cn,{action:e})),s.createElement(a.GridItem,{className:"pf-u-text-break-word",span:6},s.createElement(pn,{action:e})))))),gn=()=>{const e="150px";return s.createElement(En,null,[...Array(3).values()].map(((t,n)=>s.createElement(s.Fragment,{key:`skeleton-${n}`},s.createElement(a.GridItem,{span:6},s.createElement(a.Skeleton,{width:e})),s.createElement(a.GridItem,{span:6},s.createElement(a.Skeleton,{width:e}))))))},hn=e=>e.actions?s.createElement(vn,{actions:e.actions}):s.createElement(gn,null),fn=(0,ge.style)({width:450,height:"100%"}),yn=e=>{const[t,n]=s.useState(!1),l=s.useCallback((()=>n((e=>!e))),[n]);return s.createElement(a.Card,{isFlat:!0,className:fn},s.createElement(a.CardHeader,null,s.createElement(a.CardHeaderMain,null,s.createElement(a.Split,null,s.createElement(a.SplitItem,null,e.isDefaultBehavior&&s.createElement(a.Tooltip,{position:"top",appendTo:()=>document.body,content:s.createElement("div",null,"System required behavior group",s.createElement("br",null),s.createElement("br",null),"This group is system generated and can not be edited, deleted, or removed from being applied to an event")},s.createElement(O.LockIcon,{className:"pf-v5-u-mr-sm"}))),s.createElement(a.SplitItem,null,s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h4}," ",e.title," "))))),s.createElement(a.CardActions,null,!e.isDefaultBehavior&&s.createElement(a.Dropdown,{onSelect:l,toggle:s.createElement(a.KebabToggle,{onToggle:n,isDisabled:!e.dropdownItems}),isOpen:t,isPlain:!0,dropdownItems:e.dropdownItems,position:a.DropdownPosition.right,menuAppendTo:()=>document.body}))),s.createElement(a.CardBody,null,e.children))},bn=e=>{const t=s.useCallback((()=>{const t=e.onEdit;t&&t(e.behaviorGroup)}),[e.behaviorGroup,e.onEdit]),n=s.useCallback((()=>{const t=e.onDelete;t&&t(e.behaviorGroup)}),[e.behaviorGroup,e.onDelete]),l=s.useMemo((()=>[s.createElement(a.DropdownItem,{key:"on-edit",onClick:t,isDisabled:!t}," ","Edit"," "),s.createElement(a.DropdownItem,{key:"on-delete",onClick:n,isDisabled:!n}," ","Delete"," ")]),[t,n]);return s.createElement(yn,{title:e.behaviorGroup.displayName,dropdownItems:l,isDefaultBehavior:e.behaviorGroup.isDefault},s.createElement(hn,{actions:e.behaviorGroup.actions}))},Cn=()=>s.createElement(yn,{title:s.createElement(a.Skeleton,{width:"300px"})},s.createElement(hn,null)),Tn=e=>e.behaviorGroup?s.createElement(bn,{...e,behaviorGroup:e.behaviorGroup}):s.createElement(Cn,null),Sn=(0,ge.style)({overflow:"auto"}),kn=e=>s.createElement("div",{"data-testid":"ref-card-list-container"},s.createElement(a.Flex,{alignItems:{default:"alignItemsStretch"},alignContent:{default:"alignContentSpaceBetween"},flexWrap:{default:"nowrap"},className:Sn,"data-testid":"card-list-container"},e.children)),In=e=>s.createElement(kn,null,e.behaviorGroups.map((t=>s.createElement(a.FlexItem,{key:t.id,className:"pf-v5-u-pb-md"},s.createElement(Tn,{behaviorGroup:t,onEdit:e.onEdit,onDelete:e.onDelete}))))),Nn=()=>s.createElement(kn,null,[...Array(3).values()].map(((e,t)=>s.createElement(a.FlexItem,{key:`behavior-group-card-skeleton-${t}`,className:"pf-v5-u-pb-md"},s.createElement(Tn,null))))),wn=e=>e.behaviorGroups?s.createElement(In,{...e,behaviorGroups:e.behaviorGroups}):s.createElement(Nn,null);var Dn=n(52857),An=n(45871),Ln=n(41054);const Pn=e=>{var t;const n=s.useContext(a.WizardContext);return s.createElement(a.WizardFooter,null,s.createElement(a.Button,{variant:a.ButtonVariant.primary,type:"submit",onClick:()=>{e.onNext(n.onNext)},isDisabled:e.isLoading||!n.activeStep.enableNext},null!==(t=n.activeStep.nextButtonText)&&void 0!==t?t:"Next"),!n.activeStep.hideBackButton&&s.createElement(a.Button,{variant:a.ButtonVariant.secondary,onClick:()=>{e.onBack(n.onBack)},isDisabled:0===n.activeStep.id||e.isLoading},"Back"),!n.activeStep.hideCancelButton&&s.createElement(a.Button,{variant:a.ButtonVariant.link,onClick:n.onClose,isDisabled:e.isLoading},"Cancel"),e.isLoading?s.createElement("div",{className:"pf-v5-u-mt-auto pf-v5-u-mb-md"},s.createElement(a.Spinner,{size:"md"})):e.error&&s.createElement(a.Split,null,s.createElement(a.SplitItem,null,s.createElement(a.Icon,{status:"danger",className:"pf-v5-u-mr-xs"},s.createElement(O.ExclamationCircleIcon,null))),s.createElement(a.SplitItem,null,e.error)))},On=e=>{const{values:t}=(0,Ln.useFormikContext)(),n=(t.id?"Edit":"Create")+" behavior group";return s.createElement(Ln.Form,{placeholder:""},s.createElement(a.Wizard,{title:n,steps:e.steps,footer:s.createElement(Pn,{isLoading:e.loading,onNext:e.onNext,onBack:e.onBack}),isOpen:!0,startAtStep:1,onGoToStep:t=>{var n;return e.onGoToStep(null!==(n=t.id)&&void 0!==n?n:1)},onClose:e.onClose,onSave:e.onSave}))},Fn=(0,s.createContext)({getIntegrations:async()=>{throw new Error("No IntegrationContext found")},getNotificationRecipients:async()=>{throw new Error("No RecipientContext found")}}),xn=()=>(0,s.useContext)(Fn),Rn=Fn.Provider;var Gn,_n=n(45093),Bn=n(81952),Mn=n(21503),Vn=n(21551);!function(e){e[e.CREATE=0]="CREATE",e[e.UPDATE=1]="UPDATE"}(Gn||(Gn={}));var Zn=n(37176);class Un{constructor(e){this.recipient=e}compareTo(e){return e instanceof Un&&this.recipient.equals(e.recipient)}toString(){return this.recipient.displayName}}const $n=(e,t,n,l)=>n?l?l():[s.createElement(a.SelectOption,{key:"loading-option",isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"}))]:t(e),Hn=(e,t,n)=>s.useMemo((()=>"default"===e.show?$n(e.defaultValues,t,e.loadingDefault,n):"filter"===e.show?$n(e.filterValues,t,e.loadingFilter,n):void(0,oe.ZP)(e.show)),[e,t,n]);var qn,Yn=n(62554);!function(e){e[e.LOAD_FILTER_VALUE=0]="LOAD_FILTER_VALUE",e[e.SET_FILTER_VALUE=1]="SET_FILTER_VALUE",e[e.USE_DEFAULTS=2]="USE_DEFAULTS",e[e.SET_DEFAULTS=3]="SET_DEFAULTS"}(qn||(qn={}));const zn=(e,t)=>(0,ve.ZP)(e,(n=>{switch(t.type){case qn.SET_FILTER_VALUE:t.search===e.lastSearch&&t.values!==n.filterValues&&(n.loadingFilter=!1,n.filterValues=(0,ve.cA)(t.values));break;case qn.LOAD_FILTER_VALUE:t.search===n.lastSearch&&"filter"===n.show||(n.loadingFilter=!0,n.filterValues=[],n.lastSearch=t.search,n.show="filter");break;case qn.USE_DEFAULTS:"default"!==n.show&&(n.show="default");break;case qn.SET_DEFAULTS:n.defaultValues=(0,ve.cA)(t.values),n.loadingDefault=!1;break;default:(0,oe.ZP)(t)}})),Wn=()=>{const[e,t]=(0,s.useReducer)(zn,{filterValues:[],defaultValues:[],show:"default",loadingFilter:!1,loadingDefault:!0,lastSearch:""}),[n,a]=(0,s.useState)(e);(0,Yn.Z)((()=>{a(e)}),400,[e]);const l=(0,s.useCallback)(((e,n)=>t({type:qn.SET_FILTER_VALUE,values:n,search:e})),[t]),i=(0,s.useCallback)((e=>t({type:qn.LOAD_FILTER_VALUE,search:e})),[t]),o=(0,s.useCallback)((e=>t({type:qn.SET_DEFAULTS,values:e})),[t]),r=(0,s.useCallback)((()=>t({type:qn.USE_DEFAULTS})),[t]);return[n,(0,s.useMemo)((()=>({setFilterValue:l,loadFilterValue:i,setDefaults:o,useDefaults:r})),[l,i,o,r])]},Qn=e=>{const[t,n]=s.useState(!1),l=(0,Zn.Z)(t),{getIntegrations:i}=xn(),{values:o}=(0,Ln.useFormikContext)(),[r,c]=Wn(),u=s.useCallback((e=>{n(e)}),[n]);s.useEffect((()=>{const n=e.onOpenChange;void 0!==l&&l!==t&&n&&n(t)}),[l,t,e.onOpenChange]),s.useEffect((()=>{i(e.integrationType,"").then((e=>{const t=e.map((e=>new un.YO(e)));c.setDefaults(t)}))}),[i,e.integrationType,c]),s.useEffect((()=>{r.loadingFilter&&i(e.integrationType,r.lastSearch).then((e=>c.setFilterValue(r.lastSearch,e.map((e=>new un.YO(e))))))}),[i,e.integrationType,r.loadingFilter,r.lastSearch,c]);const d=s.useMemo((()=>{var e;const t=(null!==(e=o.actions)&&void 0!==e?e:[]).filter((e=>(null==e?void 0:e.type)===Je.k$.INTEGRATION)).map((e=>null==e?void 0:e.integration.id));return new Set(t)}),[o]),m=s.useCallback((e=>e.map((e=>{const t=null==d?void 0:d.has(e.integration.id);return s.createElement(a.SelectOption,{key:e.getKey(),value:new Un(e),description:t?"This integration has already been added":void 0,isDisabled:t})}))),[d]),p=Hn(r,m),v=s.useCallback((e=>{var t;if(null===e)return p;const n=null===(t=e.target.value)||void 0===t?void 0:t.trim();return""===n?c.useDefaults():c.loadFilterValue(n),p}),[c,p]),g=s.useMemo((()=>{const t=e.selected;if(void 0!==t&&void 0!==t.name&&void 0!==t.id&&void 0!==t.type)return new Un(new un.YO(t))}),[e.selected]),h=s.useCallback(((t,a)=>{const l=e.onSelected;a instanceof Un&&(l(a),n(!1))}),[e.onSelected]),f=`Choose ${E.ZP.integrations.types[e.integrationType].name.toLowerCase()}`;return s.createElement("div",{...(0,Xe.k)("IntegrationRecipientTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.typeahead,typeAheadAriaLabel:f,placeholderText:f,selections:g,onSelect:h,onToggle:u,isOpen:t,onFilter:v,menuAppendTo:document.body,isDisabled:e.isDisabled,validated:e.error?"error":void 0},p))},jn="groups",Kn="User Access Groups",Jn=(e,t,n)=>n.length>0?s.createElement(a.SelectGroup,{key:e,label:t},n.map((e=>e instanceof un.nc&&e.isLoading?s.createElement(a.SelectOption,{key:e.getKey(),isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"})):s.createElement(a.SelectOption,{key:e.getKey(),value:new Un(e),description:e.description})))):s.createElement(s.Fragment,{key:e}),Xn=e=>[Jn(jn,Kn,e)],ea=()=>[s.createElement(a.SelectGroup,{key:jn,label:Kn},s.createElement(a.SelectOption,{key:"loading-group",isNoResultsOption:!0},s.createElement(a.Skeleton,{width:"100%"})))],ta=[Jn("users","Users",[new un.dt(void 0,!1,!1),new un.dt(void 0,!0,!1)])],na=e=>{const[t,n]=s.useState(!1),[l,i]=Wn(),o=(0,Zn.Z)(t),{getNotificationRecipients:r}=xn();s.useEffect((()=>{r().then((e=>i.setDefaults(e)))}),[r,i]),s.useEffect((()=>{l.loadingFilter&&r().then((e=>i.setFilterValue(l.lastSearch,e)))}),[r,l.loadingFilter,l.lastSearch,i]);const c=s.useCallback((e=>{n(e)}),[n]);s.useEffect((()=>{const n=e.onOpenChange;void 0!==o&&o!==t&&n&&n(t)}),[o,t,e.onOpenChange]);const u=Hn(l,Xn,ea),d=s.useMemo((()=>[...ta,...u]),[u]),m=s.useMemo((()=>{const t=e.selected;if(void 0!==t)return t.map((e=>new Un(e)))}),[e.selected]),p=s.useCallback(((t,n)=>{const a=e.onSelected;n instanceof Un&&a(n)}),[e.onSelected]),E=s.useMemo((()=>null==m?void 0:m.map((e=>{const t=e=>t=>{t.stopPropagation(),p(t,e)},n=e.recipient.getKey();if(e.recipient instanceof un.nc){if(e.recipient.isLoading)return s.createElement(a.Chip,{key:n,onClick:t(e)},s.createElement(a.Skeleton,{"data-testid":"loading-group",width:"40px"}));if(e.recipient.hasError)return s.createElement(dn,{key:n,onClose:t(e)})}return s.createElement(a.Chip,{onClick:t(e),key:n},e.recipient.displayName)}))),[m,p]);return s.createElement("div",{...(0,Xe.k)("RecipientTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.checkbox,selections:m,onSelect:p,onToggle:c,isOpen:t,menuAppendTo:document.body,isDisabled:e.isDisabled,onClear:e.onClear,validated:e.error?"error":void 0,isGrouped:!0,isCheckboxSelectionBadgeHidden:!0,isInputValuePersisted:!0,placeholderText:s.createElement(a.ChipGroup,null,E)},d))},aa=()=>!1,la=e=>{var t,n;let l;return l=e.action?e.action.type===Je.k$.INTEGRATION?s.createElement(Qn,{onSelected:e.integrationSelected,integrationType:null!==(n=null===(t=e.action.integration)||void 0===t?void 0:t.type)&&void 0!==n?n:J.WN.WEBHOOK,selected:e.action.integration,onOpenChange:e.onOpenChange,error:!!e.error}):s.createElement(na,{onSelected:e.recipientSelected,selected:e.action.recipient,onClear:e.recipientOnClear,onOpenChange:e.onOpenChange,error:!!e.error}):s.createElement("div",null,s.createElement(a.Select,{variant:a.SelectVariant.typeahead,isDisabled:!0,onToggle:aa,isOpen:!1})),s.createElement(s.Fragment,null," ",l,e.error&&s.createElement(a.FormHelperText,{isError:!0,isHidden:!e.error},e.error))};class ia{constructor(e){"integration"===e.kind?(this.notificationType=Je.k$.INTEGRATION,this.integrationType=e.type):(this.notificationType=e.type,this.integrationType=void 0)}compareTo(e){return e instanceof ia&&e.notificationType===this.notificationType&&e.integrationType===this.integrationType}toString(){const e=E.ZP.notifications.types[this.notificationType].name;return this.integrationType?`${e}: ${E.ZP.integrations.types[this.integrationType].name}`:e}}const oa=e=>s.createElement(s.Fragment,null,s.createElement("div",null,"You have no integration configured."),s.createElement("div",null,"Go to Settings ",">"," ",s.createElement(m.Link,{style:{pointerEvents:"all"},rel:e.testNoIntegrationRenderWithoutRelAndTarget?void 0:"noopener noreferrer",target:e.testNoIntegrationRenderWithoutRelAndTarget?void 0:"_blank",to:yl.integrations()},"Integrations")," ","to configure.")),ra=e=>{const[t,n]=s.useState(!1),{getIntegrations:l}=xn(),[i,o]=s.useState(Object.values(J.j3).reduce(((e,t)=>(e[t]=!0,e)),{}));s.useEffect((()=>{Object.values(J.j3).forEach((async e=>{const t=await l(e);o((0,ve.ZP)((n=>{n[e]=t.length>0})))}))}),[l]);const r=s.useCallback((e=>{n(e)}),[n]),c=s.useCallback(((t,a)=>{const l=e.onSelected;a instanceof ia&&(l(a),n(!1))}),[e.onSelected,n]),u=s.useMemo((()=>{if(e.action)return e.action.type===Je.k$.INTEGRATION?new ia({kind:"integration",type:e.action.integration.type}):new ia({kind:"notification",type:e.action.type})}),[e.action]),d=(0,Qe.N)(),m=je(),p=s.useMemo((()=>{return(t=m,n=d,l=e.selectedNotifications,[...t.filter((e=>!l.includes(e))).map((e=>new ia({kind:"notification",type:e}))),...n.map((e=>new ia({kind:"integration",type:e})))]).map((t=>{const n=(0,J.F8)(t.integrationType)&&!i[t.integrationType];return s.createElement(a.SelectOption,{isDisabled:n,key:t.toString(),value:t,description:n&&s.createElement(oa,{testNoIntegrationRenderWithoutRelAndTarget:e.testNoIntegrationRenderWithoutRelAndTarget})})}));var t,n,l}),[m,d,e.selectedNotifications,i,e.testNoIntegrationRenderWithoutRelAndTarget]);return s.createElement("div",{...(0,Xe.k)("ActionTypeahead",e)},s.createElement(a.Select,{maxHeight:400,variant:a.SelectVariant.single,"aria-label":"Select action",placeholderText:"Select action",selections:u,onToggle:r,isOpen:t,onSelect:c,menuAppendTo:document.body,isDisabled:e.isDisabled},p))};(0,ge.cssRaw)("\n    @media only screen and (max-width: 768px) {\n        .pf-c-select .pf-c-select__toggle-typeahead {\n            --pf-c-select__toggle-typeahead--FlexBasis: 0;\n        }\n    }\n");const sa=(0,ge.style)({$nest:{"& tr":{borderBottom:(0,ce.important)(0)},"& th:first-child":{paddingLeft:(0,ce.important)(0)},"& th:last-child, & td:last-child":{paddingRight:(0,ce.important)(0)}}}),ca=(0,ge.style)({$nest:{"& td:first-child":{paddingLeft:(0,ce.important)(0)},"& td:last-child":{paddingRight:(0,ce.important)(0)},"& td":{verticalAlign:(0,ce.important)("top")}}}),ua=(0,ge.style)({textAlign:"left",paddingLeft:0}),da=[{title:"Actions",transforms:[(0,Se.cellWidth)(50)]},{title:"Recipient"}],ma=()=>s.createElement("span",null),pa=e=>{const{values:t,setValues:n,errors:l,touched:i,setFieldTouched:o}=e.form,r=s.useMemo((()=>{var e;return null!==(e=t.actions)&&void 0!==e?e:[]}),[t]),c=s.useMemo((()=>{var e;return null!==(e=null==i?void 0:i.actions)&&void 0!==e?e:[]}),[i]),u=s.useMemo((()=>{var e;return null!==(e=null==l?void 0:l.actions)&&void 0!==e?e:[]}),[l]),d=s.useMemo((()=>new Array(...new Set(r.filter((e=>e)).map((e=>e.type))))),[r]),m=s.useCallback((e=>{n((0,ve.ZP)((t=>{const n=t;n.actions=e instanceof Function?(0,ve.cA)(e(n.actions)):(0,ve.cA)(e)})),!1)}),[n]),p=s.useCallback((()=>{(0,e.push)(void 0)}),[e.push]);s.useEffect((()=>{0===r.length&&p()}),[r,p]);const E=(v=m,{handleActionSelected:(0,s.useCallback)((e=>t=>{v((0,ve.ZP)((n=>{n[e]||(n[e]={});const a=n[e];a.type=t.notificationType,t.integrationType?a.integration={type:t.integrationType}:a.recipient=[]})))}),[v]),handleIntegrationSelected:(0,s.useCallback)((e=>t=>{v((0,ve.ZP)((n=>{t.recipient instanceof un.YO&&(n[e].integration=t.recipient.integration)})))}),[v]),handleRecipientSelected:(0,s.useCallback)((e=>t=>{v((0,ve.ZP)((n=>{const a=n[e];if(a.type!==Je.k$.INTEGRATION){const e=a,n=(0,ve.Js)(e.recipient);if(n){const a=n.findIndex((e=>t.recipient.equals(e)));-1===a?e.recipient.push((0,ve.cA)(t.recipient)):e.recipient.splice(a,1)}}})))}),[v]),handleRecipientOnClear:(0,s.useCallback)((e=>()=>{v((0,ve.ZP)((t=>{const n=t[e];n.type!==Je.k$.INTEGRATION&&(n.recipient=[])})))}),[v])});var v;const g=s.useMemo((()=>((e,t,n,a,l,i)=>e.map(((e,o)=>{var r,c;let u,d,m=!1;return d=(null==e?void 0:e.type)===Je.k$.INTEGRATION?`actions.${o}.integration`:`actions.${o}.recipient`,(null==e?void 0:e.type)===Je.k$.INTEGRATION&&((null===(r=n[o])||void 0===r?void 0:r.integration)&&(m=!0),m&&(null===(c=t[o])||void 0===c?void 0:c.integration)&&(u="Select a recipient for this integration.")),!u&&m&&i(d,!1,!1),{id:o,key:o,cells:[{title:s.createElement(ra,{selectedNotifications:a,action:e,onSelected:l.handleActionSelected(o)})},{title:s.createElement(la,{action:e,integrationSelected:l.handleIntegrationSelected(o),recipientSelected:l.handleRecipientSelected(o),recipientOnClear:l.handleRecipientOnClear(o),error:u,onOpenChange:e=>{e||i(d,!0,!1)}})}]}})))(r,u,c,d,E,o)),[r,u,c,d,E,o]),h=s.useCallback((t=>{const n=e.handleRemove;return g.length>1?[{key:"delete",title:s.createElement(a.Button,{"aria-label":"delete-action",variant:a.ButtonVariant.plain},s.createElement(O.MinusCircleIcon,null)),isOutsideDropdown:!0,onClick:n(t.id)}]:[]}),[g,e.handleRemove]);return s.createElement(s.Fragment,null,s.createElement(Se.Table,{"aria-label":"behavior-group-actions-form",rows:g,cells:da,actionResolver:h,actionsToggle:ma,borders:!1,variant:Se.TableVariant.compact,isStickyHeader:!0},s.createElement(Se.TableHeader,{className:sa}),s.createElement(Se.TableBody,{className:ca})),s.createElement(a.GridItem,{span:12},s.createElement(a.Button,{className:ua,variant:a.ButtonVariant.link,icon:s.createElement(O.PlusCircleIcon,null),onClick:p},"Add action")))},Ea=e=>s.createElement("div",{...(0,Xe.k)("Notifications/BehaviorGroupForm",e)},s.createElement(a.Grid,{hasGutter:!0},s.createElement(Ln.FieldArray,{name:"actions"},(e=>s.createElement(s.Fragment,null,s.createElement(pa,{...e})))))),va=B.Ry({type:B.nK().oneOf([Je.k$.INTEGRATION]).required(),integration:B.Ry({id:B.Z_().required()}).required(),integrationId:B.Z_().min(1)}),ga=B.Ry({type:B.nK().oneOf([Je.k$.EMAIL_SUBSCRIPTION,Je.k$.DRAWER]).required(),recipient:B.IX(B.Ry()).min(1),integrationId:B.Z_().min(0)}),ha=B.IX(B.Vo((e=>e&&e.hasOwnProperty("type")&&e.type===Je.k$.INTEGRATION?va:ga))).test("no-repeated","${path} can't contain repeated actions",((e,t)=>{const n=[];let a=!1;const l=[];if(!e)return!0;for(let i=0;i<e.length;++i){const o=e[i],r=o.integrationId;o.type===Je.k$.EMAIL_SUBSCRIPTION?(a&&n.push(t.createError({message:"Only 1 send email action is allowed",path:`actions.${i}`})),a=!0):r&&(l.includes(r)?n.push(t.createError({message:"Integration already used in the group, please select other",path:`actions.${i}`})):l.push(r))}return 0===n.length||{...t.createError(),inner:n}})),fa=(B.Ry({actions:ha}),B.Ry({displayName:B.Z_().required("You must specify a name for the behavior group"),actions:ha}),"Actions and recipients"),ya=()=>{const{values:e}=(0,Ln.useFormikContext)();return s.createElement(o.Form,null,s.createElement("div",null,s.createElement(a.Title,{headingLevel:"h4",size:"xl"},fa),s.createElement(a.TextContent,{className:"pf-v5-u-pt-sm"},s.createElement(a.Text,null,"Select action and recipient pairs to assign to your notification events.")),s.createElement(Ea,{behaviorGroup:e})))},ba=B.Ry({actions:ha}),Ca=e=>s.createElement(Se.TableComposable,{variant:Se.TableVariant.compact},s.createElement(Se.Thead,null,s.createElement(Se.Tr,null,s.createElement(Se.Th,null),s.createElement(Se.Th,null,"Event type"),s.createElement(Se.Th,null,"Service"))),s.createElement(Se.Tbody,null,e.children)),Ta=()=>s.createElement(Ca,null,[...Array(10)].map(((e,t)=>s.createElement(Se.Tr,{key:t},s.createElement(Se.Td,{select:{isSelected:!1,rowIndex:t,disable:!0}}),s.createElement(Se.Td,null,s.createElement(a.Skeleton,{width:"80%"})),s.createElement(Se.Td,null,s.createElement(a.Skeleton,{width:"80%"})))))),Sa=e=>s.createElement(Ca,null,e.events.map(((t,n)=>s.createElement(Se.Tr,{key:t.id},s.createElement(Se.Td,{modifier:e.selectionLoading?"fitContent":void 0,noPadding:e.selectionLoading,select:e.selectionLoading?void 0:{rowIndex:n,onSelect:(n,a)=>e.onSelect&&e.onSelect(a,t),isSelected:t.isSelected,disable:e.selectionLoading}},e.selectionLoading&&s.createElement(a.Spinner,{size:"sm"})),s.createElement(Se.Td,null,t.eventTypeDisplayName),s.createElement(Se.Td,null,t.applicationDisplayName))))),ka=e=>e.events?s.createElement(Sa,{...e,events:e.events}):s.createElement(Ta,null),Ia="Associate event types",Na=e=>{const{setValues:t,values:n}=(0,Ln.useFormikContext)(),[l,i]=s.useState((()=>{const e={};return n.events.forEach((t=>{e[t.id]=t})),e})),r=tn(e.bundle,e.applications,!1),c=$(r.pageController.page),u=(0,o.useTransformQueryResponse)((0,C.useParameterizedQuery)(Z),U);(0,s.useEffect)((()=>{t((0,ve.ZP)((e=>{e.events=Object.values(l)})))}),[t,l]);const d=s.useMemo((()=>{const e=c.payload;return 200===(null==e?void 0:e.status)?e.value.meta.count:0}),[c.payload]),m=s.useMemo((()=>{var e;return"eventTypesArray"===(null===(e=c.payload)||void 0===e?void 0:e.type)?c.payload.value.data.map((e=>({...e,isSelected:Object.keys(l).includes(e.id)}))):[]}),[c.payload,l]),p=s.useCallback(((e,t)=>{i((0,ve.ZP)((n=>{e?n[t.id]=t:delete n[t.id]})))}),[i]),E=s.useCallback((e=>{const t=r.pageController.page;switch(e){case jt.ALL:if(d===m.length)return i((0,ve.ZP)((e=>{m.forEach((t=>{e[t.id]=t}))})));(async()=>{var e;let n=1;const a={},l=o.Page.lastPageForElements(d,t.size);for(;;){const i=t.withPage(n);if(i.index>l.index)break;if(t.index===i.index)m.forEach((e=>{a[e.id]=e}));else{const l=await u.query(t.withPage(n));if("eventTypesArray"!==(null===(e=l.payload)||void 0===e?void 0:e.type))break;l.payload.value.data.forEach((e=>{a[e.id]=e}))}n++}i((0,ve.ZP)((e=>{for(const t of Object.values(a))e[t.id]=t})))})();break;case jt.PAGE:i((0,ve.ZP)((e=>{m.forEach((t=>{e[t.id]=t}))})));break;case jt.NONE:i({})}}),[i,m,u,r.pageController.page,d]);return s.createElement(o.Form,null,s.createElement("div",null,s.createElement(a.Title,{headingLevel:"h4",size:"xl"},Ia),s.createElement(a.TextContent,{className:"pf-v5-u-pt-sm"},s.createElement(a.Text,null,"Select event types you would like to assign this behavior group to."))),s.createElement(en,{filters:r.filters,setFilters:r.setFilters,clearFilter:r.clearFilters,appFilterOptions:e.applications,pageAdapter:r.pageController,count:d,pageCount:m.length,onSelectionChanged:E,selectedCount:Object.keys(l).length,bulkSelectionDisabled:u.loading},s.createElement(ka,{onSelect:p,events:c.loading?void 0:m,selectionLoading:u.loading})))},wa="Name",Da=()=>s.createElement(o.Form,{ouiaId:"basic-information-step"},s.createElement(a.Title,{headingLevel:"h4",size:"xl"},wa),s.createElement(o.FormTextInput,{ouiaId:"name",id:"name",name:"displayName",label:"Behavior group name",isRequired:!0})),Aa=B.Ry({displayName:B.Z_().min(1).max(150,"Must be 150 characters or less").required("Behavior group name is required")}),La="Review",Pa=e=>s.createElement(a.Grid,null,s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Event type"))),s.createElement(a.GridItem,{span:6},s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.h6},"Application"))),e.events.map((e=>s.createElement(s.Fragment,{key:e.id},s.createElement(a.GridItem,{span:6},e.eventTypeDisplayName),s.createElement(a.GridItem,{span:6},e.applicationDisplayName))))),Oa=()=>{const{values:e}=(0,Ln.useFormikContext)();return s.createElement(o.Form,{ouiaId:"review-step"},s.createElement(a.Title,{headingLevel:"h2",size:"xl"},La),s.createElement(a.DescriptionList,{isHorizontal:!0},s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null,"Name"),s.createElement(a.DescriptionListDescription,null," ",e.displayName)),s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null," Actions and recipients"),s.createElement(a.DescriptionListDescription,null,s.createElement(hn,{actions:e.actions}))),s.createElement(a.DescriptionListGroup,null,s.createElement(a.DescriptionListTerm,null,"Associate event types"),s.createElement(a.DescriptionListDescription,null,s.createElement(Pa,{events:e.events})))))},Fa=()=>{},xa=e=>{const[t,n]=s.useState(0),{isValid:a,validateForm:l}=(0,Ln.useFormikContext)(),i=(e=>{const t=Q(),{query:n}=(0,s.useContext)(C.ClientContext),[a,l]=(0,s.useState)(!1);return{save:(0,s.useCallback)((async a=>{var i,o,r,s;const c=t.mutate;let u=!1,d=!1,m=!1;void 0===a.id&&(u=!0,d=!0),a.displayName!==(null==e?void 0:e.displayName)&&(u=!0);const p=[...null!==(i=null==e?void 0:e.events)&&void 0!==i?i:[]].sort(),E=[...null!==(o=a.events)&&void 0!==o?o:[]].sort();p.length===E.length&&p.every(((e,t)=>e===E[t]))||(m=!0),(0,Je.VL)(null!==(r=null==e?void 0:e.actions)&&void 0!==r?r:[],null!==(s=a.actions)&&void 0!==s?s:[])||(d=!0);const v=(0,Vn.uniqWith)([].concat(...a.actions.filter(Je.Yh).map((e=>(0,ve.ZP)(e,(e=>{e.recipient=e.recipient.filter((e=>!e.integrationId))})))).map((e=>(0,V.OO)(e)))),Vn.isEqual);if(v.find((e=>![Je.k$.EMAIL_SUBSCRIPTION,Je.k$.DRAWER].includes(e.type))))throw new Error("Only email and drawer subscriptions are created when assigning behavior groups");v.length>0&&l(!0);const g=await Promise.all(v.map((e=>{return n((t=e,(0,Je.K4)(t)?ht.B.EndpointResourceGetOrCreateEmailSubscriptionEndpoint.actionCreator({body:{only_admins:t.props.onlyAdmins,group_id:t.props.groupId}}):(0,Je.L6)(t)?ht.B.EndpointResourceGetOrCreateDrawerSubscriptionEndpoint.actionCreator({body:{only_admins:t.props.onlyAdmins,group_id:t.props.groupId}}):void(0,oe.ZP)(t))).then((e=>{var t;return"Endpoint"===(null===(t=e.payload)||void 0===t?void 0:t.type)?e.payload.value.id:void 0}));var t}))).then((e=>{if(e.includes(void 0))throw new Error("Unexpected ids were returned when querying for system endpoints");const t=[...e];return((e,t)=>{const n=t?[...t]:void 0;return e.reduce(((a,l)=>{if((0,Je.Yh)(l))l.recipient.forEach((l=>{if(l.integrationId)a.push(l.integrationId);else if(void 0===n)a.push(void 0);else{if(!(n.length>0))throw new Error(`No more ids remaining to assign: actions ${e} newIds: ${t}`);a.push(n.shift())}}));else{if(!(0,Je._f)(l))throw new Error(`Unknown action type: ${l}`);a.push(l.integration.id)}return a}),[])})(a.actions,t)})),h={...a,displayName:u?a.displayName:void 0,endpointIds:d?g:void 0,eventTypesIds:m?a.events.map((e=>e.id)):void 0};return u||d||m?c(h).then((e=>{var t;return{operation:void 0===a.id?Gn.CREATE:Gn.UPDATE,status:200===(null===(t=e.payload)||void 0===t?void 0:t.status)}})).catch((()=>({operation:void 0===a.id?Gn.CREATE:Gn.UPDATE,status:!1}))):{operation:void 0===a.id?Gn.CREATE:Gn.UPDATE,status:!0}}),[t.mutate,n,e]),isSaving:(0,s.useMemo)((()=>t.loading||a),[t.loading,a])}})(e.behaviorGroup),{values:o}=(0,Ln.useFormikContext)(),{addDangerNotification:r,addSuccessNotification:c}=(0,Mn.l)(),u=((e,t,n,a)=>{const l=s.useMemo((()=>({name:wa,component:s.createElement(Da,null),schema:Aa})),[]),i=(({applications:e,bundle:t})=>s.useMemo((()=>({name:Ia,component:s.createElement(Na,{applications:e,bundle:t})})),[e,t]))(e),o=s.useMemo((()=>({name:fa,component:s.createElement(ya,null),schema:ba})),[]),[r,c]=(0,s.useState)(0),[u,d]=(0,s.useState)((()=>new Set));(0,s.useEffect)((()=>{c((e=>Math.max(t,e)))}),[t]),(0,s.useEffect)((()=>{d((0,ve.ZP)((e=>{n?e.delete(t):e.add(t)})))}),[t,n]);const m=0===u.size?r:Math.min(...Array.from(u));return(0,s.useMemo)((()=>[l,o,i,{name:La,component:s.createElement(Oa,null),nextButtonText:"Finish"}].map(((e,t)=>({...e,id:t,canJumpTo:!a&&t<=m,hideCancelButton:!1,enableNext:n})))),[l,o,n,m,a,i])})({bundle:e.bundle,applications:e.applications},t,a,i.isSaving),d=u[t],m=null==d?void 0:d.schema;s.useEffect((()=>{e.setValidationSchema(m)}),[t]),s.useEffect((()=>{l()}),[e.validationSchema,l]);const p=s.useCallback((async()=>{const t=e.onClose,n=i.save,a={...o,bundleId:e.bundle.id},l=await n(a);l.status?(l.operation===Gn.CREATE?c("New behavior group created",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null," ",a.displayName," ")," created successfully.")):c("Behavior group saved",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null," ",a.displayName," ")," was saved successfully.")),t(!0)):l.operation===Gn.CREATE?r("Behavior group failed to be created",s.createElement(s.Fragment,null,"Failed to create group ",s.createElement("b",null," ",a.displayName),".",s.createElement("br",null),"Please try again.")):r("Behavior group failed to save",s.createElement(s.Fragment,null,"Failed to save group ",s.createElement("b",null," ",a.displayName),".",s.createElement("br",null),"Please try again."))}),[o,i.save,e.bundle,e.onClose,r,c]);return s.createElement(On,{steps:u,onNext:async e=>{let t=!0;(null==d?void 0:d.isValid)&&(t=await d.isValid()),t&&(n((e=>Math.min(e+1,u.length))),e())},onBack:async e=>{n((e=>e-1)),e()},onGoToStep:n,loading:i.isSaving,onClose:()=>{e.onClose(!1)},onSave:p})},Ra=e=>{var t;const n=(()=>{const e=(0,Bn.P)();return(0,s.useCallback)((async()=>e.groups.map((e=>new un.nc(void 0,e.id,e.name)))),[e])})(),a=(()=>{const{query:e}=(0,s.useContext)(C.ClientContext);return s.useCallback((async(t,n)=>e((0,_n.Kr)(o.Page.of(1,20,(new o.Filter).and("type",o.Operator.EQUAL,[t]).and("name",o.Operator.EQUAL,null!=n?n:"")))).then((e=>{let t=[];const n=e.payload?(0,_n.us)(e.payload):void 0;return"IntegrationPage"===(null==n?void 0:n.type)&&(t=n.value.data),t}))),[e])})(),l=s.useMemo((()=>({getIntegrations:a,getNotificationRecipients:n})),[a,n]),[i,r]=s.useState();return s.createElement(Rn,{value:l},s.createElement(Ln.Formik,{validateOnMount:!0,onSubmit:Fa,initialValues:null!==(t=e.behaviorGroup)&&void 0!==t?t:{actions:[],events:[],displayName:void 0},validationSchema:i,validateOnBlur:!0,validateOnChange:!0},s.createElement(xa,{...e,validationSchema:i,setValidationSchema:r})))},Ga=e=>{const t=((e,t)=>(0,s.useCallback)((()=>e(t)),[e,t]))(e.onDelete,e.behaviorGroup),n=s.useMemo((()=>0===e.conflictingNotifications.length?"Cancel":"Close"),[e.conflictingNotifications]),l=s.useMemo((()=>0===e.conflictingNotifications.length?a.ButtonVariant.link:a.ButtonVariant.secondary),[e.conflictingNotifications]),[i,r]=s.useState(!1),c=s.useMemo((()=>{if(0===e.conflictingNotifications.length)return s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,"Action and recipient pairings assigned in"," ",s.createElement("b",null,e.behaviorGroup.displayName)," will lost. You will no longer be able to assign this behavior group to events."),s.createElement(a.StackItem,null,s.createElement(a.Checkbox,{id:"checkbox-delete-i-acknowledge",label:"I acknowledge that this action cannot be undone",onChange:r,isChecked:i})));{const t=e.conflictingNotifications;return s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,"You will no longer be able to assign"," ",s.createElement("b",null,e.behaviorGroup.displayName)," to events, and existing associations to events listed below will be removed."),s.createElement(a.StackItem,null,s.createElement(a.ExpandableSection,{toggleText:`View ${t.length} event${0===t.length?"":"s"}`},s.createElement(a.List,null,t.map((e=>s.createElement(a.ListItem,{key:e.id},`${e.applicationDisplayName} - ${e.eventTypeDisplayName}`)))))),s.createElement(a.StackItem,null,s.createElement(a.Checkbox,{id:"checkbox-delete-i-acknowledge",label:"I acknowledge that this action cannot be undone",onChange:r,isChecked:i})))}}),[e.conflictingNotifications,e.behaviorGroup,i,r]);return s.createElement(o.DeleteModal,{isOpen:!0,isDeleting:e.isDeleting,title:"Delete behavior group",content:c,onClose:e.onClose,onDelete:t,error:e.error,titleIconVariant:"warning",actionButtonDisabled:!i,cancelButtonTitle:n,cancelButtonVariant:l})},_a=()=>!1,Ba=e=>s.createElement(o.DeleteModal,{isOpen:!0,title:"Delete behavior group",actionButtonDisabled:!0,titleIconVariant:"warning",content:s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,s.createElement(a.Skeleton,{width:"500px"})),s.createElement(a.StackItem,null,s.createElement(a.Skeleton,{width:"500px"}))),onClose:e.onClose,isDeleting:!1,onDelete:_a}),Ma=e=>T.B.NotificationResourceDeleteBehaviorGroup.actionCreator({id:e}),Va=(0,M.validationResponseTransformer)((e=>200===e.status?(0,M.validatedResponse)("Notifications",200,(0,V.Jc)(e.value),e.errors):e)),Za=e=>{var t;const n=(0,C.useMutation)(Ma),a=(c=e.behaviorGroup.id,(0,o.useTransformQueryResponse)((0,C.useQuery)((e=>T.B.NotificationResourceGetEventTypesAffectedByRemovalOfBehaviorGroup.actionCreator({behaviorGroupId:e}))(c)),Va)),{addDangerNotification:l,addSuccessNotification:i}=(0,Mn.l)(),r=s.useCallback((async e=>{var t;const a=n.mutate;return 200===(null===(t=(await a(e.id)).payload)||void 0===t?void 0:t.status)?(i("Behavior group deleted",s.createElement(s.Fragment,null,"Group ",s.createElement("b",null,e.displayName)," deleted successfully.")),!0):(l("Behavior group failed to be deleted",s.createElement(s.Fragment,null,"Failed to delete group ",s.createElement("b",null," ",e.displayName),".",s.createElement("br",null),"Please try again.")),!1)}),[n.mutate,l,i]);var c;return(0,s.useEffect)((()=>{const t=a.payload,n=e.onClose;t&&200!==t.status&&(l("Associated events failed to load ",s.createElement(s.Fragment,null,"Failed to load associated events for group"," ",s.createElement("b",null," ",e.behaviorGroup.displayName),".",s.createElement("br",null),"Please try again.")),n(!1))}),[l,a.payload,e.behaviorGroup,e.onClose]),a.loading?s.createElement(Ba,{onClose:e.onClose}):200!==(null===(t=a.payload)||void 0===t?void 0:t.status)?null:s.createElement(Ga,{onDelete:r,isDeleting:n.loading,onClose:e.onClose,behaviorGroup:e.behaviorGroup,conflictingNotifications:a.payload.value})},Ua=e=>{const{isDisabled:t,...n}=e,[l,o]=s.useState(),{auth:r}=(0,i.Z)();s.useEffect((()=>{r.getUser().then((e=>{var t,n;o(null===(n=null===(t=null==e?void 0:e.identity)||void 0===t?void 0:t.user)||void 0===n?void 0:n.is_org_admin)}))}),[]);const c=s.createElement(a.Button,{...n,isAriaDisabled:t,variant:a.ButtonVariant.primary},"Create new group");if(t){const e=l?"You need the Notifications administrator role to perform this action":"You do not have permissions to perform this action. Contact your org admin for more information";return s.createElement(a.Tooltip,{content:e},c)}return c},$a=e=>{const[t,n]=s.useState(""),{rbac:l}=(0,p.b)(),i=s.useMemo((()=>{if(!e.behaviorGroupContent.isLoading&&!e.behaviorGroupContent.hasError){const n=t.toLowerCase();return e.behaviorGroupContent.content.filter((e=>e.displayName.toLowerCase().includes(n)))}return _t}),[t,e.behaviorGroupContent]),[o,r]=(0,An.A)(),[c,u]=(0,Dn.S)(),d=s.useCallback((e=>{e.stopPropagation(),r.create({events:[],actions:[],displayName:""})}),[r]),m=s.useCallback((t=>{const n=e.behaviorGroupContent.reload;t&&n(),r.reset()}),[r,e.behaviorGroupContent.reload]),E=s.useCallback((e=>{r.edit({id:e.id,events:e.events,actions:e.actions,displayName:e.displayName})}),[r]),v=s.useCallback((e=>{u.delete(e)}),[u]),g=s.useCallback((t=>{const n=e.behaviorGroupContent.reload;t&&n(),u.reset()}),[u,e.behaviorGroupContent.reload]),h=s.useCallback((()=>{n("")}),[n]);return s.createElement(s.Fragment,null,s.createElement("div",{className:"pf-v5-u-background-color-100 pf-v5-u-pt-lg pf-v5-u-px-lg"},s.createElement(a.Split,{className:"pf-v5-u-mb-md",hasGutter:!0},s.createElement(a.SplitItem,null,s.createElement(a.TextContent,null,s.createElement(a.Text,{component:a.TextVariants.p},s.createElement("b",null,"Behavior groups")," are made up of action/recipient pairings that allow you to configure which notification actions different users will be able to receive. Once you've created a behavior group, you can assign it to an event using the Events table below.",s.createElement("br",null),s.createElement(a.Text,{component:a.TextVariants.p},"You may also prevent users from changing assigned actions by locking action/recipient pairings when creating or editing behavior groups."))))),s.createElement(a.Stack,{hasGutter:!0},s.createElement(a.StackItem,null,s.createElement(a.Split,{hasGutter:!0,className:"pf-v5-u-mb-md"},s.createElement(a.SplitItem,null,s.createElement(a.SearchInput,{value:t,onChange:n,onClear:h,type:"text","aria-label":"Search by name",placeholder:"Search by name",isDisabled:e.behaviorGroupContent.isLoading})),s.createElement(a.SplitItem,null,s.createElement(Ua,{isDisabled:e.behaviorGroupContent.isLoading||!l.canWriteNotifications,onClick:d}))))),s.createElement(a.Stack,{hasGutter:!0},(e.behaviorGroupContent.isLoading||e.behaviorGroupContent.hasError||e.behaviorGroupContent.content.length>0)&&s.createElement(s.Fragment,null,s.createElement(a.StackItem,null,e.behaviorGroupContent.isLoading?s.createElement(wn,null):e.behaviorGroupContent.hasError?s.createElement("div",null,"Error loading behavior groups"):s.createElement(wn,{onEdit:l.canWriteNotifications?E:void 0,onDelete:l.canWriteNotifications?v:void 0,behaviorGroups:i}))))),o.isOpen&&s.createElement(Ra,{bundle:e.bundle,applications:e.applications,behaviorGroup:o.template,onClose:m}),c.isOpen&&s.createElement(Za,{behaviorGroup:c.data,onClose:g}))};var Ha=n(96702);const qa=(0,M.validationResponseTransformer)((e=>200===e.status?(0,M.validatedResponse)("BehaviorGroups",200,e.value.map(Ha.V),e.errors):e));class Ya extends Error{}const za=(e,t)=>{const n=e.find(Vt(t));if(!n)throw new Ya("Notification not found in rows");return n},Wa=[],Qa=e=>{var t;const n=(e=>{const t=(e=>(0,o.useTransformQueryResponse)((0,C.useQuery)(T.B.NotificationResourceFindBehaviorGroupsByBundleId.actionCreator({bundleId:e})),qa))(e),{groups:n,isLoading:a}=(0,Bn.P)(),l=s.useMemo((()=>{const e=t.payload,n=t.errorObject,a=t.loading,l=t.query;return a?{isLoading:!0,reload:l}:200===(null==e?void 0:e.status)?{isLoading:!1,hasError:!1,content:e.value,reload:l}:{isLoading:!1,hasError:!0,error:n.toString(),reload:l}}),[t.payload,t.loading,t.errorObject,t.query]);return(0,s.useMemo)((()=>l.isLoading||l.hasError?l:(0,ve.ZP)(l,(e=>{const t=(0,ve.Js)(e);t&&t.content.forEach(((t,l)=>t.actions.forEach(((t,i)=>{(0,Je.Yh)(t)&&t.recipient.forEach(((t,o)=>{var r;if(t instanceof un.nc&&t.isLoading){const t=e.content[l].actions[i].recipient,s=t[o];t[o]=new un.nc(s.integrationId,s.groupId,(null===(r=n.find((e=>e.id===s.groupId)))||void 0===r?void 0:r.name)||a)}}))}))))}))),[l,n,a])})(e.bundle.id),{rbac:l}=(0,p.b)(),i=s.useCallback((e=>{console.log("Export to",e)}),[]),r=tn(e.bundle,e.applications,!0),c=$(r.pageController.page),u=s.useMemo((()=>{const e=c.payload;return 200===(null==e?void 0:e.status)?e.value.meta.count:0}),[c.payload]),d=n.isLoading||n.hasError?void 0:n.content,{rows:m,updateBehaviorGroupLink:E,startEditMode:v,finishEditMode:g,cancelEditMode:h,updateBehaviorGroups:f}=((e,t)=>{const[n,a]=s.useState([]),l=(0,Zn.Z)(e),{query:i}=s.useContext(C.ClientContext),r=s.useCallback(((e,t)=>{a((0,ve.ZP)((n=>{const a=za(n,e),l=a.behaviors.findIndex(Vt(t));if(-1===l)throw new Error("Behavior group not found in rows");a.behaviors.splice(l,1)})))}),[a]),c=s.useCallback((e=>{a((0,ve.ZP)((t=>{for(const n of t)n.behaviors=[],e.forEach((e=>{e.events.find((e=>e.id===n.id))&&n.behaviors.push((0,ve.cA)(e))}))})))}),[a]),u=s.useCallback(((e,t,n)=>{n?a((0,ve.ZP)((n=>{za(n,e).behaviors.push({...(0,ve.cA)(t)})}))):r(e,t.id)}),[r,a]),d=s.useCallback((async(e,t)=>{var l;if("finish"===t){const t=za(n,e);t.isEditMode&&(a((0,ve.ZP)((t=>{za(t,e).loadingActionStatus="loading"}))),200===(null===(l=(await i(Y(e,t.behaviors.map((e=>e.id))))).payload)||void 0===l?void 0:l.status)?a((0,ve.ZP)((t=>{const n=za(t,e);n.isEditMode=!1,n.loadingActionStatus="done"}))):((0,o.addDangerNotification)("Saving behavior",s.createElement(s.Fragment,null,"There was an error saving the behavior of"," ",s.createElement("b",null,t.applicationDisplayName," -"," ",t.eventTypeDisplayName),".")),a((0,ve.ZP)((t=>{const n=za(t,e);n.isEditMode=!0,n.loadingActionStatus="done"})))))}else a((0,ve.ZP)((n=>{const a=za(n,e);a.isEditMode&&"cancel"===t&&(a.behaviors=a.oldBehaviors),a.isEditMode="edit"===t,a.isEditMode&&(a.oldBehaviors=a.behaviors)})))}),[a,n,i]),m=s.useCallback((e=>{d(e,"edit")}),[d]),p=s.useCallback((e=>{d(e,"finish")}),[d]),E=s.useCallback((e=>{d(e,"cancel")}),[d]);return s.useEffect((()=>{e!==l&&(a((t=>e.map((e=>({...e,loadingActionStatus:"done",behaviors:[],isEditMode:!1}))))),t&&c(t))}),[t,e,l,a,c]),{rows:n,updateBehaviorGroupLink:u,updateBehaviorGroups:c,startEditMode:m,finishEditMode:p,cancelEditMode:E}})(c.loading||"eventTypesArray"!==(null===(t=c.payload)||void 0===t?void 0:t.type)?Wa:c.payload.value.data,d);s.useEffect((()=>{d&&f(d)}),[d,f]);const y=s.useCallback(((e,t,n)=>{t&&E(e.id,t,n)}),[E]),b=s.useCallback((e=>{v(e)}),[v]),S=s.useCallback((e=>{g(e)}),[g]),k=s.useCallback((e=>{h(e)}),[h]);return s.createElement(Pt,{configuration:e.children,settings:e.children},s.createElement(a.Tab,{eventKey:0,title:s.createElement(a.TabTitleText,null,"Configuration")},s.createElement(en,{filters:r.filters,setFilters:r.setFilters,clearFilter:r.clearFilters,appFilterOptions:e.applications,onExport:i,count:u,pageAdapter:r.pageController},s.createElement(Wt,{notifications:m,behaviorGroupContent:n,onBehaviorGroupLinkUpdated:y,onStartEditing:l.canWriteNotifications?b:void 0,onFinishEditing:l.canWriteNotifications?S:void 0,onCancelEditing:l.canWriteNotifications?k:void 0,onSort:r.onSort,sortBy:r.sortBy,sortDirection:r.sortDirection}))),s.createElement(a.Tab,{eventKey:1,title:s.createElement(a.TabTitleText,null,"Behavior Groups")},s.createElement("div",{className:"pf-v5-u-mb-xl"},s.createElement($a,{bundle:e.bundle,applications:e.applications,behaviorGroupContent:n}))))},ja=e=>{const{updateDocumentTitle:t}=(0,i.Z)();null==t||t(`${e.bundle.displayName} - Notifications`);const n=(0,d.useFlag)("platform.notifications.overhaul"),{rbac:l}=(0,p.b)(),o=c().useMemo((()=>yl.eventLog(e.bundle.name)),[e.bundle.name]),r=Dt(),[u,m]=(0,s.useState)(0),E=c().createElement(Lt.ZP,null,c().createElement(Qa,{applications:e.applications,bundle:e.bundle})),v=(0,ge.style)({paddingLeft:At.J.value}),g=()=>n?null:c().createElement(re,{isDisabled:!l.canReadEvents,to:o,variant:a.ButtonVariant.secondary},A.V.pages.notifications.list.viewHistory),h=c().createElement(Lt.ZP,null,c().createElement(Ft.TimeConfigComponent,null));(0,s.useEffect)((()=>{n&&(0,r.query)(e.bundleTabs[u].name)}),[u,r.query,e.bundleTabs,n]);const f=(0,s.useMemo)((()=>r.payload?r.payload.value:[]),[r.payload]);if(n){const t=(e,t)=>{m(t)};return c().createElement(c().Fragment,null,c().createElement(st,{title:n?"Configure Events":`${A.V.pages.notifications.list.title} | ${e.bundle.displayName}`,subtitle:c().createElement("span",null,"Configure which event notifications different users within your organization are entitled to receive."),action:g()}),c().createElement(a.Flex,{direction:{default:"column"}},c().createElement(a.FlexItem,null,c().createElement(a.Tabs,{activeKey:u,onSelect:t,className:v},c().createElement(a.Tab,{eventKey:2,title:c().createElement(a.TabTitleText,null,"OpenShift")},c().createElement(Lt.ZP,null,c().createElement(Qa,{applications:f,bundle:e.bundleTabs[2]}))),c().createElement(a.Tab,{eventKey:0,title:c().createElement(a.TabTitleText,null,"Red Hat Enterprise Linux")},c().createElement(Lt.ZP,null,c().createElement(Qa,{applications:f,bundle:e.bundleTabs[0]}))),c().createElement(a.Tab,{eventKey:1,title:c().createElement(a.TabTitleText,null,"Console")},c().createElement(Lt.ZP,null,c().createElement(Qa,{applications:f,bundle:e.bundleTabs[1]})))))))}return c().createElement(c().Fragment,null,c().createElement(st,{title:`${A.V.pages.notifications.list.title} | ${e.bundle.displayName}`,subtitle:c().createElement("span",null,"Configure which event notifications different users within your organization are entitled to receive."),action:g()}),c().createElement(Pt,{configuration:e.children,settings:e.children},c().createElement(a.Tab,{eventKey:0,title:c().createElement(a.TabTitleText,null,"Configuration")},E),c().createElement(a.Tab,{eventKey:1,title:c().createElement(a.TabTitleText,null,"Settings")},h)))};var Ka;!function(e){e[e.LOADING=0]="LOADING",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.FAILED_TO_LOAD=2]="FAILED_TO_LOAD"}(Ka||(Ka={}));const Ja=()=>{const e=(0,m.useNavigate)(),t=(0,m.useParams)(),n=(0,d.useFlag)("platform.notifications.overhaul"),a=["rhel","console","openshift"],l=(0,s.useMemo)((()=>n?"rhel":t.bundleName),[n,t.bundleName]),i=S(),o=Dt(),r=(0,s.useMemo)((()=>{var e,t;return 200===(null===(e=i.payload)||void 0===e?void 0:e.status)?null!==(t=i.payload.value.find((e=>e.name===l)))&&void 0!==t?t:Ka.NOT_FOUND:i.payload?Ka.FAILED_TO_LOAD:Ka.LOADING}),[i.payload,l]),c=[];n&&(()=>{var e;if(200!==(null===(e=i.payload)||void 0===e?void 0:e.status)){if(i.payload)throw new Error("Unable to load bundle information");return s.createElement(Nt,null)}a.forEach((e=>{var t,n;(null===(t=i.payload)||void 0===t?void 0:t.value)&&c.push(null!==(n=i.payload.value.find((t=>t.name===e)))&&void 0!==n?n:Ka.NOT_FOUND)}))})(),s.useEffect((()=>{const e=o.query;(e=>"number"==typeof e)(r)||e(r.name)}),[r,o.query]);const u=(0,s.useMemo)((()=>{if(o.payload)return 200===o.payload.status?o.payload.value:null}),[o.payload]);if(r===Ka.NOT_FOUND){if("/rhel"===l)throw new Error("Default bundle information not found");return e("/notifications/rhel"),s.createElement(s.Fragment,null)}if(r===Ka.FAILED_TO_LOAD)throw new Error("Unable to load bundle information");if(null===u)throw new Error("Unable to load application facets");return r!==Ka.LOADING&&u?s.createElement(ja,{bundleTabs:c,bundle:r,applications:u}):s.createElement(Nt,null)};var Xa;!function(e){e.TODAY="today",e.YESTERDAY="yesterday",e.LAST_7="last_7",e.LAST_14="last_14",e.CUSTOM="custom"}(Xa||(Xa={}));const el={[Xa.TODAY]:"Today",[Xa.YESTERDAY]:"Yesterday",[Xa.LAST_7]:"Last 7 days",[Xa.LAST_14]:"Last 14 days",[Xa.CUSTOM]:"Custom"},tl=(0,ge.style)({backgroundColor:(0,ce.important)("var(-pf-v5-global--BackgroundColor--100)"),cursor:"pointer",$nest:{"&::placeholder":{color:(0,ce.important)("var(--pf-v5-global--palette--black-1000)")},"&:hover":{borderBottomColor:"var(--pf-v5-global--active-color--100)"}}});class nl{constructor(e){this.value=e}toString(){return el[this.value]}compareTo(e){return e instanceof nl&&e.value===this.value}}const al={isReadOnly:!0,className:tl},ll=(e,t,n)=>[a=>(0,de.Z)(a,e)?"Date is before the retention policy":(0,me.Z)(a,t)?"Date is after today":n[1]&&(0,me.Z)(a,n[1])?"Start date must be before end date":""],il=(e,t,n)=>[a=>(0,de.Z)(a,e)?"Date is before the retention policy":(0,me.Z)(a,t)?"Date is after today":n[0]&&(0,de.Z)(a,n[0])?"End date must be after start date":""],ol=({period:e,setPeriod:t})=>{const n=(0,s.useMemo)((()=>new Date),[]),l=(0,s.useMemo)((()=>(0,ue.Z)(n,{days:-14})),[n]),i=e=>e?(0,r.Z)(e,"yyyy-MM-dd"):void 0,o=i(e[0]),u=i(e[1]),d=(0,s.useRef)(null),m=(0,s.useRef)(null);return c().createElement(a.Split,null,c().createElement(a.SplitItem,null,c().createElement(a.DatePicker,{placeholder:"Start",inputProps:{...al,onClick:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.setCalendarOpen(!0)}},validators:ll(l,n,e),onChange:e=>{const a=(0,pe.Z)(e);t((0,ve.ZP)((e=>{e[0]=a,e[1]||(e[1]=(0,Ee.Z)([(0,ue.Z)(a,{days:1}),n]))})))},value:o,ref:d})),c().createElement(a.SplitItem,{className:"pf-v5-u-align-self-center pf-v5-u-px-sm pf-v5-u-color-300"},"to"),c().createElement(a.SplitItem,null,c().createElement(a.DatePicker,{placeholder:"End",inputProps:{...al,onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.setCalendarOpen(!0)}},validators:il(l,n,e),onChange:e=>{t((0,ve.ZP)((t=>{t[1]=(0,pe.Z)(e)})))},value:u,ref:m})))},rl=({value:e,setValue:t,period:n,setPeriod:l,retentionDays:i})=>{const[o,r]=(0,s.useState)(!1),u=(0,s.useMemo)((()=>new nl(e)),[e]);return c().createElement(a.Split,null,c().createElement(a.SplitItem,null,c().createElement(a.Select,{isOpen:o,variant:a.SelectVariant.single,onToggle:()=>r((e=>!e)),selections:u,onSelect:(e,n)=>{n instanceof nl&&(t(n.value),r(!1))}},Object.values(Xa).map((e=>c().createElement(a.SelectOption,{key:e,value:new nl(e)}))))),e===Xa.CUSTOM&&c().createElement(a.SplitItem,null,c().createElement(ol,{period:n,setPeriod:l,retentionDays:i})))},sl=()=>c().createElement(a.Bullseye,null,c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.small},c().createElement(a.EmptyStateIcon,{icon:O.SearchIcon}),c().createElement(a.Title,{headingLevel:"h2",size:"lg"},"No results found"),c().createElement(a.EmptyStateBody,null,"Clear all filters and try again."),c().createElement(a.Button,{variant:"link"},"Clear all filters"))),cl=({isEmptyState:e,onSort:t,sort:n,drawer:l,onPagination:i,pagination:o})=>{const r=e=>({sortBy:{index:n.columnIndex,direction:n.direction,defaultDirection:"asc"},onSort:(e,n,a)=>{t(n,a)},columnIndex:e});return c().createElement(c().Fragment,null,c().createElement(Se.TableComposable,null,c().createElement(Se.Thead,null,c().createElement(Se.Tr,null,c().createElement(Se.Th,{sort:r(0)},"Event type"),c().createElement(Se.Th,null,"Service"),c().createElement(Se.Th,{sort:r(2)},"Timestamp"))),c().createElement(Se.Tbody,null,e?c().createElement(Se.Tr,null,c().createElement(Se.Td,{colSpan:8},c().createElement(sl,null))):c().createElement(c().Fragment,null,l.map((e=>c().createElement(Se.Tr,{key:e.id},c().createElement(Se.Td,null,e.title),c().createElement(Se.Td,null,e.source),c().createElement(Se.Td,null,c().createElement(ke.Z,{date:e.created})))))))),c().createElement(a.Pagination,{itemCount:o.count,perPage:o.limit,page:o.offset/o.limit+1,onSetPage:(e,t,n)=>{i({limit:null!=n?n:o.limit,offset:(t-1)*(null!=n?n:o.limit)})},widgetId:"pagination-id",onPerPageSelect:(e,t)=>{i({limit:null!=t?t:o.limit,offset:0})}}))},ul=({onPagination:e,pagination:t,...n})=>c().createElement(c().Fragment,null,c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(a.ToolbarItem,null,c().createElement(a.MenuToggle,{icon:c().createElement(a.Icon,null,c().createElement(O.FilterIcon,null))},"Event")))),c().createElement(a.Divider,null),c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(a.ToolbarItem,null,c().createElement(rl,{value:n.dateFilter,setValue:n.setDateFilter,retentionDays:n.retentionDays,setPeriod:n.setPeriod,period:n.period})),c().createElement(a.ToolbarItem,{className:"pf-u-ml-auto"},c().createElement(a.Pagination,{itemCount:t.count,perPage:t.limit,page:t.offset/t.limit+1,onSetPage:(n,a,l)=>{e({limit:null!=l?l:t.limit,offset:(a-1)*(null!=l?l:t.limit)})},widgetId:"pagination-id",onPerPageSelect:(n,a)=>{e({limit:null!=a?a:t.limit,offset:0})},isCompact:!0}))))),dl={0:"title",2:"created"},ml=()=>{var e,t,n,l;const[i,u]=(0,s.useState)([]),[d,m]=(0,s.useState)([void 0,void 0]),[p,E]=(0,s.useState)(Xa.LAST_14),[v,g]=(0,s.useState)({offset:0,limit:20,count:0}),[h,f]=(0,s.useState)({columnIndex:2,direction:"desc"}),y=(0,s.useMemo)((()=>((e,t)=>{const n=[void 0,void 0],a="yyyy-MM-dd",l=new o.Filter;return(e=>{const t=(0,o.toUtc)(new Date);(0,yt.Z)((0,bt.Z)(t),{days:1}),Xa.LAST_14,(0,yt.Z)((0,bt.Z)(t),{days:14}),Xa.LAST_7,(0,yt.Z)((0,bt.Z)(t),{days:7}),Xa.TODAY,Xa.YESTERDAY})(),n[0]&&n[1]&&(l.and("start",o.Operator.EQUAL,(0,r.Z)(n[0],a)),l.and("end",o.Operator.EQUAL,(0,r.Z)(n[1],a))),{startDate:n[0]?(0,r.Z)(n[0],a):void 0,endDate:n[1]?(0,r.Z)(n[1],a):void 0}})()),[p,null===(e=d[0])||void 0===e?void 0:e.toString(),null===(t=d[1])||void 0===t?void 0:t.toString()]),b=(0,s.useCallback)(((e,t,n)=>{const a=new URLSearchParams({offset:`${e.offset}`,limit:`${e.limit}`,sort_by:`${dl[t.columnIndex]}:${t.direction}`});n.startDate&&a.append("startDate",n.startDate+"T00:00:00"),n.endDate&&a.append("endDate",n.endDate+"T23:59:59"),fetch(`/api/notifications/v1/notifications/drawer?${a.toString()}`).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{u(e.data),g((t=>({...t,count:e.meta.count})))})).catch((e=>{console.error("Error while fetching data: ",e)}))}),[]);return(0,s.useEffect)((()=>{b(v,h,y)}),[p,null===(n=d[0])||void 0===n?void 0:n.toString(),null===(l=d[1])||void 0===l?void 0:l.toString()]),c().createElement(c().Fragment,null,c().createElement(st,{title:A.V.pages.notifications.notificationsLog.title,subtitle:A.V.pages.notifications.notificationsLog.subtitle}),c().createElement(Lt.ZP,null,c().createElement(a.Card,null,c().createElement(ul,{pagination:v,onPagination:({limit:e,offset:t})=>{g((n=>({...n,offset:t,limit:e}))),b({limit:e,offset:t},h,y)},dateFilter:p,setDateFilter:E,retentionDays:14,period:d,setPeriod:m}),c().createElement(cl,{isEmptyState:0===i.length,sort:h,onSort:(e,t)=>{f({columnIndex:e,direction:t}),b(v,{columnIndex:e,direction:t},y)},drawer:i,pagination:v,onPagination:({limit:e,offset:t})=>{g((n=>({...n,offset:t,limit:e}))),b({limit:e,offset:t},h,y)}}))))},pl=n.p+"fonts/notifications-product-icon.svg";var El;!function(e){e.USER="user",e.RUNNING="running",e.INTEGRATION="integration",e.USERS="users",e.BELL="bell"}(El||(El={}));const vl=({icon:e,heading:t,linkTitle:n,linkTarget:l,expandableContent:i,isRedirect:o,isExpanded:r})=>{const s=(0,m.useNavigate)();let u=null;const[d,p]=c().useState(r||!1);switch(e){case El.USER:u=c().createElement(O.UserIcon,{className:"pf-u-primary-color-100"});break;case El.RUNNING:u=c().createElement(O.RunningIcon,{className:"pf-u-primary-color-100"});break;case El.INTEGRATION:u=c().createElement(O.IntegrationIcon,{className:"pf-u-primary-color-100"});break;case El.USERS:u=c().createElement(O.UsersIcon,{className:"pf-u-primary-color-100"});break;case El.BELL:u=c().createElement(O.BellIcon,{className:"pf-u-primary-color-100"})}return c().createElement(c().Fragment,null,c().createElement(a.DataListItem,{"aria-labelledby":"item1",isExpanded:d},c().createElement(a.DataListItemRow,{className:"pf-u-align-items-center"},c().createElement(a.DataListToggle,{isExpanded:d,id:"toggle1","aria-controls":"expand1",onClick:()=>p(!d)}),c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"cell-"+e.toString().toLowerCase()},c().createElement("div",null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,{className:"pf-u-align-self-center"},c().createElement(a.Icon,{size:"lg"},u)),c().createElement(a.Divider,{orientation:{default:"vertical"}}),c().createElement(a.FlexItem,{className:"pf-u-align-self-center"},c().createElement(a.Title,{headingLevel:"h4"},t)))))]}),n&&l&&c().createElement(a.DataListAction,{"aria-labelledby":"item1 action1",id:"action1","aria-label":"Actions",isPlainButtonAction:!0},c().createElement(a.Button,{component:"a",href:l,variant:"link",onClick:e=>{o||(e.preventDefault(),s(l.replace("/preview","")))}},n))),c().createElement(a.DataListContent,{"aria-label":t+" - Detailed Explanation",id:"expand1",isHidden:!d},c().createElement("p",null,i))))},gl="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_notifications_on_the_red_hat_hybrid_cloud_console/index",hl="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_notifications_on_the_red_hat_hybrid_cloud_console/assembly-intro_notifications",fl="https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/configuring_sources_for_red_hat_services/index",yl={overview:()=>"/",configureEvents:()=>"/configure-events",integrations:()=>"/settings/integrations",notifications:e=>`/${e}`,eventLog:e=>"/eventlog"+(e?`?bundle=${e}`:""),notificationsLog:()=>"/notificationslog",splunk:()=>"/integrations/splunk-setup"},bl=[{path:"/",component:()=>{const{getApp:e}=(0,i.Z)();return"integrations"===e()?s.createElement(P,null):null}},{path:yl.integrations(),component:P},{path:yl.eventLog(),component:Tt},{path:yl.notifications(":bundleName"),component:Ja},{path:yl.splunk(),component:()=>{const[e,t]=(0,s.useState)(2),[n,l]=(0,s.useState)(!1),[i,o]=(0,s.useState)("info"),[r,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[p,E]=(0,s.useState)(["Logs from the automation would appear here\n"]),[v,g]=(0,s.useState)();return c().createElement(c().Fragment,null,c().createElement(w(),null,c().createElement(ie,null)),c().createElement(a.Card,null,c().createElement(a.CardBody,null,c().createElement(a.Split,{hasGutter:!0},c().createElement(a.SplitItem,null,c().createElement(a.ProgressStepper,{isVertical:!0},c().createElement(a.ProgressStep,{isCurrent:1===e,variant:"success",description:"Create Index and HEC",id:"step1-splunk-app-step",titleId:"step1-splunk-app-step","aria-label":"completed Splunk app step (step 1)"},"Step 1"),c().createElement(a.ProgressStep,{isCurrent:2===e,icon:2===e&&n?c().createElement(O.InProgressIcon,null):void 0,variant:e<2?"info":i,description:"Configure Splunk integration in Insights",id:"step2-setup-step",titleId:"step2-setup-step","aria-label":"setup step (step 2)"},"Step 2"),c().createElement(a.ProgressStep,{isCurrent:3===e,variant:e<3?"pending":i,description:"Review",id:"step3-review-step",titleId:"step3-review-step","aria-label":"review step (step 3)"},"Step 3"))),c().createElement(a.Divider,{isVertical:!0}),c().createElement(a.SplitItem,{isFilled:!0},2===e&&c().createElement(ne,{setStep:t,stepIsInProgress:n,setStepIsInProgress:l,stepVariant:i,setStepVariant:o,hecToken:r,setHecToken:u,splunkServerHostName:d,setHostName:m,automationLogs:p,setAutomationLogs:E,setError:g}),3===e&&c().createElement(R,{isSuccess:"success"===i,error:v}))))))}},{path:yl.notificationsLog(),component:ml}],Cl=[{path:yl.overview(),component:()=>{const e=(0,m.useNavigate)(),t=(0,d.useFlag)("platform.sources.integrations"),[n,l]=c().useState(null),{auth:o,isBeta:r,getBundle:s}=(0,i.Z)(),u=(0,d.useFlag)("platform.notifications.overhaul");return c().useEffect((()=>{o&&(async()=>{const{identity:{user:e}}=await o.getUser();l(e.is_org_admin)})()}),[o]),c().createElement(c().Fragment,null,c().createElement(w(),null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement("img",{src:pl})),c().createElement(a.Divider,{orientation:{default:"vertical"}}),c().createElement(a.FlexItem,{className:"pf-u-align-self-flex-start"},c().createElement(h(),{title:"Notifications",className:"pf-u-mb-sm"}),c().createElement("p",{className:"pf-u-mb-sm"},"Receive notifications about events that occur in your console services. You can choose to receive notifications in the console notifications drawer, by email, in third-party applications, or from a combination of these methods.")))),c().createElement(Lt.ZP,null,n?c().createElement(c().Fragment,null,c().createElement(a.Card,{className:"pf-u-mb-lg"},c().createElement(a.Grid,{hasGutter:!0},c().createElement(a.GridItem,{sm:12,md:6,lg:8},c().createElement(a.CardTitle,null,c().createElement(a.Title,{headingLevel:"h2"},"Manage events for your organization")),c().createElement(a.CardBody,null,c().createElement("p",null,"Control which notifications different users within your organization can receive by creating behavior groups and associating them with specific events. Users can then select the event notifications they want to receive and how to be notified in their"," ",c().createElement("a",{href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/user-preferences`)}},"Notification Preferences"),".")),c().createElement(a.CardFooter,null,c().createElement(a.Button,{variant:"primary",component:"a",href:`${r()?"/preview":""}/${s()}/notifications/configure-events`,isLarge:!0,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/configure-events`)}},"Configure events"))),c().createElement(a.GridItem,{md:6,lg:4,className:"pf-u-display-none pf-u-display-block-on-md pf-c-card__cover-image"})))):c().createElement(c().Fragment,null,c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Get started with Notifications on the Hybrid Cloud Console"),c().createElement(a.Grid,{hasGutter:!0,className:"pf-u-mb-lg"},c().createElement(a.GridItem,{sm:12,md:6},c().createElement(a.Card,{className:"pf-u-h-100"},c().createElement(a.CardTitle,null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement(a.Icon,{size:"lg"},c().createElement(O.UserIcon,{className:"pf-u-primary-color-100"}))),c().createElement(a.FlexItem,null,c().createElement(a.Title,{headingLevel:"h2"},"Manage your own notifications with Notification Preferences")))),c().createElement(a.CardBody,null,c().createElement("p",null,"This service allows you to opt-in and out of receiving notifications. Your Organization Administrator has configured which notifications you can or can not receive in their Settings.")),c().createElement(a.CardFooter,null,c().createElement(a.Button,{variant:"primary",isLarge:!0,component:"a",href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/user-preferences`)}},"Go to Notification Preferencesss")))),c().createElement(a.GridItem,{sm:12,md:6},c().createElement(a.Card,{className:"pf-u-h-100"},c().createElement(a.CardTitle,null,c().createElement(a.Flex,{className:"pf-u-flex-nowrap"},c().createElement(a.FlexItem,null,c().createElement(a.Icon,{size:"lg"},c().createElement(O.RunningIcon,{className:"pf-u-primary-color-100"}))),c().createElement(a.FlexItem,null,c().createElement(a.Title,{headingLevel:"h2"},"Monitor all fired events with the Event log")))),c().createElement(a.CardBody,null,c().createElement("p",null,"See all the events affecting your organization and view details around the events fired.")),c().createElement(a.CardFooter,null,!u&&c().createElement(a.Button,{variant:"secondary",isLarge:!0,component:"a",href:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,onClick:t=>{t.preventDefault(),e(`/${s()}/notifications/eventlog`)}},"View Event log")))))),n?c().createElement(c().Fragment,null,c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Supporting features"),c().createElement(a.DataList,{"aria-label":"Supporting features list",className:"pf-u-mb-lg"},c().createElement(vl,{icon:El.USER,isExpanded:!0,heading:"Manage your own notifications with Notification Preferences",linkTitle:"Go to Notification Preferences",linkTarget:`${r()?"/preview":""}/${s()}/notifications/user-preferences`,expandableContent:"Select the events you want to be notified about, and how to receive notifications. Your Organization Administrator has configured which notifications you can or cant receive in their Settings."}),c().createElement(vl,{icon:El.RUNNING,heading:"Monitor all fired events with the Event log",linkTitle:"View Event log",linkTarget:`${r()?"/preview":""}/${s()}/notifications/eventlog `,expandableContent:"See all the events occurring in your organization and view details about the triggered events."}),c().createElement(vl,{icon:El.INTEGRATION,heading:"Set up Integrations to customize your notifications",linkTitle:"Set up Integrations",...t&&{isRedirect:!0},linkTarget:t?(r()?"/preview":"")+"/settings/sources?category=Integrations":`${r()?"/preview":""}/${s()}/notifications/integrations`,expandableContent:c().createElement("span",null,"The notifications and integrations services work together to transmit messages to third-party applications, such as instant messaging platforms and external ticketing systems, when events occur. Integrations include Splunk, Slack, ServiceNow,"," ",c().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_hybrid_cloud_console/2023/html/integrating_the_red_hat_hybrid_cloud_console_with_third-party_applications/index"},"and more"),".")}),c().createElement(vl,{icon:El.USERS,heading:"Create behavior groups to easily notify the right users",linkTitle:"Create new behavior group",linkTarget:`${r()?"/preview":""}/${s()}/notifications/configure-events`,expandableContent:"Configure which notifications different users in your organization can receive, and how to notify groups of users when selected events occur."}))):c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Supporting features list",className:"pf-u-mb-lg"},c().createElement(vl,{icon:El.BELL,heading:"About Notifications",expandableContent:"Notifications are a way for users to be alerted of important events that occur in the Hybrid Cloud\n                            Console. You can receive notifications within the console via the notifications drawer as well as through email and\n                            third-party integrations, such as Slack or ServiceNow."}))),c().createElement(a.Title,{headingLevel:"h2",className:"pf-u-mb-md"},"Recommended content"),n?c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Recommended content list",className:"pf-u-mb-lg"},c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row1-col1"},c().createElement("span",null,"Configuring notifications and integrations")),c().createElement(a.DataListCell,{key:"row1-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row1-col3"},c().createElement("a",{href:gl,onClick:e=>{e.preventDefault(),window.open(gl,"_blank")}},"View documentation ",c().createElement(O.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row2-col1"},c().createElement("span",null,"Configuring integrations and events")),c().createElement(a.DataListCell,{key:"row2-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row2-col3"},c().createElement("a",{href:hl,onClick:e=>{e.preventDefault(),window.open(hl,"_blank")}},"View documentation ",c().createElement(O.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row3-col1"},c().createElement("span",null,"Restricting access to a service to a team")),c().createElement(a.DataListCell,{key:"row3-col2"},c().createElement(a.Label,{color:"green"},"Quick start")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row3-col3"},c().createElement("a",{href:(r()?"/preview":"")+"/iam/my-user-access?bundle=rhel&quickstart=rbac-admin-vuln-permissions"},"Begin Quick start ",c().createElement(O.ArrowRightIcon,null)))]}))))):c().createElement(c().Fragment,null,c().createElement(a.DataList,{"aria-label":"Recommended content list",className:"pf-u-mb-lg"},c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row1-col1"},c().createElement("span",null,"Configuring notifications and integrations")),c().createElement(a.DataListCell,{key:"row1-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row1-col3"},c().createElement("a",{href:hl,onClick:e=>{e.preventDefault(),window.open(hl,"_blank")}},"View documentation ",c().createElement(O.ExternalLinkAltIcon,null)))]}))),c().createElement(a.DataListItem,null,c().createElement(a.DataListItemRow,null,c().createElement(a.DataListItemCells,{dataListCells:[c().createElement(a.DataListCell,{key:"row2-col1"},c().createElement("span",null,"Configuring integrations for Red Hat services")),c().createElement(a.DataListCell,{key:"row2-col2"},c().createElement(a.Label,{color:"orange"},"Documentation")),c().createElement(a.DataListCell,{alignRight:!0,isFilled:!1,key:"row2-col3"},c().createElement("a",{href:fl,onClick:e=>{e.preventDefault(),window.open(fl,"_blank")}},"View documentation ",c().createElement(O.ExternalLinkAltIcon,null)))]}))))),c().createElement("a",{href:(r()?"/preview":"")+"/settings/learning-resources",className:"pf-u-mb-lg"},"View all Settings Learning Resources")))}},{path:yl.integrations(),component:P},{path:yl.configureEvents(),component:Ja},{path:yl.eventLog(),component:Tt},{path:yl.notificationsLog(),component:ml}],Tl=()=>{const e=(0,d.useFlag)("platform.notifications.overhaul"),t=s.useMemo((()=>e?Cl:bl),[e]);return s.createElement(m.Routes,null,t.map((e=>s.createElement(m.Route,{key:e.path,path:e.path,element:s.createElement(I,null,s.createElement(e.component,null))}))),!e&&s.createElement(m.Route,{path:"*",element:s.createElement(m.Navigate,{to:"/",replace:!0})}))};var Sl=n(54926),kl=n(56335),Il=n(3121);const Nl="HH:mm",wl="hh:mma",Dl=()=>{const{updateDocumentTitle:e}=(0,i.Z)();null==e||e("Notifications");const{rbac:t,server:n,isOrgAdmin:c}=(0,Il.q)(),d=(0,o.getInsights)(),[m,E]=s.useState(!1),v=s.useCallback((e=>{e?(d.chrome.getEnvironmentOriginal=d.chrome.getEnvironment,d.chrome.getEnvironment=()=>"ci"):d.chrome.getEnvironment=d.chrome.getEnvironmentOriginal,E(e)}),[d]);if(!t||!n)return s.createElement(Nt,null);if(n.status===Sl.U.MAINTENANCE){const e=(0,r.Z)((0,o.toUtc)(n.from),Nl),t=(0,r.Z)((0,o.toUtc)(n.to),Nl),a=(0,r.Z)(n.from,wl),i=(0,r.Z)(n.to,wl),c=(0,r.Z)(n.to,"O");return s.createElement(l.Z,{utcStartTime:e,utcEndTime:t,startTime:a,endTime:i,timeZone:c})}return s.createElement(p.I.Provider,{value:{rbac:t,server:n,isOrgAdmin:!!c}},s.createElement(kl.d,null,s.createElement(u.q,null),s.createElement(o.InsightsEnvDetector,{insights:d,onEnvironment:Jt.ok},s.createElement(o.RenderIfTrue,null,s.createElement(a.Switch,{className:"pf-v5-u-p-sm",isChecked:m,onChange:v,labelOff:"Enable experimental features",label:"Disable experimental features"}))),s.createElement(Tl,null)))}},2412:(e,t,n)=>{n.d(t,{Y:()=>i});var a=n(94782),l=n(16721);const i=()=>(0,a.useQuery)(l.B.OrgConfigResourceGetDailyDigestTimePreference.actionCreator())},60207:(e,t,n)=>{n.d(t,{I:()=>o});var a=n(94782),l=n(16721);const i=e=>l.B.OrgConfigResourceSaveDailyDigestTimePreference.actionCreator({body:e.body}),o=()=>(0,a.useMutation)(i)}}]);
//# sourceMappingURL=../sourcemaps/2728.88d5ea799fa94dc70d8c1f61c288c02e.js.map